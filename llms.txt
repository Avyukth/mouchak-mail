# MCP Agent Mail (Rust)

> A high-performance Rust implementation of "Gmail for coding agents" - an MCP-compliant mail server enabling async communication between AI coding agents. Built on Axum, libsql, and git2 with a SvelteKit frontend.

This project implements the Model Context Protocol (MCP) to provide:
- **Agent-to-Agent Messaging**: Markdown messages with threading and attachments
- **File Reservation Leases**: Advisory locks to prevent edit conflicts
- **Contact Management**: Explicit approval for cross-project messaging
- **Searchable Archives**: FTS5 full-text search across message bodies
- **Git-Backed Audit Trail**: All messages persisted for human review

The Rust rewrite prioritizes memory safety, performance, and idiomatic patterns while maintaining full feature parity with the Python original ([28 MCP tools](https://glama.ai/mcp/servers/@Dicklesworthstone/mcp_agent_mail)).

**Current Status**: Phases 1-2 COMPLETE. Phase 3 (28 MCP tools, 39 beads tasks remaining) IN PROGRESS.

**Tech Stack**: Rust (Axum 0.8, libsql, git2, tokio, thiserror) + SvelteKit 2 + Svelte 5 + TailwindCSS + Bun

## Architecture

- [SUMMARY.md](/SUMMARY.md): Project overview, achievements, and roadmap with pivot decisions
- [Architecture Overview](/docs/architecture.md): System design, crate structure, and data flow
- [BMC Pattern Guide](/docs/bmc-pattern.md): Backend Model Controller implementation details

## Core Crates

- [lib-core](/crates/libs/lib-core/): Domain models, BMC logic, database/git storage abstraction
- [mcp-server](/crates/services/mcp-server/): Axum web server with REST API endpoints
- [mcp-cli](/crates/services/mcp-cli/): Command-line interface for testing and operations

## API Reference

- [REST Endpoints](/docs/api-endpoints.md): POST /api/project/ensure, /api/agent/register, /api/message/send, /api/inbox, GET /api/projects, /api/health
- [MCP Tools Spec](/docs/mcp-tools.md): All 46 MCP tools to be implemented (messaging, file reservations, contacts, search)

## Database & Storage

- [Schema Migration](/migrations/001_initial_schema.sql): SQLite/libsql schema with FTS5 full-text search
- [Git Storage Pattern](/docs/git-storage.md): Mailbox structure, message files, agent profiles

## Planning & Tasks

- [Project Plan](/docs/PROJECT_PLAN.md): Comprehensive phase breakdown with beads-style task tracking
- [Beads Issues](/.beads/issues.jsonl): Live issue tracker for work items and dependencies

## Reference Materials

- [Python Original](https://github.com/Dicklesworthstone/mcp_agent_mail): Source implementation being translated
- [MCP Tools Reference](https://glama.ai/mcp/servers/@Dicklesworthstone/mcp_agent_mail): Authoritative list of 28 MCP tools
- [Beads Issue Tracker](https://github.com/steveyegge/beads): Issue tracking via `bd` CLI

## Optional

- [Development Diary](/docs/dev-diary.md): Session notes and decision rationale
- [Test Coverage Report](/docs/test-coverage.md): Unit and integration test status
