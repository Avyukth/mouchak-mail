# =============================================================================
# MCP Agent Mail - Environment Variables Configuration
# =============================================================================
# Copy this file to .env and configure for your environment.
# Variables marked as REQUIRED must be set for that feature to work.
# All others have sensible defaults.
#
# Total environment variables documented: 35+
# =============================================================================

# =============================================================================
# HTTP SERVER CONFIGURATION
# =============================================================================

# Host to bind the HTTP server
# Default: 0.0.0.0 (all interfaces)
# MOUCHAK_SERVER__HOST=0.0.0.0

# Port for HTTP server
# Default: 8769 (can also use PORT for legacy compatibility)
# MOUCHAK_SERVER__PORT=8769
PORT=8765

# =============================================================================
# LOGGING & OBSERVABILITY
# =============================================================================

# Log format: "json" for structured logging, any other value for pretty
# Default: pretty
# Options: json, pretty
LOG_FORMAT=pretty

# Rust log level filter
# Default: info,tower_http=debug,axum=debug,mcp_agent_mail=debug
# Examples:
#   - debug (all debug)
#   - info (production default)
#   - warn,mcp_server=debug (warn globally, debug for mcp_server)
#   - error (errors only)
RUST_LOG=info

# =============================================================================
# RUNTIME CONFIGURATION
# =============================================================================

# Application run mode
# Default: development
# Options: development, production, test
# RUN_MODE=development

# =============================================================================
# AUTHENTICATION (Optional - Future Enhancement)
# =============================================================================

# Authentication mode for HTTP API
# Default: none
# Options: none, bearer, jwt
# HTTP_AUTH_MODE=none

# Static bearer token for authentication (REQUIRED if HTTP_AUTH_MODE=bearer)
# Generate with: openssl rand -hex 32
# HTTP_BEARER_TOKEN=

# JWKS URL for JWT validation (REQUIRED if HTTP_AUTH_MODE=jwt)
# Example: https://your-auth-provider.com/.well-known/jwks.json
# HTTP_JWKS_URL=

# Allow unauthenticated requests from localhost
# Default: true
# HTTP_ALLOW_LOCALHOST_UNAUTHENTICATED=true

# CORS allowed origins (comma-separated)
# Default: http://localhost:4090,http://localhost:5173
# CORS_ALLOWED_ORIGINS=http://localhost:4090,http://localhost:5173

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# SQLite database file path
# Default: ./data/mcp_agent_mail.db
# The directory will be created automatically if it doesn't exist.
# SQLITE_PATH=./data/mcp_agent_mail.db

# Database URL (alternative to SQLITE_PATH)
# Default: file:./data/mcp_agent_mail.db
# DATABASE_URL=file:./data/mcp_agent_mail.db

# =============================================================================
# GIT ARCHIVE
# =============================================================================

# Git repository path for message archival
# Default: ./data/archive
# Messages are archived as markdown files in a Git repository structure.
# The repository is auto-initialized if it doesn't exist.
GIT_REPO_PATH=./data/archive

# Enable Git archival feature
# Default: false
# GIT_ARCHIVE_ENABLED=false

# Git author name for commits
# Default: MCP Agent Mail
# GIT_AUTHOR_NAME=MCP Agent Mail

# Git author email for commits
# Default: mail@agents.local
# GIT_AUTHOR_EMAIL=mail@agents.local

# =============================================================================
# LLM INTEGRATION (Optional)
# =============================================================================

# Enable LLM features (thread summarization, etc.)
# Default: false
LLM_ENABLED=false

# OpenAI API key (REQUIRED if LLM_ENABLED=true and using OpenAI)
# OPENAI_API_KEY=

# OpenAI model for summarization
# Default: gpt-4o-mini
# Options: gpt-4o-mini, gpt-4o, gpt-4-turbo, gpt-3.5-turbo
# OPENAI_MODEL=gpt-4o-mini

# OpenAI API base URL (optional, for custom endpoints)
# Default: https://api.openai.com/v1
# OPENAI_API_BASE=https://api.openai.com/v1

# Anthropic API key (alternative to OpenAI)
# ANTHROPIC_API_KEY=

# Anthropic model
# Default: claude-3-haiku-20240307
# Options: claude-3-haiku-20240307, claude-3-sonnet-20240229, claude-3-opus-20240229
# ANTHROPIC_MODEL=claude-3-haiku-20240307

# =============================================================================
# FILE RESERVATIONS
# =============================================================================

# Default TTL (Time To Live) for file reservations in seconds
# Default: 3600 (1 hour)
# FILE_RESERVATION_DEFAULT_TTL=3600

# Maximum TTL for file reservations in seconds
# Default: 86400 (24 hours)
# FILE_RESERVATION_MAX_TTL=86400

# =============================================================================
# BUILD SLOTS
# =============================================================================

# Default TTL for build slots in seconds
# Default: 1800 (30 minutes)
# BUILD_SLOT_DEFAULT_TTL=1800

# Maximum concurrent build slots per project
# Default: 3
# BUILD_SLOT_MAX_PER_PROJECT=3

# =============================================================================
# ACK ESCALATION
# =============================================================================

# Enable ACK TTL enforcement (escalate unacknowledged messages)
# Default: false
# ACK_TTL_ENABLED=false

# TTL in seconds before a message requiring ACK is considered overdue
# Default: 1800 (30 minutes)
# ACK_TTL_SECONDS=1800

# Enable escalation actions for overdue ACKs
# Default: false
# ACK_ESCALATION_ENABLED=false

# Escalation mode for overdue ACKs
# Default: log
# Options: log, file_reservation, overseer
#   - log: Write to application logs only
#   - file_reservation: Create file reservation lock on overdue message files
#   - overseer: Send escalation message to overseer/human agent
# ACK_ESCALATION_MODE=log

# Interval in seconds between ACK overdue scans
# Default: 300 (5 minutes)
# ACK_SCAN_INTERVAL_SECONDS=300

# =============================================================================
# CONTACTS & AGENTS
# =============================================================================

# Default contact policy for new agents
# Default: contacts_only
# Options: open, auto, contacts_only, block_all
# AGENT_DEFAULT_CONTACT_POLICY=contacts_only

# Allow cross-project messaging
# Default: true
# ALLOW_CROSS_PROJECT_MESSAGING=true

# Agent mail bypass flag (for testing/debugging)
# Set to any non-empty value to bypass agent mail checks
# AGENT_MAIL_BYPASS=

# =============================================================================
# PROJECT IDENTITY (Privacy-Safe Slug Generation)
# =============================================================================

# How project slugs are generated from paths
# Default: dir
# Options:
#   - dir: Use last directory component + hash → "{dirname}-{hash}" (privacy-safe)
#   - git-remote: Use git remote URL → "{repo-name}-{hash}"
#   - git-toplevel: Use git repo root dir name → "{dirname}-{hash}"
#   - git-common-dir: Use git common dir (for worktrees) → "repo-{hash}"
#
# All modes are privacy-safe and don't leak full filesystem paths or usernames.
#
# PROJECT_IDENTITY_MODE=dir

# Git remote name for git-remote mode
# Default: origin
# PROJECT_IDENTITY_REMOTE=origin

# =============================================================================
# MCP CONFIGURATION
# =============================================================================

# MCP transport mode
# Default: stdio
# Options: stdio, sse
# MOUCHAK_MCP__TRANSPORT=stdio

# MCP SSE server port (only used when transport=sse)
# Default: 3000
# MOUCHAK_MCP__PORT=3000

# MCP Agent Mail port (for STDIO mode integration scripts)
# Default: 8765
# MCP_AGENT_MAIL_PORT=8765

# MCP Agent Mail host (for STDIO mode integration scripts)
# Default: 127.0.0.1
# MCP_AGENT_MAIL_HOST=127.0.0.1

# Full URL to the MCP Agent Mail server
# Used by CLI health checks and git hooks
# Default: http://localhost:8765
# MCP_AGENT_MAIL_URL=http://localhost:8765

# =============================================================================
# WEB UI CONFIGURATION
# =============================================================================

# Vite/SvelteKit dev server port (development only)
# Default: 5173
# VITE_PORT=5173

# API URL for the web UI to connect to (runtime)
# Default: window.location.origin (same host as frontend)
# API_URL=http://localhost:8080

# API URL for Leptos WASM build (build-time, optional)
# If not set, falls back to window.location.origin at runtime
# API_BASE_URL=http://localhost:8080

# Public API URL (exposed to browser)
# Default: http://localhost:8000
# PUBLIC_API_URL=http://localhost:8000

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# Web UI URL for E2E tests
# Default: http://localhost:5173
# TEST_WEB_UI_URL=http://localhost:5173

# API URL for E2E tests
# Default: http://localhost:8765
# TEST_API_URL=http://localhost:8765

# Run tests in headless mode
# Default: true
# TEST_HEADLESS=true

# Test timeout in milliseconds
# Default: 30000 (30 seconds)
# TEST_TIMEOUT_MS=30000

# =============================================================================
# DEVELOPMENT & DEBUGGING
# =============================================================================

# Enable development mode (relaxed security, verbose logging)
# Default: false
# DEV_MODE=false

# Disable telemetry
# Default: true (telemetry is disabled by default)
# DISABLE_TELEMETRY=true

# =============================================================================
# SYSTEMD/SERVICE DEPLOYMENT
# =============================================================================
# When deploying with systemd, place environment variables in:
# /etc/mouchak/env (as configured in deploy/systemd/mcp-agent-mail.service)
#
# Example systemd environment file:
# PORT=8765
# RUST_LOG=info
# SQLITE_PATH=/var/lib/mouchak/mcp_agent_mail.db
# GIT_REPO_PATH=/var/lib/mouchak/archive
# =============================================================================

# =============================================================================
# GITHUB PAGES DEPLOYMENT
# =============================================================================

# GitHub Pages repository URL for static site deployment
# Used by: make push-github-pages
# Example: https://github.com/username/repo.git
# GITHUB_PAGES_URL=https://github.com/Avyukth/mcp-agent-mail-archive.git

# Custom domain for GitHub Pages (optional)
# Creates a CNAME file in the deployment
# Example: mail.example.com
# GITHUB_PAGES_CNAME=mail.pathshala.dev

# =============================================================================
# DOCKER COMPOSE
# =============================================================================
# When using docker-compose.yml, environment variables can be set in the
# docker-compose.yml file or via a .env file in the same directory.
# See docker-compose.yml for reference configuration.
# =============================================================================

# =============================================================================
# NOTES
# =============================================================================
# 1. Environment variable precedence (highest to lowest):
#    - Direct environment variables (export VAR=value)
#    - .env file
#    - Config files (config/default.toml, config/{RUN_MODE}.toml)
#    - Application defaults
#
# 2. MOUCHAK prefix:
#    Variables with MOUCHAK__ prefix are read by the config system.
#    Use double underscore (__) to represent nested config keys.
#    Example: MOUCHAK_SERVER__PORT maps to config.server.port
#
# 3. Legacy compatibility:
#    Some variables (like PORT) are supported for backward compatibility
#    alongside the newer MOUCHAK__ prefixed versions.
#
# 4. Security considerations:
#    - Never commit .env files with real secrets to version control
#    - Use strong random tokens for HTTP_BEARER_TOKEN
#    - In production, use JWT authentication with proper JWKS setup
#    - Consider using environment-specific .env files (.env.production, etc.)
# =============================================================================
