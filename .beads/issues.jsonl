{"id":"mcpmail-079d","title":"P0: Fix thread spawn without join in mcp_integration.rs","description":"**Issue**: UBS detected `std::thread::spawn` without corresponding `join()` in mcp_integration.rs test code.\n\n**Risk**: Thread handles dropped without join can cause:\n- Resource leaks (thread resources never reclaimed)\n- Orphaned threads running after test completion\n- Non-deterministic test behavior\n- Potential data races if test assumptions depend on thread completion\n\n**Location**: crates/tests/mcp_integration.rs\n\n**Fix Strategy**:\n1. Store thread `JoinHandle` from spawn\n2. Call `.join().expect()` or `.join().unwrap()` before test ends\n3. Consider using scoped threads (`std::thread::scope`) for automatic join\n4. Alternative: use tokio::spawn for async tests with proper await\n\n**Test Strategy**: \n- Run test under Thread Sanitizer (TSAN)\n- Verify no resource leaks with valgrind\n- Ensure deterministic test behavior across multiple runs\n\n**Severity**: Critical - test reliability issue","status":"closed","issue_type":"bug","created_at":"2025-12-24T02:58:40.101795+05:30","updated_at":"2025-12-24T03:07:07.248161+05:30","closed_at":"2025-12-24T03:07:07.248161+05:30","close_reason":"Fixed: Replaced std::thread::spawn with std::thread::scope in mcp_integration.rs and http_transport_tests.rs. Scoped threads guarantee join on scope exit, eliminating resource leak risk. All 22 affected tests pass."}
{"id":"mcpmail-1","title":"NTM-002: Implement list_project_agents tool","description":"Add list_project_agents tool (alias/wrapper for list_agents).\n\n**Analysis:**\n- NTM expects `list_project_agents` \n- We have `list_agents` which takes project_slug parameter\n- Semantically identical - just add as alias\n\n**Options:**\n1. Add alias in call_tool (simplest)\n2. Add separate wrapper function (cleaner)\n\n**Implementation (alias approach):**\n```rust\n// In call_tool alias mapping:\n\"list_project_agents\" =\u003e \"list_agents\",\n```\n\n**Implementation (wrapper approach):**\n```rust\n#[tool(description = \"List agents in the current project.\")]\nasync fn list_project_agents(\n    \u0026self,\n    params: Parameters\u003cListProjectAgentsParams\u003e,\n) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    // Direct delegation to list_agents\n    let list_params = ListAgentsParams { \n        project_slug: params.0.project_slug \n    };\n    self.list_agents(Parameters(list_params)).await\n}\n```\n\n**Recommendation:** Use alias approach since functionality is identical.\n\n**Acceptance Criteria:**\n- [ ] Alias added in call_tool dispatch\n- [ ] Schema added to get_all_tool_schemas()\n- [ ] Test verifies NTM can call it\n\n**Reference Files:**\n- crates/libs/lib-mcp/src/tools/mod.rs:2222 (list_agents impl)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T06:39:36.640988+05:30","updated_at":"2025-12-23T00:22:43.544207+05:30","closed_at":"2025-12-22T07:43:43.089775+05:30","dependencies":[{"issue_id":"mcpmail-1","depends_on_id":"mcpmail-387","type":"blocks","created_at":"2025-12-22T06:58:14.267789+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-10","title":"Sprint4-4.3: Verify responsive design at breakpoints","description":"Test all pages at mobile/tablet/desktop breakpoints to verify responsive layouts.\n\n## Breakpoints\n- Mobile: 375px\n- Tablet: 768px\n- Desktop: 1440px\n\n## Checklist per Breakpoint\n### Mobile (375px)\n- No horizontal scrolling\n- Navigation collapses appropriately\n- Text readable without zooming\n- Touch targets ≥ 44×44px\n- Forms usable on small screen\n\n### Tablet (768px)\n- Layout adapts (no mobile layout on tablet)\n- SplitView shows single column or adapts\n- Navigation works (hamburger or full)\n- Cards don't overflow\n\n### Desktop (1440px)\n- Full multi-column layout visible\n- SplitView shows both panels\n- Hover states work\n- No elements too small\n\n## Deliverables\n- Screenshots at each breakpoint\n- No horizontal scrolling confirmed\n- All layouts adapt correctly","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T01:56:02.661734+05:30","updated_at":"2025-12-23T00:22:43.547942+05:30","closed_at":"2025-12-19T02:53:52.06192+05:30"}
{"id":"mcpmail-100","title":"SVELTE-001: Update rust-embed to use web-ui/build","description":"## Summary\nUpdate lib-server embedded.rs to point to SvelteKit build output instead of Leptos dist.\n\n## Implementation\n**File**: `crates/libs/lib-server/src/embedded.rs`\n\n```rust\n// CHANGE: Point to SvelteKit build output\n#[derive(Embed)]\n#[folder = \"../../services/web-ui/build\"]\npub struct Assets;\n```\n\n**File**: `crates/libs/lib-server/src/static_files.rs`\nUpdate cache strategy for SvelteKit `/_app/immutable/` paths:\n```rust\nlet cache_control = if path.contains(\"/_app/immutable/\") {\n    \"public, max-age=31536000, immutable\"\n} else if path == \"index.html\" {\n    \"public, max-age=0, must-revalidate\"\n} else {\n    \"public, max-age=86400\"\n};\n```\n\n## Reference Files\n- crates/libs/lib-server/src/embedded.rs (modify)\n- crates/libs/lib-server/src/static_files.rs (modify)\n- crates/libs/lib-server/Cargo.toml (verify with-web-ui feature)\n\n## Acceptance Criteria\n- [ ] embedded.rs points to `../../services/web-ui/build`\n- [ ] static_files.rs handles `/_app/immutable/` cache headers\n- [ ] SPA fallback works (paths without extensions → index.html)\n- [ ] `cargo build -p mcp-agent-mail --features with-web-ui` compiles\n- [ ] Server serves embedded SvelteKit assets at /\n\n## Quality Gates\n- cargo clippy -- -D warnings\n- cargo test -p lib-server\n\n## MCP Server\nPort 8080 default, embedded UI at root /","status":"closed","issue_type":"task","created_at":"2025-12-22T05:33:43.983726+05:30","updated_at":"2025-12-23T00:22:43.578748+05:30","closed_at":"2025-12-22T07:49:38.715551+05:30","dependencies":[{"issue_id":"mcpmail-100","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:30.282278+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-101","title":"BUG: guard check has hardcoded project_slug and wrong 'reserved by' display","status":"closed","issue_type":"bug","created_at":"2025-12-22T02:45:18.298677+05:30","updated_at":"2025-12-23T00:22:43.579264+05:30","closed_at":"2025-12-22T02:48:54.356479+05:30"}
{"id":"mcpmail-102","title":"P0: Add cargo fmt to pre-commit hook - CI failing on format","description":"CI is failing multiple times on cargo fmt --check. Add cargo fmt to pre-commit hook to catch formatting issues before commit. This prevents wasted CI cycles and ensures consistent code style. Implementation: 1) Create/update .git/hooks/pre-commit, 2) Add cargo fmt --check step, 3) Optionally add to Makefile for manual runs.","status":"closed","issue_type":"bug","created_at":"2025-12-17T21:14:47.530058+05:30","updated_at":"2025-12-23T00:22:43.579585+05:30","closed_at":"2025-12-17T21:21:12.059408+05:30"}
{"id":"mcpmail-103","title":"Sprint4-4.1: Create visual regression baseline screenshots","description":"Create baseline screenshots at key viewports using dev-browser for visual regression testing.\n\n## Viewports\n- Mobile: 375×667px\n- Tablet: 768×1024px  \n- Desktop: 1440×900px\n\n## Pages to Screenshot\n- / (Dashboard)\n- /projects\n- /inbox\n- /mail/unified (All Mail)\n\n## Deliverables\n- 12 baseline screenshots (4 pages × 3 viewports)\n- Script for CI integration\n- No visual regressions from current state","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T01:53:56.299827+05:30","updated_at":"2025-12-23T00:22:43.579818+05:30","closed_at":"2025-12-19T02:42:35.047676+05:30"}
{"id":"mcpmail-104","title":"ORCH-8: Add OrchestrationBmc for crash recovery","description":"## Summary\nBMC for tracking orchestration state and recovering from crashes.\n\n## Implementation\n```rust\npub struct OrchestrationBmc;\n\nimpl OrchestrationBmc {\n    /// Find tasks that were in_progress but worker disappeared\n    pub async fn find_abandoned_tasks(\n        ctx: \u0026Ctx,\n        mm: \u0026ModelManager,\n        project_id: i64,\n        stale_threshold: Duration,\n    ) -\u003e Result\u003cVec\u003cAbandonedTask\u003e\u003e;\n    \n    /// Find reviews that were claimed but reviewer disappeared\n    pub async fn find_abandoned_reviews(\n        ctx: \u0026Ctx,\n        mm: \u0026ModelManager,\n        project_id: i64,\n        stale_threshold: Duration,\n    ) -\u003e Result\u003cVec\u003cAbandonedReview\u003e\u003e;\n    \n    /// Check for merge conflicts in worktrees\n    pub async fn check_worktree_conflicts(\n        base_path: \u0026Path,\n    ) -\u003e Result\u003cVec\u003cConflictInfo\u003e\u003e;\n}\n```\n\n## Acceptance Criteria\n- [ ] Detects abandoned tasks (no activity \u003e threshold)\n- [ ] Detects abandoned reviews (REVIEWING but no result)\n- [ ] Reports merge conflicts in active worktrees\n- [ ] Allows recovery by reassignment","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:35:41.254659+05:30","updated_at":"2025-12-23T00:22:43.58005+05:30","closed_at":"2025-12-20T00:50:52.255751+05:30","dependencies":[{"issue_id":"mcpmail-104","depends_on_id":"mcpmail-112","type":"blocks","created_at":"2025-12-19T18:36:25.291523+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-105","title":"Update AGENTS.md to match universal template and project reality","description":"## Context\nCompare project AGENTS.md with universal template and align with actual project state.\n\n## Changes Required\n1. Layer 1 vc section: Expand safety nets, env vars, Vibe Coding\n2. Layer 3: Fix tool count (50+ → 45), update pre-commit (cargo-husky), dynamic active work areas\n3. Layer 4: Add cargo-husky auto-install info\n4. Appendix: Add mcp-agent-mail cargo install\n\n## NOT Changing\n- Skip Layer 0 Rule 2 git push update per user request\n- Keep MCP Agent Mail section focused (this IS the server)\n\n## References\n- Universal template provided by user\n- docs/ARCHITECTURE.md\n- docs/WALKTHROUGH.md\n- 45 actual MCP tools (cargo run -p mcp-stdio -- tools)","status":"closed","issue_type":"task","created_at":"2025-12-17T21:39:12.751098+05:30","updated_at":"2025-12-23T00:22:43.580296+05:30","closed_at":"2025-12-17T21:42:18.833589+05:30"}
{"id":"mcpmail-106","title":"ORCH-6: Add QualityGateRunner for automated checks","description":"## Summary\nStandardized quality gate execution with structured results.\n\n## Implementation\n```rust\npub struct QualityGateRunner;\n\n#[derive(Serialize)]\npub struct QualityGateResults {\n    pub cargo_check: GateResult,\n    pub cargo_clippy: GateResult,\n    pub cargo_fmt: GateResult,\n    pub cargo_test: GateResult,\n    pub all_passed: bool,\n}\n\n#[derive(Serialize)]\npub struct GateResult {\n    pub passed: bool,\n    pub exit_code: i32,\n    pub output: String,\n    pub duration_ms: u64,\n}\n\nimpl QualityGateRunner {\n    pub async fn run_all() -\u003e Result\u003cQualityGateResults\u003e;\n    pub async fn run_blocking_only() -\u003e Result\u003cQualityGateResults\u003e;\n}\n```\n\n## Acceptance Criteria\n- [ ] Runs cargo check, clippy, fmt, test\n- [ ] Captures exit codes and output\n- [ ] all_passed is true only if all gates pass\n- [ ] run_blocking_only skips tests for speed","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:35:08.510442+05:30","updated_at":"2025-12-23T00:22:43.580544+05:30","closed_at":"2025-12-20T00:50:52.161029+05:30"}
{"id":"mcpmail-107","title":"Sprint4-4.2: Run accessibility audit on all pages","description":"Run comprehensive accessibility audit using dev-browser and fix any issues.\n\n## Checks\n- Images without alt text (0 violations target)\n- Buttons without accessible names (0 violations target)\n- Form inputs without labels (0 violations target)\n- Touch targets \u003c 44×44px (0 violations target)\n- Color contrast ratios (WCAG AA: 4.5:1)\n\n## Pages to Audit\n- / (Dashboard)\n- /projects\n- /inbox\n- /mail/unified\n\n## Deliverables\n- Audit report documenting all checks\n- All issues fixed\n- WCAG 2.1 AA compliance verified","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T01:54:07.605025+05:30","updated_at":"2025-12-23T00:22:43.580782+05:30","closed_at":"2025-12-19T02:50:43.817737+05:30"}
{"id":"mcpmail-108","title":"CLI: Add --per-thread-limit and --no-llm flags to summarize","description":"Add Python-compatible flags: --per-thread-limit (default 100) limits messages per thread in summary, --no-llm skips LLM-based summarization and returns raw aggregation. Useful for large threads.","notes":"Worker claiming task for implementation","status":"closed","issue_type":"task","created_at":"2025-12-21T22:31:58.592463+05:30","updated_at":"2025-12-23T00:22:43.581025+05:30","closed_at":"2025-12-22T00:24:06.206608+05:30"}
{"id":"mcpmail-109","title":"CLI: Add 'guard check' command for pre-commit integration","description":"Port Python guard check command. Reads paths from stdin (--stdin-nul), checks against active file reservations, supports --advisory mode. Used by pre-commit hooks. See ${PYTHON_SRC}/src/mcp_agent_mail/cli.py lines 3081-3150.","notes":"Worker: Starting guard check command implementation for pre-commit integration","status":"closed","issue_type":"task","created_at":"2025-12-21T22:31:58.374377+05:30","updated_at":"2025-12-23T00:22:43.58129+05:30","closed_at":"2025-12-22T02:07:24.990082+05:30"}
{"id":"mcpmail-11","title":"Sprint4-4.4: Verify dark mode for all components","description":"Test all components in dark mode to ensure CSS variables work correctly.\n\n## Component Checklist\n- [ ] Card background uses --card variable\n- [ ] Text uses --foreground / --card-foreground\n- [ ] Borders use --border variable\n- [ ] Input backgrounds correct\n- [ ] Button variants visible\n- [ ] Badge variants visible\n- [ ] Alert variants visible\n- [ ] Focus rings visible against dark background\n- [ ] Skeleton pulse animation visible\n- [ ] Dialog overlay and content correct\n- [ ] Separator visible\n\n## Verification\n- No white flash on page load\n- Contrast ratios meet WCAG AA (4.5:1 for text)\n- All component variants distinguishable\n- Dark mode toggle works correctly\n\n## Deliverables\n- Dark mode screenshots for all pages\n- All semantic colors verified\n- No contrast issues","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T01:56:22.723432+05:30","updated_at":"2025-12-23T00:22:43.548266+05:30","closed_at":"2025-12-19T02:55:39.609449+05:30"}
{"id":"mcpmail-110","title":"LEPTOS-013: Visual Regression Test Suite","description":"## Summary\nCreate baseline screenshots using dev-browser for visual regression testing.\n\n## Implementation\nCreate: `scripts/visual-regression.ts`\n\n```typescript\n// Using dev-browser skill\nconst viewports = [\n  { name: \"mobile\", width: 375, height: 667 },\n  { name: \"tablet\", width: 768, height: 1024 },\n  { name: \"desktop\", width: 1440, height: 900 },\n];\n\nconst pages = [\"/\", \"/projects\", \"/inbox\", \"/thread/1\"];\n```\n\n## Acceptance Criteria\n- [ ] Baseline screenshots for 4 pages x 3 viewports = 12 files\n- [ ] Pages: /, /projects, /inbox, /thread/1\n- [ ] Viewports: 375 (mobile), 768 (tablet), 1440 (desktop)\n- [ ] Diff script compares current vs baseline\n- [ ] CI integration (compare on PR)\n- [ ] Stored in `baselines/` directory\n\n## Quality Gates\n- All baselines render correctly\n- Diff threshold: 0.1% pixel difference\n- Script exits non-zero on diff detected\n\n## Reference Skills\n- dev-browser: Visual regression testing\n- kaizen-solaris-review: Automated quality gates","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T22:06:41.536622+05:30","updated_at":"2025-12-23T00:22:43.58156+05:30","closed_at":"2025-12-20T04:16:10.250283+05:30"}
{"id":"mcpmail-111","title":"ORCH-2: Add CompletionReport struct and generator","description":"## Summary\nStandardized completion report format for [COMPLETION] mails.\n\n## Implementation\n```rust\npub struct CompletionReport {\n    pub task_id: String,\n    pub task_title: String,\n    pub commit_id: String,\n    pub branch: String,\n    pub files_changed: Vec\u003cString\u003e,\n    pub summary: String,\n    pub criteria_status: Vec\u003c(String, bool)\u003e,\n    pub quality_gates: QualityGateResults,\n    pub notes: Option\u003cString\u003e,\n}\n\nimpl CompletionReport {\n    pub fn to_markdown(\u0026self) -\u003e String { ... }\n    pub fn from_git_and_beads(task_id: \u0026str) -\u003e Result\u003cSelf\u003e { ... }\n}\n```\n\n## Acceptance Criteria\n- [ ] CompletionReport struct with all required fields\n- [ ] to_markdown() generates AGENTS.md format\n- [ ] from_git_and_beads() auto-populates from git diff and beads\n- [ ] QualityGateResults struct for gate status","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:33:10.549908+05:30","updated_at":"2025-12-23T00:22:43.581834+05:30","closed_at":"2025-12-20T00:53:18.8712+05:30","dependencies":[{"issue_id":"mcpmail-111","depends_on_id":"mcpmail-112","type":"blocks","created_at":"2025-12-19T18:36:25.113246+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-112","title":"ORCH-1: Add OrchestrationState enum and thread state parser","description":"## Summary\nImplement state machine parsing for review threads based on subject prefixes.\n\n## Implementation\nAdd to lib-core/src/model/orchestration.rs:\n\n```rust\npub enum OrchestrationState {\n    Started,      // [TASK_STARTED]\n    Completed,    // [COMPLETION]\n    Reviewing,    // [REVIEWING]\n    Approved,     // [APPROVED]\n    Rejected,     // [REJECTED]\n    Fixed,        // [FIXED]\n    Acknowledged, // [ACK]\n}\n\nimpl OrchestrationState {\n    pub fn from_subject(subject: \u0026str) -\u003e Option\u003cSelf\u003e { ... }\n    pub fn can_transition_to(\u0026self, next: \u0026Self) -\u003e bool { ... }\n}\n\npub fn parse_thread_state(messages: \u0026[Message]) -\u003e OrchestrationState { ... }\n```\n\n## Acceptance Criteria\n- [ ] OrchestrationState enum with 7 states\n- [ ] from_subject parser for [PREFIX] patterns\n- [ ] can_transition_to validation per state machine\n- [ ] parse_thread_state returns current state from thread history\n- [ ] Unit tests for all transitions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:32:50.655575+05:30","updated_at":"2025-12-23T00:22:43.582074+05:30","closed_at":"2025-12-20T00:53:18.869651+05:30"}
{"id":"mcpmail-113","title":"Refactor: Extract capability auto-grant to shared function","description":"register_agent duplicates capability auto-grant logic in lib-mcp/tools/mod.rs and mcp-stdio/tools.rs. Extract to shared helper function to reduce duplication.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T20:22:18.002086+05:30","updated_at":"2025-12-23T00:22:43.582314+05:30","closed_at":"2025-12-22T20:33:00.193905+05:30"}
{"id":"mcpmail-114","title":"PORT-2.1-INT: Integrate RepoCache into GitStore for FD management","description":"## Context\nScaffolding exists in lib-core/src/store/repo_cache.rs with:\n- RepoCache struct using LruCache\u003cPathBuf, Arc\u003cMutex\u003cRepository\u003e\u003e\u003e\n- new(capacity), get(path), peek(path), get_if_cached(path), clear()\n- All with unit tests\n\n## Remaining Work\nIntegrate RepoCache into GitStore:\n1. Add RepoCache field to GitStore struct\n2. Modify open_repo() to use cache instead of direct Repository::open()\n3. Add config for cache capacity (default 8)\n4. Add stress test for FD exhaustion\n\n## Acceptance Criteria\n- [ ] GitStore uses RepoCache for all repository opens\n- [ ] Cache capacity configurable via GIT_REPO_CACHE_SIZE env var\n- [ ] Benchmark shows no FD growth under 1000 operations\n- [ ] Integration test with \u003e8 concurrent projects\n- [ ] Evicted repos properly release file descriptors\n\n## Files to Modify\n- crates/libs/lib-core/src/store/git_store.rs\n- crates/libs/lib-core/src/store/mod.rs\n- crates/libs/lib-common/src/config.rs (add GIT_REPO_CACHE_SIZE)\n\n## Complexity: 6/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T05:16:06.210271+05:30","updated_at":"2025-12-23T00:22:43.582531+05:30","closed_at":"2025-12-19T21:19:45.939852+05:30","dependencies":[{"issue_id":"mcpmail-114","depends_on_id":"mcpmail-222","type":"blocks","created_at":"2025-12-19T05:16:06.211017+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-115","title":"PORT-1.3-INT: Wire mistake_detection.rs into error responses","description":"## Context\nScaffolding exists in lib-core/src/utils/mistake_detection.rs with:\n- MistakeSuggestion struct\n- detect_path_as_project_key(), detect_path_as_agent_name()\n- detect_id_confusion(), suggest_similar()\n- All with unit tests\n\n## Remaining Work\nWire detection functions into error handling:\n1. lib-core/error.rs - Add suggestion field to relevant error variants\n2. BMC modules - Call detection functions when entity not found\n3. API error responses - Include suggestions in JSON error response\n\n## Acceptance Criteria\n- [ ] AgentNotFound error includes similar agent suggestions\n- [ ] ProjectNotFound error includes similar project suggestions\n- [ ] Invalid path errors detect relative vs absolute confusion\n- [ ] Error JSON includes 'suggestions' array when available\n- [ ] Integration tests verify suggestions appear\n\n## Files to Modify\n- crates/libs/lib-core/src/error.rs\n- crates/libs/lib-core/src/model/agent.rs (AgentBmc::get)\n- crates/libs/lib-core/src/model/project.rs (ProjectBmc::get)\n- crates/libs/lib-server/src/error.rs (API error response)\n\n## Complexity: 4/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T05:15:59.756711+05:30","updated_at":"2025-12-23T00:22:43.582818+05:30","closed_at":"2025-12-19T21:19:44.436317+05:30","dependencies":[{"issue_id":"mcpmail-115","depends_on_id":"mcpmail-331","type":"blocks","created_at":"2025-12-19T05:15:59.757588+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-116","title":"PORT-1.2-INT: Wire validation.rs into MCP tools and API handlers","description":"## Context\nScaffolding exists in lib-core/src/utils/validation.rs with:\n- ValidationError enum\n- validate_agent_name(), validate_project_key(), validate_reservation_path(), validate_ttl()\n- All with unit tests\n\n## Remaining Work\nWire validation functions into:\n1. lib-mcp/tools.rs - Call validation before processing tool requests\n2. lib-server/api/ handlers - Call validation in request handlers\n3. lib-core/error.rs - Add ValidationError variant to main Error enum\n\n## Acceptance Criteria\n- [ ] register_agent tool validates agent_name via validate_agent_name()\n- [ ] ensure_project tool validates project_key via validate_project_key()\n- [ ] file_reservation_paths validates paths via validate_reservation_path()\n- [ ] TTL params validated via validate_ttl()\n- [ ] Validation errors return actionable suggestions\n- [ ] Integration tests verify validation is called\n\n## Files to Modify\n- crates/libs/lib-mcp/src/tools.rs\n- crates/libs/lib-server/src/api/*.rs\n- crates/libs/lib-core/src/error.rs\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T05:15:46.736876+05:30","updated_at":"2025-12-23T00:22:43.583078+05:30","closed_at":"2025-12-19T21:19:43.224047+05:30","dependencies":[{"issue_id":"mcpmail-116","depends_on_id":"mcpmail-321","type":"blocks","created_at":"2025-12-19T05:15:46.738358+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-117","title":"CLI: Add 'products' subcommand with ensure/link/status/search/inbox/summarize-thread","description":"Port Python products CLI commands. Commands: products ensure [product_key] --name 'Name', products link \u003cproduct_key\u003e \u003cproject\u003e, products status \u003cproduct_key\u003e, products search \u003cproduct_key\u003e \u003cquery\u003e --limit 50, products inbox \u003cproduct_key\u003e \u003cagent\u003e --urgent-only --include-bodies, products summarize-thread \u003cproduct_key\u003e \u003cthread_id\u003e --per-thread-limit 100 --no-llm. See ${PYTHON_SRC}/src/mcp_agent_mail/cli.py lines 142-570.","notes":"Worker: Starting products subcommand implementation","status":"closed","issue_type":"feature","created_at":"2025-12-21T22:31:48.342431+05:30","updated_at":"2025-12-23T00:22:43.583315+05:30","closed_at":"2025-12-22T00:40:22.1337+05:30"}
{"id":"mcpmail-118","title":"Phase 3: Full Feature Parity (28 MCP Tools)","description":"Implement all 28 MCP tools from Python original (https://glama.ai/mcp/servers/@Dicklesworthstone/mcp_agent_mail) organized by cluster: Identity, Messaging, Contacts, File Reservations, Build Slots, Search, Macros, Product, Static Export. 41 beads tasks total, 2 closed, 39 open.","notes":"27/28 tools implemented. Only export_mailbox remaining.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-09T01:40:02.771755+05:30","updated_at":"2025-12-23T00:22:43.583584+05:30","closed_at":"2025-12-09T05:36:29.614482+05:30"}
{"id":"mcpmail-119","title":"Configure Bun as package manager","description":"Set up bun.lockb, configure scripts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T01:40:41.371615+05:30","updated_at":"2025-12-23T00:22:43.584709+05:30","closed_at":"2025-12-09T02:25:41.487403+05:30","dependencies":[{"issue_id":"mcpmail-119","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.37197+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-12","title":"LEPTOS-014: Accessibility Audit Automation","description":"## Summary\nCreate automated accessibility audit using dev-browser skill.\n\n## Implementation\nCreate: `scripts/accessibility-audit.ts`\n\n```typescript\n// Checks using dev-browser\nconst a11yIssues: string[] = [];\n\n// Check for images without alt text\nconst imgWithoutAlt = await page.$$eval('img:not([alt])', imgs =\u003e imgs.length);\n\n// Check for buttons without accessible names\nconst emptyButtons = await page.$$eval(\n  'button:not([aria-label]):empty',\n  btns =\u003e btns.length\n);\n\n// Check touch targets\nconst smallTargets = await page.$$eval(\n  'button, a, [role=\"button\"]',\n  els =\u003e els.filter(e =\u003e e.offsetWidth \u003c 44 || e.offsetHeight \u003c 44).length\n);\n```\n\n## Acceptance Criteria\n- [ ] Audit script checks: images alt, button labels, form labels, touch targets\n- [ ] Run on all pages (/inbox, /projects, /agents, /attachments)\n- [ ] Generate YAML report with issue counts\n- [ ] Fail CI if any violations\n- [ ] Include color contrast check\n\n## Quality Gates\n- 0 violations for WCAG 2.1 AA\n- All touch targets \u003e= 44x44px\n- All color contrast \u003e= 4.5:1\n\n## Reference Skills\n- dev-browser: Accessibility auditing\n- production-hardening-frontend: WCAG compliance\n- kaizen-solaris-review: Quality gates","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-19T22:06:41.944581+05:30","updated_at":"2025-12-23T00:22:43.548584+05:30","closed_at":"2025-12-20T04:18:35.113475+05:30"}
{"id":"mcpmail-120","title":"Create Badge component with variants extracted from ProjectCard","description":"## Summary\nCreate a reusable Badge component with CVA variants, extracting pattern from ProjectCard status badges.\n\n## Implementation Details\n\n### Create components/badge.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::*;\n\nconst BADGE_BASE: \u0026str = \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\";\n\n#[derive(TwVariant, Clone, Copy, Default)]\npub enum BadgeVariant {\n    #[tw(default, class = \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\")]\n    Default,\n    #[tw(class = \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\")]\n    Secondary,\n    #[tw(class = \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\")]\n    Destructive,\n    #[tw(class = \"text-foreground\")]\n    Outline,\n    #[tw(class = \"border-transparent bg-emerald-500 text-white\")]\n    Success,\n    #[tw(class = \"border-transparent bg-amber-500 text-white\")]\n    Warning,\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/badge.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Badge component created with 6 variants\n- [ ] Uses rounded-full for pill shape\n- [ ] Focus ring for keyboard accessibility\n- [ ] Includes Success and Warning variants for status\n- [ ] Component exported from mod.rs","notes":"Claimed by worker-be8s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T23:11:52.688979+05:30","updated_at":"2025-12-23T00:22:43.585037+05:30","closed_at":"2025-12-19T00:39:45.904793+05:30","dependencies":[{"issue_id":"mcpmail-120","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:41.017401+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-121","title":"Set up TailwindCSS with MD3 theme","description":"Install tailwindcss, configure Material Design 3 colors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T01:40:41.45376+05:30","updated_at":"2025-12-23T00:22:43.585351+05:30","closed_at":"2025-12-09T02:25:41.536024+05:30","dependencies":[{"issue_id":"mcpmail-121","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.454131+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-122","title":"Epic: shadcn/ui Component Upgrade for Leptos Ultrathink","description":"## Overview\nComprehensive upgrade of 12 Leptos components to shadcn/ui design patterns with production hardening, mobile-first design, WCAG 2.1 AA accessibility compliance, and testing strategy.\n\n## Standards Applied\n| Standard | Target |\n|----------|--------|\n| WCAG | 2.1 AA Compliance |\n| Core Web Vitals | LCP \u003c 2.5s, CLS \u003c 0.1 |\n| Touch Targets | ≥ 44×44px minimum |\n| Color Contrast | ≥ 4.5:1 (text), ≥ 3:1 (UI) |\n| Design System | shadcn semantic tokens + fluid typography |\n\n## Scope\n- 6 new components (Button, Input, Card, Badge, Separator, Skeleton)\n- 6 upgraded components (Select, Avatar, Alert, Dialog, ProjectCard, SplitView)\n- CSS infrastructure (semantic tokens, fluid typography, touch targets)\n- Testing infrastructure (visual regression, a11y audits)\n\n## Quality Gates\n- cargo check \u0026\u0026 cargo fmt --check \u0026\u0026 cargo clippy -- -D warnings\n- All ARIA attributes present per shadcn spec\n- Keyboard navigation tested\n- Touch targets ≥ 44×44px\n- Color contrast ≥ 4.5:1","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-18T23:10:25.40705+05:30","updated_at":"2025-12-23T00:22:43.585638+05:30","closed_at":"2025-12-20T04:18:52.887037+05:30","dependencies":[{"issue_id":"mcpmail-122","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:03:36.352405+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-122","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:03:36.400178+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-122","depends_on_id":"mcpmail-110","type":"blocks","created_at":"2025-12-19T22:08:54.06644+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-122","depends_on_id":"mcpmail-12","type":"blocks","created_at":"2025-12-19T22:08:54.121178+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-123","title":"GAP: Archive CLI Commands (save/list/restore)","description":"## Problem\nPython has disaster recovery archive CLI. Rust has no equivalent.\n\n## Python Commands\n- `archive save --label \u003cname\u003e` - Create restorable snapshot\n- `archive list --json` - Show restore points\n- `archive restore \u003cfile\u003e.zip` - Restore from backup\n- `clear-and-reset-everything` - Wipe state with optional archive\n\n## Implementation\n- Add archive subcommand to CLI\n- save: ZIP database + git storage with metadata.json\n- list: Enumerate archives in data/archives/\n- restore: Extract and replace live data\n- clear-and-reset: Optional archive before wipe","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T17:59:46.921747+05:30","updated_at":"2025-12-23T00:22:43.586066+05:30","closed_at":"2025-12-20T06:04:30.636157+05:30"}
{"id":"mcpmail-124","title":"Create API client service","description":"Fetch wrapper for REST API calls to backend","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T01:40:41.601233+05:30","updated_at":"2025-12-23T00:22:43.586267+05:30","closed_at":"2025-12-09T02:25:41.632987+05:30","dependencies":[{"issue_id":"mcpmail-124","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.6016+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-125","title":"Implement layout with navigation","description":"App shell with sidebar, header, main content area","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T01:40:41.683758+05:30","updated_at":"2025-12-23T00:22:43.586513+05:30","closed_at":"2025-12-09T02:25:41.676835+05:30","dependencies":[{"issue_id":"mcpmail-125","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.684165+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-126","title":"Create Projects list page","description":"List all projects, create new project","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-09T01:40:41.770141+05:30","updated_at":"2025-12-23T00:22:43.58675+05:30","closed_at":"2025-12-09T02:36:51.968045+05:30","dependencies":[{"issue_id":"mcpmail-126","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.770543+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-127","title":"Create Agents list page","description":"List agents per project, register new agent","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-09T01:40:41.852389+05:30","updated_at":"2025-12-23T00:22:43.586992+05:30","closed_at":"2025-12-09T02:36:52.01548+05:30","dependencies":[{"issue_id":"mcpmail-127","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.852802+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-128","title":"PORT: Identity Resolution Tests (10 worktree/WSL2 tests)","description":"## Description\nPort identity resolution tests covering worktrees, WSL2, and case sensitivity.\n\n## Test Files\n- test_identity.py (2 tests)\n- test_identity_worktrees.py (1 test)\n- test_identity_wsl2.py (1 test)\n- test_identity_ignorecase.py (1 test)\n- test_identity_resources.py (1 test)\n- test_identity_markers.py (3 tests)\n\n## Key Tests\n1. test_identity_dir_mode_without_repo\n2. test_identity_mode_git_common_dir_without_repo_falls_back\n3. test_identity_same_across_worktrees\n4. test_wsl2_path_normalization\n5. test_identity_reports_core_ignorecase\n6. test_whois_and_projects_resources\n7. test_committed_marker_precedence\n8. test_private_marker_used_when_committed_missing\n9. test_remote_fingerprint_when_no_markers\n\n## Reference\n- Python: tests/test_identity*.py\n\n## Implementation Notes\n- Critical for worktree support\n- WSL2 path handling (/mnt/c/ vs C:/)\n- Case sensitivity handling (core.ignorecase)\n- .agent-mail-identity marker files","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:58:33.544615+05:30","updated_at":"2025-12-23T00:22:43.587244+05:30","closed_at":"2025-12-20T07:13:20.49283+05:30"}
{"id":"mcpmail-129","title":"PORT: Time Travel Tests (23 historical snapshot tests)","description":"## Description\nPort the 23 time travel tests from Python covering historical inbox snapshot retrieval.\n\n## Test Categories\n\n### Basic Rendering (2 tests)\n- test_time_travel_page_renders\n- test_time_travel_page_lists_projects\n\n### Timestamp Handling (10 tests)\n- test_time_travel_snapshot_valid_timestamp\n- test_time_travel_snapshot_past_timestamp\n- test_time_travel_snapshot_utc_timestamp\n- test_time_travel_snapshot_timezone_offset\n- test_time_travel_snapshot_naive_timestamp\n- test_time_travel_snapshot_invalid_timestamp_format\n- test_time_travel_snapshot_missing_timestamp\n- test_time_travel_snapshot_partial_date_format\n- test_time_travel_snapshot_leap_second\n- test_time_travel_snapshot_negative_timezone\n- test_time_travel_snapshot_epoch\n\n### Error Handling (4 tests)\n- test_time_travel_snapshot_invalid_project\n- test_time_travel_snapshot_invalid_agent_name\n- test_time_travel_snapshot_nonexistent_agent\n- test_time_travel_snapshot_nonexistent_project\n\n### Response Validation (3 tests)\n- test_time_travel_snapshot_response_structure\n- test_time_travel_snapshot_message_fields\n- test_time_travel_snapshot_project_no_messages\n\n### Security (2 tests)\n- test_time_travel_snapshot_xss_in_project\n- test_time_travel_snapshot_xss_in_agent\n\n### Edge Cases (2 tests)\n- test_time_travel_page_no_projects\n- test_time_travel_snapshot_project_no_messages\n\n## Reference\n- Python: tests/test_time_travel.py\n- Python: mcp_agent_mail/http.py (time-travel routes)\n\n## Implementation Notes\n- Requires git archive integration\n- Timezone-aware timestamp parsing critical\n- XSS protection in URL parameters","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:58:01.836289+05:30","updated_at":"2025-12-23T00:22:43.587517+05:30","closed_at":"2025-12-20T07:22:32.670619+05:30"}
{"id":"mcpmail-13","title":"Test agent workflow: add hello_world tool","description":"Test bead for verifying autonomous agent workflow.\n\n**Acceptance Criteria:**\n1. Add a simple `hello_world` MCP tool that returns a greeting\n2. Tool should accept optional `name` parameter\n3. Add unit test for the tool\n4. Run all quality gates\n\n**Purpose:** Validate init-new.md workflow works end-to-end.\n\n**Expected agent actions:**\n- Register via MCP\n- Reserve files\n- Create worktree\n- Implement tool\n- Run quality gates\n- Send [COMPLETION] message\n- Cleanup","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T18:32:15.629642+05:30","updated_at":"2025-12-23T00:22:43.548906+05:30","closed_at":"2025-12-22T18:35:13.979962+05:30"}
{"id":"mcpmail-130","title":"PORT: Share/Export Tests (39 security \u0026 integrity tests)","description":"## Description\nPort the 39 share/export tests from Python covering mailbox export security and integrity.\n\n## Test Categories\n\n### Scrub/Pseudonymization (3 tests)\n- test_scrub_snapshot_pseudonymizes_and_clears\n- test_scrub_snapshot_strict_preset\n- test_scrub_snapshot_archive_preset_preserves_runtime_state\n\n### Attachment Bundling (1 test)\n- test_bundle_attachments_handles_modes\n\n### Manifest \u0026 Structure (3 tests)\n- test_summarize_snapshot\n- test_manifest_snapshot_structure\n- test_run_share_export_wizard\n\n### Security (8 tests)\n- test_sign_and_verify_manifest\n- test_verify_bundle_without_signature\n- test_verify_bundle_with_sri\n- test_verify_bundle_missing_sri_asset\n- test_decrypt_with_age_requires_age_binary\n- test_decrypt_with_age_validation\n- test_sri_computation\n- test_build_viewer_sri\n\n### Export Wizard (5 tests)\n- test_share_export_dry_run\n- test_start_preview_server_serves_content\n- test_share_export_chunking_and_viewer_data\n- test_verify_viewer_vendor_assets\n- test_maybe_chunk_database_rejects_zero_chunk_size\n\n## Reference\n- Python: tests/test_share_export.py\n- Python: mcp_agent_mail/share.py\n\n## Implementation Notes\n- Tests critical for data integrity during export\n- SRI (Subresource Integrity) verification\n- Age encryption support\n- Manifest signing/verification","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:58:01.644918+05:30","updated_at":"2025-12-23T00:22:43.587737+05:30","closed_at":"2025-12-20T07:02:11.890342+05:30"}
{"id":"mcpmail-131","title":"Create Inbox view page","description":"List messages for agent, filter by read/unread","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-09T01:40:41.941117+05:30","updated_at":"2025-12-23T00:22:43.587939+05:30","closed_at":"2025-12-09T02:36:52.057951+05:30","dependencies":[{"issue_id":"mcpmail-131","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.941511+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-132","title":"Create Message compose modal","description":"Send new message with recipients, subject, body","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-09T01:40:42.010916+05:30","updated_at":"2025-12-23T00:22:43.588165+05:30","closed_at":"2025-12-09T02:36:52.099969+05:30","dependencies":[{"issue_id":"mcpmail-132","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:42.011282+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-133","title":"PORT: Python E2E Integration Tests (3 test files)","description":"## Description\nPort the 3 Python E2E/integration test files to Rust.\n\n## Python E2E Tests to Port\n\n### 1. test_archive_workflow.py\n- Archive save/list/restore cycle\n- Data integrity verification (ack_required, timestamps)\n- Storage root file restoration\n\n### 2. test_mailbox_share_integration.py\n- Share export with inline/detach thresholds\n- Manifest verification (stats, scrub, hosting)\n- Viewer generation (HTML/CSS/JS)\n- ZIP archive creation\n- Playwright browser smoke test\n- XSS sanitization verification\n\n### 3. test_worktrees_functionality_e2e.py\n- Gate toggle (WORKTREES_ENABLED on/off)\n- MCP surface verification (tools/resources)\n- Git repo + worktree creation\n- Guard installation via CLI\n- Conflict detection (pre-commit, pre-push style)\n- Product Bus round-trip (ensure_product, products_link, resource read)\n\n## Reference Files\n- Python: mcp_agent_mail/tests/integration/\n- docs/E2E_TEST_PLAN.md (existing plan for browser E2E)\n- Rust: crates/tests/e2e/tests/cli_tests.rs (minimal existing)\n\n## Implementation Notes\n- Consider using assert_cmd for CLI testing\n- May need to adapt Playwright tests for Probar/WASM-native approach\n- Gate toggle tests require env var manipulation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:47:35.591546+05:30","updated_at":"2025-12-23T00:22:43.588433+05:30","closed_at":"2025-12-21T21:43:04.562413+05:30"}
{"id":"mcpmail-134","title":"PORT: Unified Inbox Web UI (Gmail-style /mail routes)","description":"## Description\nPort the unified inbox web UI from Python to Rust. This provides a Gmail-style view of ALL messages across ALL projects.\n\n## Python Implementation\n- `/mail` - HTML unified inbox route\n- `/mail/api/unified-inbox` - JSON API endpoint  \n- `/mail/unified-inbox` - HTML with filtering\n- `templates/mail_unified_inbox.html` - Jinja2 template\n\n## Reference Files\n- Python: `mcp_agent_mail/http.py` lines 1144-1303\n- Python template: `mcp_agent_mail/templates/mail_unified_inbox.html`\n- docs/mcp-agent-mail-python-beads-diff.md\n- docs/mcp-agent-mail-python-tree.md\n\n## Implementation Notes\n- Rust has `product_inbox` MCP tool (product-scoped, not global)\n- Need to add web routes to lib-server/src/api.rs\n- Consider Leptos SSR or HTMX for HTML rendering\n- Port filtering by importance feature","notes":"Worker-s0j starting implementation with EXTREME TDD","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:44:00.014788+05:30","updated_at":"2025-12-23T00:22:43.588657+05:30","closed_at":"2025-12-19T23:18:02.435171+05:30"}
{"id":"mcpmail-135","title":"PORT-7.3: Add image processing edge case tests (26 tests)","description":"## Problem\nNeed comprehensive edge case tests for image processing.\n\n## Implementation\nPort 26 Python tests:\n- Malformed Image Tests (3)\n- Image Mode Tests (5): P, LA, RGBA, L, 1-bit\n- Data URI Edge Cases (4)\n- File Extension Edge Cases (3)\n- Multiple Images Tests (2)\n- Attachment Path Edge Cases (3): spaces, unicode, symlinks\n- Image Format Tests (3): GIF, BMP, JPEG conversion\n- Size Edge Cases (2): 1x1 pixel, large images\n\n## Files\n- crates/libs/lib-core/tests/image_edge_tests.rs (NEW)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/tests/test_image_processing_edge.py\n- Commit b509808: test(images): add edge case tests for image processing\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: image, edge, PIL)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 7.3)\n\n## Acceptance Criteria\n- [ ] All 26 tests ported\n- [ ] Use image crate for Rust\n- [ ] Proper cleanup of temp files\n- [ ] Tests for all image modes\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:34.498803+05:30","updated_at":"2025-12-23T00:22:43.588993+05:30","closed_at":"2025-12-19T17:02:18.652509+05:30"}
{"id":"mcpmail-136","title":"PORT-7.2: Add guard worktree tests (18 tests)","description":"## Problem\nNeed comprehensive tests for guard in worktree scenarios.\n\n## Implementation\nPort 18 Python tests:\n- Basic Worktree Installation (2)\n- Custom core.hooksPath Handling (2)\n- Hook Preservation Logic (2)\n- Gate Environment Variable Tests (4)\n- Advisory/Bypass Mode Tests (2)\n- Pre-push Guard Tests (2)\n- Lifecycle Tests (2)\n- Chain Runner Tests (1)\n\n## Files\n- crates/libs/lib-core/tests/guard_worktree_tests.rs (NEW)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/tests/test_guard_worktrees.py\n- Commit 733cfd3: test(guard): add comprehensive tests for worktree scenarios\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: worktree, guard, test)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 7.2)\n\n## Acceptance Criteria\n- [ ] All 18 tests ported\n- [ ] Tests create real git repos/worktrees\n- [ ] Environment variable isolation\n- [ ] Cleanup after tests\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:34.433619+05:30","updated_at":"2025-12-23T00:22:43.589378+05:30","closed_at":"2025-12-19T16:18:42.600953+05:30"}
{"id":"mcpmail-137","title":"Create Message thread view","description":"Display conversation thread with replies","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-09T01:40:42.082919+05:30","updated_at":"2025-12-23T00:22:43.589591+05:30","closed_at":"2025-12-09T02:36:52.14057+05:30","dependencies":[{"issue_id":"mcpmail-137","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:42.083294+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-138","title":"PORT-6.3: Add port validation before server start","description":"## Problem\nShould validate port availability before attempting to bind.\n\n## Implementation\n- validate_port() trying TcpListener::bind\n- Return helpful error if port in use\n- Suggest: kill command, alternative port\n\n## Files\n- crates/services/mcp-agent-mail/src/main.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/scripts/install.sh\n- Commit 8754da9: fix(install): define logging functions before port validation\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: port, validation)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 6.3)\n\n## Acceptance Criteria\n- [ ] Port validated before server start\n- [ ] Helpful error if port in use\n- [ ] Suggests kill command and alternative\n- [ ] Tests for port validation\n\n## Complexity: 3/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:06.327389+05:30","updated_at":"2025-12-23T00:22:43.589861+05:30","closed_at":"2025-12-19T16:23:45.006014+05:30"}
{"id":"mcpmail-139","title":"Implement file_reservation_paths tool","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T01:58:15.746382+05:30","updated_at":"2025-12-23T00:22:43.590056+05:30","closed_at":"2025-12-09T02:03:54.920209+05:30","dependencies":[{"issue_id":"mcpmail-139","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T01:58:15.746848+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-14","title":"Use constants for capability names","description":"Capability names (send_message, fetch_inbox, etc.) are hardcoded strings. Extract to constants or enum to prevent typos and enable IDE support.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-22T20:22:28.293485+05:30","updated_at":"2025-12-23T00:22:43.549179+05:30","closed_at":"2025-12-22T20:33:00.19259+05:30"}
{"id":"mcpmail-140","title":"PORT-6.1: Add 'am' shell alias in installer script","description":"## Problem\nNeed quick alias for starting server: 'am' instead of 'mcp-agent-mail serve http'.\n\n## Implementation\n- add_am_alias() in install.sh\n- Detect shell (zsh, bash, fish)\n- Add to appropriate rc file\n- Idempotent (check before adding)\n\n## Files\n- scripts/install.sh\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/scripts/install.sh\n- Commit 0810f80: feat(install): add 'am' shell alias\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: alias, am)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 6.1)\n\n## Acceptance Criteria\n- [ ] 'am' alias added to shell rc\n- [ ] Idempotent (no duplicates)\n- [ ] Works for bash, zsh, fish\n- [ ] User informed to source rc\n\n## Complexity: 2/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:06.200774+05:30","updated_at":"2025-12-23T00:22:43.590294+05:30","closed_at":"2025-12-19T16:18:51.572725+05:30"}
{"id":"mcpmail-141","title":"PORT-4.2: Add per-tool rate limiting configuration","description":"## Problem\nDifferent tools should have different rate limits (writes lower, reads higher).\n\n## Implementation\n- RateLimitConfig with tool_limits HashMap\n- Write tools: 10 rps (send_message, file_reservation_paths)\n- Read tools: 100 rps (fetch_inbox, search_messages)\n- Default: 50 rps\n\n## Files\n- crates/libs/lib-server/src/ratelimit.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/http.py\n- Commit 3498791: fix(http): correct variable scoping in rate limiting\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: rate limit, per-tool)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 4.2)\n\n## NIST Control: SC-5 (DoS Protection)\n\n## Acceptance Criteria\n- [ ] Per-tool rate limit configuration\n- [ ] Write tools: lower limits (10 rps)\n- [ ] Read tools: higher limits (100 rps)\n- [ ] Configurable via environment\n- [ ] Tests verify tool-specific limits\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:44.128001+05:30","updated_at":"2025-12-23T00:22:43.590508+05:30","closed_at":"2025-12-19T16:01:20.941412+05:30"}
{"id":"mcpmail-142","title":"PORT-4.1: Fix JWT identity extraction in rate limiting bucket key","description":"## Problem\nRate limit bucket key should include JWT subject for per-user limits.\n\n## Implementation\n- get_bucket_key() extracting JWT claims\n- Format: \"{sub}:{ip}\" when JWT present\n- Fallback to IP-only for unauthenticated\n\n## Files\n- crates/libs/lib-server/src/ratelimit.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/http.py\n- Commit 3498791: fix(http): correct variable scoping in rate limiting\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: rate limit, JWT, bucket)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 4.1)\n\n## NIST Control: SC-5 (DoS Protection)\n\n## Acceptance Criteria\n- [ ] Rate limit key includes JWT subject when present\n- [ ] Fallback to IP-only for unauthenticated\n- [ ] Tests verify per-user rate limiting with JWT\n\n## Complexity: 4/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:44.063398+05:30","updated_at":"2025-12-23T00:22:43.59075+05:30","closed_at":"2025-12-19T15:52:04.194644+05:30"}
{"id":"mcpmail-143","title":"Messaging: mark_message_read tool","description":"Track read status for messages","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:48.340747+05:30","updated_at":"2025-12-23T00:22:43.590945+05:30","closed_at":"2025-12-09T04:14:46.49153+05:30","labels":["mcp-tool","messaging"],"dependencies":[{"issue_id":"mcpmail-143","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:48.341148+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-144","title":"PORT-3.3: Add pre-push guard support with STDIN ref handling","description":"## Problem\nNeed pre-push hook separate from pre-commit for push-time validation.\n\n## Implementation\n- render_prepush_script() generating shell script\n- Read remote refs from stdin (local_ref local_sha remote_ref remote_sha)\n- Call /api/guard/check-push endpoint\n- Graceful degradation if server unreachable\n\n## Files\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/guard.py\n- Commit 733cfd3: test(guard): add comprehensive tests for worktree scenarios\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: pre-push, prepush)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 3.3)\n\n## Acceptance Criteria\n- [ ] Pre-push script reads stdin for refs\n- [ ] Calls server check-push endpoint\n- [ ] Graceful if server unreachable\n- [ ] install_precommit_guard installs both hooks\n- [ ] Tests for pre-push installation\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:26.201388+05:30","updated_at":"2025-12-23T00:22:43.591222+05:30","closed_at":"2025-12-19T15:37:06.648192+05:30"}
{"id":"mcpmail-145","title":"Messaging: acknowledge_message tool","description":"Acknowledge receipt of messages requiring ACK","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:48.410436+05:30","updated_at":"2025-12-23T00:22:43.591431+05:30","closed_at":"2025-12-09T04:14:46.542652+05:30","labels":["mcp-tool","messaging"],"dependencies":[{"issue_id":"mcpmail-145","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:48.410826+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-146","title":"PORT-3.1: Honor WORKTREES_ENABLED gate in pre-commit guard","description":"## Problem\nPre-commit guard should only run when WORKTREES_ENABLED or GIT_IDENTITY_ENABLED is set.\n\n## Implementation\n- Add should_check() method checking env vars\n- Early return from check_reservations() if not enabled\n- Support truthy values: 1, true, yes, t, y (case-insensitive)\n- Log skip reason for debugging\n\n## Files\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/guard.py\n- Commit 8fd0238: fix(guard): honor WORKTREES_ENABLED gate\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: WORKTREES_ENABLED, guard)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 3.1)\n\n## Acceptance Criteria\n- [ ] WORKTREES_ENABLED=0 causes early exit\n- [ ] GIT_IDENTITY_ENABLED as alternative gate\n- [ ] Truthy values recognized (case-insensitive)\n- [ ] Log message when skipping\n- [ ] Tests verify gate behavior\n\n## Complexity: 3/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:05.058104+05:30","updated_at":"2025-12-23T00:22:43.591689+05:30","closed_at":"2025-12-19T05:54:45.878699+05:30"}
{"id":"mcpmail-147","title":"P1: Increase test coverage from 65% to 85%","description":"PMAT rust-project-score shows Testing Excellence at 2.5/20 (12.5%). Current coverage: 65%, target: 85%. Priority areas: 1) Error handling paths in lib-server (auth failures, rate limit exceeded), 2) Edge cases in lib-core BMC methods (concurrent access, null inputs), 3) MCP tool error responses (invalid params, project not found). Install cargo-llvm-cov, run: cargo llvm-cov --workspace. Create tests for uncovered branches. Relates to existing bead 577.6.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T20:52:04.694495+05:30","updated_at":"2025-12-23T00:22:43.5919+05:30","closed_at":"2025-12-17T21:06:04.009434+05:30"}
{"id":"mcpmail-148","title":"Contacts: request_contact tool","description":"Request to add another agent as contact","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:54.416228+05:30","updated_at":"2025-12-23T00:22:43.59215+05:30","closed_at":"2025-12-09T04:14:46.683416+05:30","labels":["contacts","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-148","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:54.416641+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-149","title":"Contacts: respond_contact tool","description":"Accept/reject contact requests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:54.494387+05:30","updated_at":"2025-12-23T00:22:43.592397+05:30","closed_at":"2025-12-09T04:14:46.730573+05:30","labels":["contacts","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-149","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:54.494789+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-15","title":"EPIC: Web UI Polish - Core Infrastructure","description":"## Overview\nEstablish production-grade UI infrastructure matching Python reference implementation quality.\n\n## Design Analysis (from screenshots)\n- Clean purple/indigo accent color scheme (#6366f1)\n- Glassmorphism navigation header\n- Consistent spacing (16px base grid)\n- Lucide icons throughout\n- Dark mode toggle in header\n- Responsive layout with sidebar collapse\n\n## Deliverables\n1. Design token system (CSS custom properties)\n2. Enhanced navigation with breadcrumbs\n3. Dark mode persistence with system preference detection\n4. Mobile-responsive navigation (hamburger menu)\n5. Loading skeleton components\n6. Toast notification system\n\n## Acceptance Criteria\n- [ ] LCP ≤ 2.5s on mobile 3G\n- [ ] CLS ≤ 0.1 (no layout shift)\n- [ ] WCAG 2.2 AA compliance\n- [ ] Works offline (service worker)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T06:04:01.884322+05:30","updated_at":"2025-12-23T00:22:43.549529+05:30","closed_at":"2025-12-20T21:27:29.734667+05:30","dependencies":[{"issue_id":"mcpmail-15","depends_on_id":"mcpmail-250","type":"blocks","created_at":"2025-12-19T22:08:53.955821+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-15","depends_on_id":"mcpmail-397","type":"blocks","created_at":"2025-12-19T22:08:54.011773+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-150","title":"Contacts: list_contacts tool","description":"List agent contacts with filtering","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:54.575734+05:30","updated_at":"2025-12-23T00:22:43.592652+05:30","closed_at":"2025-12-09T04:14:46.777201+05:30","labels":["contacts","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-150","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:54.576104+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-151","title":"Update lib-server router with conditional UI fallback","description":"Add serve_ui config option to ServerConfig. Conditionally add fallback route when feature enabled and serve_ui=true.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T17:52:51.899301+05:30","updated_at":"2025-12-23T00:22:43.592905+05:30","closed_at":"2025-12-17T18:58:54.274058+05:30","dependencies":[{"issue_id":"mcpmail-151","depends_on_id":"mcpmail-153","type":"blocks","created_at":"2025-12-17T17:52:59.995857+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-151","depends_on_id":"mcpmail-364","type":"blocks","created_at":"2025-12-17T17:53:00.040644+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-152","title":"Contacts: set_contact_policy tool","description":"Set agent contact acceptance policy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:13:54.653012+05:30","updated_at":"2025-12-23T00:22:43.593219+05:30","closed_at":"2025-12-09T04:14:46.820258+05:30","labels":["contacts","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-152","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:54.653376+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-153","title":"Create embedded.rs for WASM asset embedding","description":"Create lib-server/src/embedded.rs with RustEmbed derive macro pointing to web-ui-leptos/dist folder.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T17:52:51.484763+05:30","updated_at":"2025-12-23T00:22:43.594978+05:30","closed_at":"2025-12-17T18:56:51.100879+05:30","dependencies":[{"issue_id":"mcpmail-153","depends_on_id":"mcpmail-372","type":"blocks","created_at":"2025-12-17T17:52:59.903471+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-154","title":"Build Slots: acquire_build_slot","description":"Acquire exclusive build slot for CI/CD isolation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:45.099341+05:30","updated_at":"2025-12-23T00:22:43.595312+05:30","closed_at":"2025-12-09T04:14:46.863448+05:30","labels":["build-slots","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-154","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:45.099688+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-155","title":"Build Slots: renew_build_slot","description":"Extend TTL on active build slot","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:45.329611+05:30","updated_at":"2025-12-23T00:22:43.595591+05:30","closed_at":"2025-12-09T04:14:46.907362+05:30","labels":["build-slots","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-155","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:45.329956+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-156","title":"Fix clippy collapsible_if warnings","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T16:41:39.277074+05:30","updated_at":"2025-12-23T00:22:43.595826+05:30","closed_at":"2025-12-17T16:46:32.187516+05:30"}
{"id":"mcpmail-157","title":"Build Slots: release_build_slot","description":"Release held build slot","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:45.567124+05:30","updated_at":"2025-12-23T00:22:43.596013+05:30","closed_at":"2025-12-09T04:14:46.951122+05:30","labels":["build-slots","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-157","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:45.56748+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-158","title":"Search: summarize_thread","description":"LLM-powered thread summarization for single thread","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:58.40135+05:30","updated_at":"2025-12-23T00:22:43.596261+05:30","closed_at":"2025-12-09T04:16:34.021976+05:30","labels":["mcp-tool","search"],"dependencies":[{"issue_id":"mcpmail-158","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:58.401721+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-159","title":"Search: summarize_threads","description":"Batch thread summarization with context limits","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:58.618307+05:30","updated_at":"2025-12-23T00:22:43.596501+05:30","closed_at":"2025-12-09T04:16:34.106943+05:30","labels":["mcp-tool","search"],"dependencies":[{"issue_id":"mcpmail-159","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:58.618666+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-16","title":"Layout: Split View Message Panel (Gmail-style)","description":"## Task\nImplement Gmail-style split view layout for unified inbox.\n\n## Design (from screenshots)\nDesktop (≥1024px):\n```\n┌─────────────────────────────────────────────────────────────┐\n│ [Filter Bar - full width]                                   │\n├────────────────────────┬────────────────────────────────────┤\n│  Message List (35%)    │  Message Detail (65%)              │\n│  ┌──────────────────┐  │  ┌────────────────────────────────┐│\n│  │ ○ GreenHill      │  │  │ Backend-Frontend Sync          ││\n│  │   Contact req... │  │  │                                ││\n│  ├──────────────────┤  │  │ FROM: OrangeLake    TO: Pink...││\n│  │ ● OrangeLake ←   │  │  │ PROJECT: /data/projects/smart..││\n│  │   Backend-Front..│  │  │ SENT: Oct 26, 2025 at 11:37 PM ││\n│  ├──────────────────┤  │  │                                ││\n│  │ ○ PinkCastle     │  │  │ [Copy Link] [Open in Project]  ││\n│  │   Re: Updated... │  │  │                                ││\n│  └──────────────────┘  │  │ ─────────────────────────────  ││\n│                        │  │ Hi PinkCastle,                 ││\n│                        │  │                                ││\n│                        │  │ Thanks for partnering on the   ││\n│                        │  │ harmonization work...          ││\n│                        │  └────────────────────────────────┘│\n└────────────────────────┴────────────────────────────────────┘\n```\n\nMobile (\u003c 1024px):\n- Single column, message list only\n- Clicking opens message detail page (existing behavior)\n\nTablet (768-1023px):\n- Optional: 40/60 split or single column with slide-over\n\n## Implementation\n```rust\n#[component]\npub fn SplitViewLayout(\n    list_panel: Children,\n    detail_panel: Children,\n    #[prop(default = 35)] list_width_percent: u8,\n) -\u003e impl IntoView {\n    view! {\n        \u003cdiv class=\"hidden lg:grid lg:grid-cols-[35%_65%] h-[calc(100vh-12rem)]\"\u003e\n            \u003cdiv class=\"border-r border-cream-200 dark:border-charcoal-700 overflow-y-auto\"\u003e\n                {list_panel()}\n            \u003c/div\u003e\n            \u003cdiv class=\"overflow-y-auto\"\u003e\n                {detail_panel()}\n            \u003c/div\u003e\n        \u003c/div\u003e\n        // Mobile fallback\n        \u003cdiv class=\"lg:hidden\"\u003e\n            {list_panel()}\n        \u003c/div\u003e\n    }\n}\n```\n\n## State Management\n- Selected message ID stored in signal\n- Detail panel reacts to selection change\n- No page navigation on desktop\n\n## Files\n- `components/split_view.rs` (new)\n- `pages/unified_inbox.rs` (refactor to use split view)\n\n## Acceptance Criteria\n- [ ] Smooth transitions when selecting messages\n- [ ] Keyboard: up/down arrows navigate list, Enter opens\n- [ ] Selected item has visual indicator (left border)\n- [ ] Scrolling list doesn't affect detail panel\n- [ ] Detail panel shows \"Select a message\" when none selected","notes":"Claimed by worker-nzeq","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:08:25.859004+05:30","updated_at":"2025-12-23T00:22:43.549925+05:30","closed_at":"2025-12-18T18:36:54.912923+05:30"}
{"id":"mcpmail-160","title":"P1: Add test for CC/BCC message recipients (79665f2)","description":"CC/BCC support (79665f2) adds cc_ids/bcc_ids to messages but no test. Add test_cc_bcc_recipients() to verify: 1) CC recipients appear in message_recipients with kind='cc', 2) BCC recipients appear with kind='bcc', 3) BCC not visible to other recipients.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-12T17:59:02.406686+05:30","updated_at":"2025-12-23T00:22:43.596764+05:30","closed_at":"2025-12-15T19:59:16.570161+05:30","dependencies":[{"issue_id":"mcpmail-160","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T17:59:02.407255+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-161","title":"P1: Add test for built-in macros registration (b511528)","description":"Built-in macros (b511528) registers 5 macros on project creation but has no test. Add test_builtin_macros_registered() to verify: start_session, prepare_thread, file_reservation_cycle, contact_handshake, broadcast_message are created.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-12T17:59:02.16831+05:30","updated_at":"2025-12-23T00:22:43.597021+05:30","closed_at":"2025-12-15T19:59:16.62402+05:30","dependencies":[{"issue_id":"mcpmail-161","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T17:59:02.16961+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-162","title":"P1: Add agent_capabilities table for RBAC","description":"Create migration: CREATE TABLE agent_capabilities (id INTEGER PRIMARY KEY, agent_id INTEGER REFERENCES agents(id), capability TEXT NOT NULL, granted_at TEXT NOT NULL). Required for RBAC enforcement.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:55:26.92608+05:30","updated_at":"2025-12-23T00:22:43.597257+05:30","closed_at":"2025-12-15T19:59:16.683308+05:30","dependencies":[{"issue_id":"mcpmail-162","depends_on_id":"mcpmail-168","type":"blocks","created_at":"2025-12-12T10:55:26.926926+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-163","title":"P1: Add recipient_type column to message_recipients table","description":"Create migration: ALTER TABLE message_recipients ADD COLUMN recipient_type TEXT DEFAULT 'to' CHECK(recipient_type IN ('to','cc','bcc')). Required for CC/BCC support.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:55:26.641995+05:30","updated_at":"2025-12-23T00:22:43.597493+05:30","closed_at":"2025-12-15T19:59:16.738996+05:30","dependencies":[{"issue_id":"mcpmail-163","depends_on_id":"mcpmail-167","type":"blocks","created_at":"2025-12-12T10:55:26.645515+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-164","title":"P1: Add JWT/JWKS authentication support","description":"Extend bearer token auth with JWT/JWKS: HTTP_AUTH_MODE=jwt, HTTP_JWKS_URL for key discovery. Validate JWT claims, check expiry, verify signature. Builds on bearer token middleware (577.11).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:34.426196+05:30","updated_at":"2025-12-23T00:22:43.59773+05:30","closed_at":"2025-12-15T19:59:16.791825+05:30","dependencies":[{"issue_id":"mcpmail-164","depends_on_id":"mcpmail-405","type":"blocks","created_at":"2025-12-12T10:54:34.426947+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-165","title":"P1: Complete Git archive integration (messages as markdown)","description":"Write messages to Git as markdown files: data/archive/projects/{slug}/messages/YYYY/MM/msg_{id}.md. Maintain inbox/outbox symlinks per agent. Store file_reservations as JSON. Python structure parity.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:34.014981+05:30","updated_at":"2025-12-23T00:22:43.597988+05:30","closed_at":"2025-12-15T20:44:23.280124+05:30","dependencies":[{"issue_id":"mcpmail-165","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:34.015686+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-166","title":"P1: Implement project siblings endpoints","description":"Implement /api/projects/siblings, /api/projects/siblings/refresh, /api/projects/siblings/confirm. Model exists (project_sibling_suggestions). Add heuristic scoring for related projects (frontend/backend detection).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:33.685436+05:30","updated_at":"2025-12-23T00:22:43.598264+05:30","closed_at":"2025-12-15T20:44:23.326662+05:30","dependencies":[{"issue_id":"mcpmail-166","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:33.686113+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-167","title":"P1: Add CC/BCC recipient support to messages","description":"Extend SendMessagePayload with cc_names/bcc_names. Add recipient_type column to message_recipients table. Update send_message handler to create recipient entries with type='to'/'cc'/'bcc'.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:33.349592+05:30","updated_at":"2025-12-23T00:22:43.5985+05:30","closed_at":"2025-12-15T20:44:23.371331+05:30","dependencies":[{"issue_id":"mcpmail-167","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:33.350317+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-168","title":"P1: Implement Capabilities/RBAC middleware","description":"Add capabilities config (deploy/capabilities/agent_capabilities.yaml) with role-based tool access: architect (send+reserve+summarize), worker (send+inbox+ack). Implement middleware for tool-level RBAC enforcement.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:33.006449+05:30","updated_at":"2025-12-23T00:22:43.598784+05:30","closed_at":"2025-12-15T20:44:23.200316+05:30","dependencies":[{"issue_id":"mcpmail-168","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:33.00711+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-169","title":"Macros: invoke_macro","description":"Execute pre-defined macro with parameters","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:58.838261+05:30","updated_at":"2025-12-23T00:22:43.599066+05:30","closed_at":"2025-12-09T04:16:33.795508+05:30","labels":["macros","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-169","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:58.83861+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-17","title":"Page: File Reservations with Data Table","description":"## Task\nCreate new File Reservations page matching Python reference design.\n\n## Design (from screenshots)\n```\n┌─────────────────────────────────────────────────────────────────┐\n│ Projects \u003e /data/projects/smartedgar_mcp \u003e File Reservations    │\n├─────────────────────────────────────────────────────────────────┤\n│                                                                 │\n│  🛡️ File Reservations                                          │\n│  When agents want to edit files, they can \"reserve\" them to    │\n│  signal their intent to other agents.                          │\n│                                                                 │\n│  ┌───────────────────────────────────────────────────────────┐ │\n│  │ ℹ️ Advisory system: Reservations are signals, not hard    │ │\n│  │ locks. Agents can still edit files, but they'll see       │ │\n│  │ warnings if conflicts exist.                              │ │\n│  │ Install a pre-commit hook to enforce reservations at      │ │\n│  │ commit time.                                              │ │\n│  └───────────────────────────────────────────────────────────┘ │\n│                                                                 │\n│  4 active reservations                                          │\n│                                                                 │\n│  ┌───────────────────────────────────────────────────────────┐ │\n│  │ ID │ AGENT      │ PATH PATTERN         │ TYPE    │ CREATED│ │\n│  ├────┼────────────┼──────────────────────┼─────────┼────────┤ │\n│  │ #4 │ 🟢GreenHill│ src/.../routers/*.py │ 🔒Excl. │ Oct 26 │ │\n│  │ #3 │ 🟢GreenHill│ src/.../schemas.py   │ 🔒Excl. │ Oct 26 │ │\n│  │ #2 │ 🟢GreenHill│ src/.../portfolios.py│ 🔒Excl. │ Oct 26 │ │\n│  └───────────────────────────────────────────────────────────┘ │\n└─────────────────────────────────────────────────────────────────┘\n```\n\n## Components Needed\n1. **Breadcrumb Navigation** - Reusable component\n2. **Info Banner** - Advisory explanation with link\n3. **Data Table** - Columns: ID, Agent (avatar+name), Path Pattern (mono), Type, Created, Expires\n\n## API Endpoint\n`POST /api/file_reservations/list` with `{ project_slug: string }`\n\n## Implementation\n```rust\n#[component]\npub fn FileReservationsPage() -\u003e impl IntoView {\n    let params = use_params_map();\n    let project_slug = params.with_untracked(|p| p.get(\"slug\").unwrap_or_default());\n    \n    // Fetch reservations\n    let reservations = create_resource(\n        move || project_slug.clone(),\n        |slug| async move { client::get_file_reservations(\u0026slug).await }\n    );\n    \n    view! {\n        \u003cdiv class=\"space-y-6\"\u003e\n            \u003cBreadcrumb items=vec![\n                (\"Projects\", \"/projects\"),\n                (\u0026project_slug, \u0026format!(\"/projects/{}\", project_slug)),\n                (\"File Reservations\", \"\"),\n            ] /\u003e\n            \n            \u003cPageHeader \n                icon=\"shield\"\n                title=\"File Reservations\"\n                description=\"When agents want to edit files, they can 'reserve' them to signal their intent to other agents.\"\n            /\u003e\n            \n            \u003cInfoBanner variant=\"info\"\u003e\n                \u003cstrong\u003e\"Advisory system:\"\u003c/strong\u003e\n                \" Reservations are \"\n                \u003cem\u003e\"signals\"\u003c/em\u003e\n                \", not hard locks. Agents can still edit files, but they'll see warnings if conflicts exist.\"\n                \u003cbr /\u003e\n                \"Install a \"\n                \u003ca href=\"#\" class=\"text-amber-600 underline\"\u003e\"pre-commit hook\"\u003c/a\u003e\n                \" to enforce reservations at commit time.\"\n            \u003c/InfoBanner\u003e\n            \n            \u003cp class=\"text-sm text-charcoal-500\"\u003e\n                {move || reservations.get().map(|r| format!(\"{} active reservations\", r.len()))}\n            \u003c/p\u003e\n            \n            \u003cDataTable ... /\u003e\n        \u003c/div\u003e\n    }\n}\n```\n\n## Files\n- `pages/file_reservations.rs` (new)\n- `components/breadcrumb.rs` (new)\n- `components/info_banner.rs` (new)\n- `components/data_table.rs` (new)\n- `app.rs` (add route)\n\n## Acceptance Criteria\n- [ ] Route: /projects/{slug}/file-reservations\n- [ ] Breadcrumb navigates correctly\n- [ ] Table sortable by columns\n- [ ] Expired reservations shown with strikethrough\n- [ ] Agent avatars with consistent colors\n- [ ] Mobile: horizontal scroll for table","notes":"Claimed by worker-qkpm","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:09:54.084065+05:30","updated_at":"2025-12-23T00:22:43.550331+05:30","closed_at":"2025-12-18T19:36:45.316909+05:30"}
{"id":"mcpmail-170","title":"P1: Implement MCP Resources (5 resource URIs)","description":"Implement rmcp resource handler for 5 URIs: resource://inbox/{agent}, resource://outbox/{agent}, resource://thread/{id}, resource://agents, resource://file_reservations. Map to existing API calls.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:32.377532+05:30","updated_at":"2025-12-23T00:22:43.599367+05:30","closed_at":"2025-12-15T20:44:23.470673+05:30","dependencies":[{"issue_id":"mcpmail-170","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:32.378323+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-171","title":"P1: Implement /api/outbox endpoint (fetch_outbox)","description":"Add /api/outbox POST endpoint to fetch messages sent BY an agent (vs inbox which is TO). Python: fetch_outbox(project_key, agent_name, limit=20).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:32.070627+05:30","updated_at":"2025-12-23T00:22:43.599622+05:30","closed_at":"2025-12-15T20:44:23.517586+05:30","dependencies":[{"issue_id":"mcpmail-171","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:32.071667+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-172","title":"P1: Add URL state sync (query params)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:39:46.206261+05:30","updated_at":"2025-12-23T00:22:43.599868+05:30","closed_at":"2025-12-15T18:44:53.991604+05:30","dependencies":[{"issue_id":"mcpmail-172","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.907338+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-173","title":"P1: Implement error boundaries and fallbacks","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:39:46.135098+05:30","updated_at":"2025-12-23T00:22:43.600093+05:30","closed_at":"2025-12-15T18:44:54.037518+05:30","dependencies":[{"issue_id":"mcpmail-173","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.863195+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-174","title":"P1: Add loading skeletons and Suspense boundaries","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:39:46.068676+05:30","updated_at":"2025-12-23T00:22:43.600355+05:30","closed_at":"2025-12-15T18:44:54.078472+05:30","dependencies":[{"issue_id":"mcpmail-174","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.808381+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-175","title":"P1: Create API server functions (share lib-core types)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:39:46.003396+05:30","updated_at":"2025-12-23T00:22:43.600588+05:30","closed_at":"2025-12-15T18:44:54.120313+05:30","dependencies":[{"issue_id":"mcpmail-175","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.762254+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-176","title":"P1: Port Agents page with search/filter","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:39:45.941141+05:30","updated_at":"2025-12-23T00:22:43.600825+05:30","closed_at":"2025-12-15T18:44:54.161382+05:30","dependencies":[{"issue_id":"mcpmail-176","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.714714+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-177","title":"Phase 10: Port Web UI to Leptos (Rust/WASM)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-11T23:39:27.878944+05:30","updated_at":"2025-12-23T00:22:43.601054+05:30","closed_at":"2025-12-15T18:44:27.801739+05:30"}
{"id":"mcpmail-178","title":"P1: Add WCAG AA accessibility tests (ACC-001 to ACC-008)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:33:39.250033+05:30","updated_at":"2025-12-23T00:22:43.601967+05:30","closed_at":"2025-12-15T18:44:39.910508+05:30","dependencies":[{"issue_id":"mcpmail-178","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.316126+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-179","title":"P1: Implement remaining user flows (UF-005 to UF-012)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:33:39.183091+05:30","updated_at":"2025-12-23T00:22:43.602326+05:30","closed_at":"2025-12-15T18:44:54.202502+05:30","dependencies":[{"issue_id":"mcpmail-179","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.269009+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-18","title":"P0: Add backend panic hook for production resilience","description":"## Summary\nAdd global panic hook to capture panics before process termination. Critical for production observability.\n\n## Implementation\n```rust\n// In main.rs or lib initialization\nuse std::panic;\n\npub fn init_panic_hook() {\n    let original_hook = panic::take_hook();\n    panic::set_hook(Box::new(move |panic_info| {\n        // Log to stderr for container logs\n        eprintln\\!(\"PANIC: {panic_info}\");\n        \n        // Capture location if available\n        if let Some(location) = panic_info.location() {\n            eprintln\\!(\"  at {}:{}:{}\", \n                location.file(), \n                location.line(), \n                location.column()\n            );\n        }\n        \n        // Optionally report to error tracking (Sentry)\n        #[cfg(feature = \"sentry\")]\n        sentry::capture_message(\n            \u0026format\\!(\"Panic: {panic_info}\"),\n            sentry::Level::Fatal,\n        );\n        \n        // Call original hook\n        original_hook(panic_info);\n    }));\n}\n```\n\n## Location\ncrates/services/mcp-agent-mail/src/main.rs (before tokio::main)\n\n## Acceptance Criteria\n- [ ] Panic hook installed before runtime starts\n- [ ] Panics logged with file:line:column\n- [ ] Optional Sentry integration behind feature flag\n- [ ] Doesn't interfere with normal error handling\n- [ ] Test with intentional panic in dev mode\n\n## Reference\nproduction-hardening-backend skill: Defense in Depth, Fault Tolerance","status":"closed","issue_type":"task","created_at":"2025-12-19T19:03:45.062064+05:30","updated_at":"2025-12-23T00:22:43.55069+05:30","closed_at":"2025-12-20T03:43:52.820659+05:30"}
{"id":"mcpmail-180","title":"Macros: list_macros","description":"List available macros and their parameters","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:59.062926+05:30","updated_at":"2025-12-23T00:22:43.602611+05:30","closed_at":"2025-12-09T04:16:33.845206+05:30","labels":["macros","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-180","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:59.063289+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-181","title":"P1: Implement Agents page E2E tests (A-001 to A-006)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:33:39.05267+05:30","updated_at":"2025-12-23T00:22:43.602893+05:30","closed_at":"2025-12-15T18:44:27.216673+05:30","dependencies":[{"issue_id":"mcpmail-181","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.16366+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-182","title":"P1: Add data-testid attributes to web-ui components","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:33:38.986324+05:30","updated_at":"2025-12-23T00:22:43.603179+05:30","closed_at":"2025-12-15T18:44:27.257372+05:30","dependencies":[{"issue_id":"mcpmail-182","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.102422+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-183","title":"Macros: register_macro","description":"Register new macro definition","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:17:59.294057+05:30","updated_at":"2025-12-23T00:22:43.603467+05:30","closed_at":"2025-12-09T04:16:33.900134+05:30","labels":["macros","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-183","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:59.294423+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-184","title":"Macros: unregister_macro","description":"Remove macro definition","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:10.284184+05:30","updated_at":"2025-12-23T00:22:43.603705+05:30","closed_at":"2025-12-09T04:16:33.967269+05:30","labels":["macros","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-184","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:10.285304+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-185","title":"Setup: install_precommit_guard","description":"Install pre-commit hook for file reservation enforcement","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:10.499605+05:30","updated_at":"2025-12-23T00:22:43.603941+05:30","closed_at":"2025-12-09T04:21:13.661099+05:30","labels":["mcp-tool","setup"],"dependencies":[{"issue_id":"mcpmail-185","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:10.500283+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-186","title":"Setup: uninstall_precommit_guard","description":"Remove pre-commit hook","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:10.717148+05:30","updated_at":"2025-12-23T00:22:43.604189+05:30","closed_at":"2025-12-09T04:21:13.710354+05:30","labels":["mcp-tool","setup"],"dependencies":[{"issue_id":"mcpmail-186","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:10.717949+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-187","title":"Attachments: add_attachment","description":"Add file attachment to message with content addressing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:22.496914+05:30","updated_at":"2025-12-23T00:22:43.604422+05:30","closed_at":"2025-12-09T04:21:13.758139+05:30","labels":["attachments","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-187","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:22.497769+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-188","title":"Attachments: get_attachment","description":"Retrieve attachment content by hash","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:22.716596+05:30","updated_at":"2025-12-23T00:22:43.604675+05:30","closed_at":"2025-12-09T04:21:13.806791+05:30","labels":["attachments","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-188","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:22.717349+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-189","title":"Core: update_agent_profile","description":"Update agent task_description or model","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:34.445158+05:30","updated_at":"2025-12-23T00:22:43.60491+05:30","closed_at":"2025-12-09T04:14:46.63492+05:30","labels":["core","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-189","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:34.445776+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-19","title":"Epic: Production Hardening - Rust Native Excellence","description":"## Overview\n\nComprehensive production hardening implementation based on PMAT analysis (104/134 = 77.6%) and production-hardening-backend/frontend skills audit.\n\n## Current State (pmat rust-project-score)\n- **Score**: 104/134 (77.6%) - Grade A+\n- **Gaps Identified**:\n  - Code Quality: 76.9% (20/26)\n  - Testing Excellence: 12.5% (2.5/20)\n  - Documentation: 46.7% (7/15)\n  - Performance \u0026 Benchmarking: 0% (0/10)\n\n## Security Audit Findings\n- ✅ Rate Limiting: Implemented (governor crate)\n- ✅ Graceful Shutdown: Implemented\n- ✅ Health Checks: Multiple endpoints\n- ⚠️ HSTS: Missing\n- ⚠️ Referrer-Policy: Missing\n- ⚠️ Permissions-Policy: Missing\n- ⚠️ Backend Panic Hook: Missing\n\n## Target Score\n- **pmat rust-project-score**: ≥130/134 (97%)\n- **TDG Average**: ≥97/100\n\n## Phases\n1. **Security Headers** (P0): HSTS, Referrer-Policy, Permissions-Policy\n2. **Error Resilience** (P0): Backend panic hook with Sentry\n3. **Testing Excellence** (P1): Coverage gate, mutation testing\n4. **Documentation** (P1): Rustdoc, CHANGELOG\n5. **Performance** (P2): Criterion benchmarks\n\n## Quality Gates\n- cargo check \u0026\u0026 cargo fmt --check \u0026\u0026 cargo clippy -- -D warnings\n- pmat analyze tdg --fail-on-violation\n- cargo test --all-features\n\n## Reference Skills\n- production-hardening-backend\n- rust-skills\n- paiml-mcp-toolkit","status":"closed","issue_type":"epic","created_at":"2025-12-19T18:55:34.832961+05:30","updated_at":"2025-12-23T00:22:43.551029+05:30","closed_at":"2025-12-19T19:00:19.952349+05:30"}
{"id":"mcpmail-190","title":"Overseer: send_overseer_message","description":"Human operator sends guidance message to agents","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:34.665209+05:30","updated_at":"2025-12-23T00:22:43.605192+05:30","closed_at":"2025-12-09T04:14:46.994587+05:30","labels":["mcp-tool","overseer"],"dependencies":[{"issue_id":"mcpmail-190","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:34.66608+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-191","title":"Add API client timeout and retry logic","description":"Add AbortController timeout (10s) and automatic retry (2 attempts) for transient network failures in src/lib/api/client.ts request function.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T02:45:20.316048+05:30","updated_at":"2025-12-23T00:22:43.605429+05:30","closed_at":"2025-12-15T18:44:54.243244+05:30","dependencies":[{"issue_id":"mcpmail-191","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:20.316612+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-192","title":"Add DOMPurify for sanitizing body_md content","description":"Install isomorphic-dompurify and sanitize message body_md before rendering with @html to prevent XSS attacks.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T02:45:20.126255+05:30","updated_at":"2025-12-23T00:22:43.605655+05:30","closed_at":"2025-12-15T18:44:54.424424+05:30","dependencies":[{"issue_id":"mcpmail-192","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:20.126894+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-193","title":"Threads: list_threads","description":"List all threads with pagination","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:18:35.123167+05:30","updated_at":"2025-12-23T00:22:43.605889+05:30","closed_at":"2025-12-09T04:14:46.588687+05:30","labels":["mcp-tool","threads"],"dependencies":[{"issue_id":"mcpmail-193","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:35.124393+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-194","title":"Add search/FTS integration tests","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T16:20:14.14546+05:30","updated_at":"2025-12-23T00:22:43.606136+05:30","closed_at":"2025-12-09T16:34:57.239597+05:30","dependencies":[{"issue_id":"mcpmail-194","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:14.147854+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-195","title":"Implement set_contact_policy tool","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T07:10:18.308737+05:30","updated_at":"2025-12-23T00:22:43.606365+05:30","closed_at":"2025-12-09T07:19:49.657736+05:30","dependencies":[{"issue_id":"mcpmail-195","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:18.310559+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-196","title":"Implement acknowledge_message tool","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T07:10:16.263248+05:30","updated_at":"2025-12-23T00:22:43.606582+05:30","closed_at":"2025-12-09T07:19:48.574843+05:30","dependencies":[{"issue_id":"mcpmail-196","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:16.265362+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-197","title":"Implement mark_message_read tool","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T07:10:14.409023+05:30","updated_at":"2025-12-23T00:22:43.606814+05:30","closed_at":"2025-12-09T07:19:46.832317+05:30","dependencies":[{"issue_id":"mcpmail-197","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:14.411304+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-198","title":"Set up unit test infrastructure in lib-core","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T07:10:12.68201+05:30","updated_at":"2025-12-23T00:22:43.608288+05:30","closed_at":"2025-12-09T07:17:34.448731+05:30","dependencies":[{"issue_id":"mcpmail-198","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:12.683937+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-199","title":"Phase 6: Feature Parity Verification","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-09T07:10:04.57872+05:30","updated_at":"2025-12-23T00:22:43.608549+05:30","closed_at":"2025-12-09T15:52:26.284824+05:30"}
{"id":"mcpmail-2","title":"EPIC: NTM Compatibility Layer","description":"Make mcp-agent-mail-rs fully compatible with ntm Go client.\n\n**Background:**\nThe ntm (NTM) Go client expects specific tool names that differ from our current implementation. This epic tracks all changes needed for full compatibility.\n\n**Scope:**\n1. Tool name aliases (fetch_inbox→check_inbox, etc.)\n2. Missing tools (list_project_agents, create_agent_identity, macro_start_session)\n3. Integration testing with ntm client\n\n**Success Criteria:**\n- [ ] ntm can connect to mcp-agent-mail-rs without errors\n- [ ] All 23 NTM-expected tools work correctly\n- [ ] No modifications needed to ntm Go client\n\n**Reference:**\n- NTM Go client: internal/agentmail/tools.go\n- Python impl: /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail","notes":"NTM Compatibility Layer COMPLETE. All tools implemented:\n- NTM-001: Tool aliases (fetch_inbox→list_inbox, release_file_reservations→release_reservation, renew_file_reservations→renew_file_reservation, whois schema)\n- NTM-002: list_project_agents alias\n- NTM-003: create_agent_identity schema added\n- NTM-004: macro_start_session schema added\nAll 9 NTM compatibility tests pass. Total tools: 49 (44 base + 5 aliases).","status":"closed","issue_type":"epic","created_at":"2025-12-22T06:40:03.884251+05:30","updated_at":"2025-12-23T00:22:43.545205+05:30","closed_at":"2025-12-22T07:44:03.936932+05:30"}
{"id":"mcpmail-20","title":"Component: Project Cards with Status Badges","description":"## Task\nEnhance project cards to match Python reference design with status badges.\n\n## Design (from screenshots)\n```\n┌──────────────────────────────────────┐\n│  Your Projects                       │\n│  2 projects in total                 │\n│                                      │\n│  ┌────────────────┐ ┌────────────────┐\n│  │ 📁            │ │ 📁            │\n│  │ /data/proj... │ │ /data/proj... │\n│  │ 🟢 Active     │ │ 🟢 Active     │\n│  │               │ │               │\n│  │ 📊 data-proj..│ │ 📊 data-proj..│\n│  │ 📅 2025-10-26 │ │ 📅 2025-10-26 │\n│  └────────────────┘ └────────────────┘\n└──────────────────────────────────────┘\n```\n\n## Card Components\n1. **Icon** - Folder icon with amber background\n2. **Path** - Truncated project path/slug\n3. **Status Badge** - Active (green), Inactive (gray)\n4. **Stats Row** - Agent count, message count\n5. **Timestamp** - Created/last active date\n\n## Status Logic\n- Active: Has messages in last 24h OR has active agents\n- Inactive: No recent activity\n\n## Implementation\n```rust\n#[component]\npub fn ProjectCard(\n    #[prop(into)] project: Project,\n    #[prop(default = 0)] agent_count: usize,\n    #[prop(default = 0)] message_count: usize,\n) -\u003e impl IntoView {\n    let is_active = is_project_active(\u0026project);\n    \n    view! {\n        \u003ca \n            href={format!(\"/projects/{}\", project.slug)}\n            class=\"card-elevated p-5 hover:shadow-lg group block\"\n        \u003e\n            // Icon\n            \u003cdiv class=\"w-12 h-12 rounded-xl bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center mb-4 group-hover:scale-105 transition-transform\"\u003e\n                \u003ci data-lucide=\"folder-open\" class=\"icon-xl text-amber-600\" /\u003e\n            \u003c/div\u003e\n            \n            // Path\n            \u003ch3 class=\"font-medium text-charcoal-800 dark:text-cream-100 truncate mb-2 group-hover:text-amber-600\"\u003e\n                {project.slug}\n            \u003c/h3\u003e\n            \n            // Status\n            \u003cdiv class=\"flex items-center gap-2 mb-4\"\u003e\n                \u003cspan class={format!(\"badge {}\", if is_active { \"badge-teal\" } else { \"bg-charcoal-100 text-charcoal-500\" })}\u003e\n                    {if is_active { \"Active\" } else { \"Inactive\" }}\n                \u003c/span\u003e\n            \u003c/div\u003e\n            \n            // Stats\n            \u003cdiv class=\"flex items-center gap-4 text-sm text-charcoal-500\"\u003e\n                \u003cspan class=\"flex items-center gap-1\"\u003e\n                    \u003ci data-lucide=\"bot\" class=\"icon-xs\" /\u003e\n                    {agent_count}\n                \u003c/span\u003e\n                \u003cspan class=\"flex items-center gap-1\"\u003e\n                    \u003ci data-lucide=\"mail\" class=\"icon-xs\" /\u003e\n                    {message_count}\n                \u003c/span\u003e\n                \u003cspan class=\"flex items-center gap-1\"\u003e\n                    \u003ci data-lucide=\"calendar\" class=\"icon-xs\" /\u003e\n                    {format_date(\u0026project.created_at)}\n                \u003c/span\u003e\n            \u003c/div\u003e\n        \u003c/a\u003e\n    }\n}\n```\n\n## Files\n- `components/project_card.rs` (new)\n- `pages/projects.rs` (use new component)\n- `pages/unified_inbox.rs` (add projects section at bottom)\n\n## Acceptance Criteria\n- [ ] Cards are responsive (grid adjusts to screen size)\n- [ ] Status badge reflects actual activity\n- [ ] Hover state with subtle scale animation\n- [ ] Click navigates to project detail","notes":"Claimed by worker-pkpr","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:10:15.583767+05:30","updated_at":"2025-12-23T00:22:43.551345+05:30","closed_at":"2025-12-18T19:51:57.753816+05:30"}
{"id":"mcpmail-200","title":"Add tracing crate with structured logging","description":"Add tracing and tracing-subscriber for structured logging with JSON output for production","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T05:36:50.243038+05:30","updated_at":"2025-12-23T00:22:43.608826+05:30","closed_at":"2025-12-09T05:39:15.908829+05:30","labels":["logging"],"dependencies":[{"issue_id":"mcpmail-200","depends_on_id":"mcpmail-67","type":"parent-child","created_at":"2025-12-09T05:36:50.243464+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-201","title":"Create MCP tool router with all tools","description":"Implement tool_router with #[tool] macros for all 28+ API endpoints","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T04:45:23.082586+05:30","updated_at":"2025-12-23T00:22:43.609071+05:30","closed_at":"2025-12-09T05:29:25.344917+05:30","labels":["core","mcp"]}
{"id":"mcpmail-202","title":"Switch to rmcp SDK (official)","description":"Replace mcp-protocol-sdk with rmcp (official SDK) for better macro support and Claude Desktop compatibility","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T04:45:22.862204+05:30","updated_at":"2025-12-23T00:22:43.609278+05:30","closed_at":"2025-12-09T05:29:25.498517+05:30","labels":["mcp","refactor"]}
{"id":"mcpmail-203","title":"Threads: get_thread","description":"Get all messages in a thread by thread_id","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:18:34.890113+05:30","updated_at":"2025-12-23T00:22:43.609496+05:30","closed_at":"2025-12-09T03:59:26.383747+05:30","labels":["mcp-tool","threads"],"dependencies":[{"issue_id":"mcpmail-203","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:34.890853+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-204","title":"Core: get_agent_profile","description":"Get agent profile including inception, policy, stats","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:18:34.231424+05:30","updated_at":"2025-12-23T00:22:43.609751+05:30","closed_at":"2025-12-09T04:07:05.398847+05:30","labels":["core","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-204","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:34.232271+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-205","title":"Core: get_project_info","description":"Get project details including slug, human_key, stats","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:18:23.177957+05:30","updated_at":"2025-12-23T00:22:43.610002+05:30","closed_at":"2025-12-09T04:07:05.343611+05:30","labels":["core","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-205","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:23.179368+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-206","title":"Core: list_file_reservations","description":"List active and historical file reservations for project","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:18:22.940704+05:30","updated_at":"2025-12-23T00:22:43.610263+05:30","closed_at":"2025-12-09T03:59:26.335654+05:30","labels":["core","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-206","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:22.941592+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-207","title":"Search: search_messages","description":"FTS5 full-text search across message bodies and subjects","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:17:58.182129+05:30","updated_at":"2025-12-23T00:22:43.610517+05:30","closed_at":"2025-12-09T04:04:05.903009+05:30","labels":["mcp-tool","search"],"dependencies":[{"issue_id":"mcpmail-207","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:58.182506+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-208","title":"File Reservations: renew_file_reservation","description":"Extend TTL on active reservation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:17:44.871554+05:30","updated_at":"2025-12-23T00:22:43.6108+05:30","closed_at":"2025-12-09T04:07:05.291599+05:30","labels":["file-reservations","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-208","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:44.871892+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-209","title":"File Reservations: force_release_reservation","description":"Force release stale reservation (admin/overseer)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:17:44.653262+05:30","updated_at":"2025-12-23T00:22:43.611072+05:30","closed_at":"2025-12-09T04:07:05.242359+05:30","labels":["file-reservations","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-209","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:44.653631+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-21","title":"EPIC: PWA \u0026 Mobile Optimization","description":"## Overview\nMake the Leptos web UI a production-ready PWA with mobile-first design.\n\n## Current State\n- Basic responsive layout\n- Dark mode toggle\n- No offline support\n- No PWA manifest\n\n## Target State\n1. **PWA Fundamentals**\n   - Web app manifest for installability\n   - Service worker for offline caching\n   - App shell architecture\n\n2. **Mobile Responsiveness**\n   - Touch-friendly targets (44px minimum)\n   - Bottom navigation on mobile\n   - Swipe gestures for message actions\n   - Pull-to-refresh\n\n3. **Performance**\n   - Core Web Vitals compliance\n   - WASM lazy loading\n   - Image optimization\n   - Skeleton loading states\n\n4. **Accessibility**\n   - WCAG 2.2 Level AA\n   - Screen reader support\n   - Keyboard navigation\n   - Focus management\n\n## Acceptance Criteria\n- [ ] Lighthouse PWA score ≥ 90\n- [ ] LCP ≤ 2.5s on 3G\n- [ ] Installable on iOS/Android\n- [ ] Works offline (cached shell + data)\n- [ ] Touch targets ≥ 44px","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T06:10:26.245067+05:30","updated_at":"2025-12-23T00:22:43.551676+05:30","closed_at":"2025-12-22T05:32:58.414176+05:30"}
{"id":"mcpmail-210","title":"File Reservations: release_file_reservation","description":"Release an active file reservation before expiry","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:17:44.433066+05:30","updated_at":"2025-12-23T00:22:43.611306+05:30","closed_at":"2025-12-09T03:59:26.274494+05:30","labels":["file-reservations","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-210","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:17:44.433482+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-211","title":"Add Prometheus metrics endpoint","description":"Add metrics-exporter-prometheus for /metrics endpoint","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T05:36:50.433444+05:30","updated_at":"2025-12-23T00:22:43.611564+05:30","closed_at":"2025-12-09T05:39:16.070681+05:30","labels":["metrics"],"dependencies":[{"issue_id":"mcpmail-211","depends_on_id":"mcpmail-67","type":"parent-child","created_at":"2025-12-09T05:36:50.433834+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-212","title":"Identity: create_agent_identity tool","description":"Generate unique agent names with collision detection","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:13:48.189193+05:30","updated_at":"2025-12-23T00:22:43.6118+05:30","closed_at":"2025-12-09T04:02:25.201186+05:30","labels":["identity","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-212","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:48.190396+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-213","title":"Identity: whois tool","description":"Implement whois MCP tool - lookup agent details by name","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:13:41.666756+05:30","updated_at":"2025-12-23T00:22:43.612036+05:30","closed_at":"2025-12-09T03:59:26.145732+05:30","labels":["identity","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-213","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:41.667892+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-214","title":"Implement FileReservation model and BMC","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T01:53:56.189914+05:30","updated_at":"2025-12-23T00:22:43.612284+05:30","closed_at":"2025-12-09T01:57:25.478254+05:30","dependencies":[{"issue_id":"mcpmail-214","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T01:53:56.190374+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-215","title":"Configure adapter-static for Rust embedding","description":"Build static assets that can be served from Rust binary","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T01:40:41.528046+05:30","updated_at":"2025-12-23T00:22:43.612513+05:30","closed_at":"2025-12-09T02:25:41.585879+05:30","dependencies":[{"issue_id":"mcpmail-215","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.528448+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-216","title":"Initialize SvelteKit project in crates/services/web-ui","description":"Run bun create svelte, configure project structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T01:40:41.297291+05:30","updated_at":"2025-12-23T00:22:43.612748+05:30","closed_at":"2025-12-09T02:25:41.430272+05:30","dependencies":[{"issue_id":"mcpmail-216","depends_on_id":"mcpmail-217","type":"parent-child","created_at":"2025-12-09T01:40:41.297684+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-217","title":"Phase 2: SvelteKit Frontend","description":"Initialize SvelteKit with TailwindCSS, create UI for projects, agents, inbox, messages","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-09T01:40:02.685101+05:30","updated_at":"2025-12-23T00:22:43.612969+05:30","closed_at":"2025-12-09T02:40:31.761456+05:30"}
{"id":"mcpmail-218","title":"Phase 1.5: API Layer (Axum REST)","description":"Build Axum web server with REST API endpoints mirroring BMC logic. 8/12 endpoints done.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-09T01:40:02.606531+05:30","updated_at":"2025-12-23T00:22:43.613272+05:30","closed_at":"2025-12-09T01:40:24.365245+05:30"}
{"id":"mcpmail-219","title":"Create multi-stage Dockerfile","description":"Optimized Dockerfile with cargo-chef, musl, distroless","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T05:36:50.623866+05:30","updated_at":"2025-12-23T00:22:43.61349+05:30","closed_at":"2025-12-09T05:39:16.235667+05:30","labels":["docker"],"dependencies":[{"issue_id":"mcpmail-219","depends_on_id":"mcpmail-67","type":"parent-child","created_at":"2025-12-09T05:36:50.624236+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-22","title":"Create Button component with CVA variants and accessibility","description":"## Summary\nCreate a new Button component using tailwind_fuse for CVA-style variants with proper accessibility.\n\n## Implementation Details\n\n### Create components/button.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::*;\n\n#[derive(TwClass)]\n#[tw(class = \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\")]\npub struct ButtonClass {\n    pub variant: ButtonVariant,\n    pub size: ButtonSize,\n}\n\n#[derive(TwVariant, Clone, Copy, Default)]\npub enum ButtonVariant {\n    #[tw(default, class = \"bg-primary text-primary-foreground hover:bg-primary/90\")]\n    Default,\n    #[tw(class = \"bg-destructive text-destructive-foreground hover:bg-destructive/90\")]\n    Destructive,\n    #[tw(class = \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\")]\n    Outline,\n    #[tw(class = \"bg-secondary text-secondary-foreground hover:bg-secondary/80\")]\n    Secondary,\n    #[tw(class = \"hover:bg-accent hover:text-accent-foreground\")]\n    Ghost,\n    #[tw(class = \"text-primary underline-offset-4 hover:underline\")]\n    Link,\n}\n\n#[derive(TwVariant, Clone, Copy, Default)]\npub enum ButtonSize {\n    #[tw(default, class = \"h-10 px-4 py-2\")]\n    Default,\n    #[tw(class = \"h-9 rounded-md px-3\")]\n    Sm,\n    #[tw(class = \"h-11 rounded-md px-8\")]\n    Lg,\n    #[tw(class = \"h-10 w-10\")]\n    Icon,\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/button.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Button component created with 6 variants (default, destructive, outline, secondary, ghost, link)\n- [ ] Button component has 4 sizes (default, sm, lg, icon)\n- [ ] Uses tailwind_fuse for class merging\n- [ ] Focus ring visible on Tab navigation\n- [ ] Disabled state has opacity-50 and pointer-events-none\n- [ ] All sizes meet 44px minimum touch target\n- [ ] Component exported from mod.rs","notes":"Claimed by worker-xxnq","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:15.129248+05:30","updated_at":"2025-12-23T00:22:43.551982+05:30","closed_at":"2025-12-18T23:49:09.482984+05:30","dependencies":[{"issue_id":"mcpmail-22","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:37.854284+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-220","title":"Add health and readiness probes","description":"Add /health and /ready endpoints for Kubernetes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T05:36:50.816254+05:30","updated_at":"2025-12-23T00:22:43.613731+05:30","closed_at":"2025-12-09T05:39:16.3973+05:30","labels":["health"],"dependencies":[{"issue_id":"mcpmail-220","depends_on_id":"mcpmail-67","type":"parent-child","created_at":"2025-12-09T05:36:50.816605+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-221","title":"REST API workflow test (init-new.md)","description":"Test the complete REST API workflow using init-new.md. Verify: register_agent, send_message, file_reservation_paths, list_inbox, release_file_reservation all work via HTTP REST API.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T20:10:36.469044+05:30","updated_at":"2025-12-23T00:22:43.613963+05:30","closed_at":"2025-12-22T20:11:19.998447+05:30"}
{"id":"mcpmail-222","title":"PORT-2.1: Implement LRU repository cache to prevent file descriptor exhaustion","description":"## Problem\nOpening git repositories leaks file descriptors. Long-running servers exhaust FD limits.\n\n## Implementation\nCreate lib-core/src/store/repo_cache.rs:\n- RepoCache struct with LruCache\u003cPathBuf, Arc\u003cMutex\u003cRepository\u003e\u003e\u003e\n- new(capacity) - default 8 repos (~400 FDs total)\n- get(path) - open or return cached, update LRU order\n- peek(path) - non-blocking check if cached\n- get_if_cached(path) - return if cached, don't open\n- clear() - for testing/shutdown\n\n## Dependencies\n- Add lru crate to lib-core\n\n## Files\n- crates/libs/lib-core/src/store/repo_cache.rs (NEW)\n- crates/libs/lib-core/src/store/mod.rs\n- crates/libs/lib-core/src/store/git_archive.rs (use RepoCache)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/storage.py\n- Commit aee1e54: fix(storage): prevent file handle leaks by caching Repo objects\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: RepoLRUCache, LRU)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 2.1)\n\n## NIST Control: SC-5 (DoS Protection)\n\n## Acceptance Criteria\n- [ ] LRU cache with configurable capacity (default 8)\n- [ ] Thread-safe via Arc\u003cMutex\u003c_\u003e\u003e\n- [ ] peek() is non-blocking (try_lock)\n- [ ] Evicted repos properly dropped (FDs released)\n- [ ] Benchmark: no FD growth under 1000 operations\n- [ ] Integration test with \u003e8 concurrent projects\n\n## Complexity: 8/10","notes":"SCAFFOLDING EXISTS (2025-12-19): repo_cache.rs created with RepoCache struct using LruCache\u003cPathBuf, Arc\u003cMutex\u003cRepository\u003e\u003e\u003e, new(capacity), get(path), peek(path), get_if_cached(path), clear() - all with tests. REMAINING: Integration into GitStore not done. Need to modify git_store.rs to use RepoCache instead of opening repos directly. Also needs stress test for FD exhaustion.","status":"closed","issue_type":"task","created_at":"2025-12-18T00:25:09.430212+05:30","updated_at":"2025-12-23T00:22:43.614221+05:30","closed_at":"2025-12-19T06:52:54.707181+05:30"}
{"id":"mcpmail-223","title":"Implement force_release/renew file reservation tools","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T07:10:20.065996+05:30","updated_at":"2025-12-23T00:22:43.614466+05:30","closed_at":"2025-12-09T07:24:21.393738+05:30","dependencies":[{"issue_id":"mcpmail-223","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:20.068419+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-224","title":"Create integration test suite","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T07:10:20.332464+05:30","updated_at":"2025-12-23T00:22:43.614697+05:30","closed_at":"2025-12-09T07:32:37.037314+05:30","dependencies":[{"issue_id":"mcpmail-224","depends_on_id":"mcpmail-199","type":"parent-child","created_at":"2025-12-09T07:10:20.334606+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-225","title":"SVELTE-021: Add loading states with skeleton screens","description":"Perceived performance optimization using skeleton screens and optimistic UI.\n\n**Acceptance Criteria:**\n- [ ] Skeleton components matching final content layout\n- [ ] Shimmer animation on skeletons\n- [ ] No Cumulative Layout Shift (CLS ≤ 0.1)\n- [ ] Optimistic UI for mark-as-read actions\n- [ ] Progress indicators for long operations\n- [ ] Toast notifications for async feedback\n- [ ] SuspenseLoader pattern from frontend-dev-guidelines\n\n**Design Spec (from skills):**\n- Skeleton fade duration: 200ms\n- Loading spinner: 800ms rotation\n- Shimmer: linear-gradient animation 2s infinite\n- No early returns - use Suspense boundaries\n\n**Reference Files:**\n- .tmp/skills/mobile-frontend-design/resources/loading-states.md\n- .tmp/skills/frontend-dev-guidelines/resources/loading-and-error-states.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:54:31.774721+05:30","updated_at":"2025-12-23T03:59:31.297957+05:30","closed_at":"2025-12-23T03:59:31.297957+05:30","dependencies":[{"issue_id":"mcpmail-225","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:55:15.336531+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-225","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:55:58.193518+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-226","title":"SVELTE-020: Implement dark mode with theme store","description":"System-aware dark mode with manual toggle and persistence.\n\n**Acceptance Criteria:**\n- [ ] mode-watcher package for system preference detection\n- [ ] ThemeStore.ts with system/light/dark modes\n- [ ] Persist preference to localStorage\n- [ ] No Flash of Incorrect Theme (FOIT prevention)\n- [ ] CSS variables for all colors (dark/light variants)\n- [ ] Material Design elevation for dark mode surfaces\n- [ ] Image adaptation for dark mode (reduce brightness)\n- [ ] Toggle in header or settings\n\n**Design Spec (from mobile-frontend-design):**\nThree-tier color architecture:\n1. Base: --color-surface-dark: #1e1e2e\n2. Elevated: --color-surface-1: #282838\n3. High: --color-surface-2: #323244\n\n**Reference Files:**\n- .tmp/skills/mobile-frontend-design/resources/dark-mode-patterns.md\n\n**Dependencies:**\n- mode-watcher (already in plan)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:54:26.444665+05:30","updated_at":"2025-12-23T03:35:40.857055+05:30","closed_at":"2025-12-23T03:35:40.857055+05:30","dependencies":[{"issue_id":"mcpmail-226","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:55:10.173934+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-226","depends_on_id":"mcpmail-93","type":"blocks","created_at":"2025-12-22T05:55:53.074774+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-227","title":"PORT-2.2: Implement stale lock cleanup with PID liveness detection","description":"## Problem\nIf process crashes while holding archive lock, stale locks block all future operations.\n\n## Implementation\nCreate lib-core/src/store/archive_lock.rs:\n- LockOwner struct: pid, timestamp, agent, hostname\n- is_stale() - check age (\u003e1 hour) or dead process\n- is_process_alive() - Unix: kill(pid, 0), Windows: OpenProcess\n- ArchiveLock::acquire() with stale cleanup\n- LockGuard RAII for automatic release on drop\n\n## Files\n- crates/libs/lib-core/src/store/archive_lock.rs (NEW)\n- crates/libs/lib-core/src/store/git_archive.rs (use ArchiveLock)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/storage.py\n- Commit 699ed03: fix(storage): improve LRU repo cache robustness\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: stale, lock, PID)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 2.2)\n\n## NIST Control: AU-9 (Audit Protection)\n\n## Acceptance Criteria\n- [ ] Stale locks from dead processes auto-cleaned\n- [ ] Age-based cleanup for abandoned locks (\u003e1 hour)\n- [ ] Cross-platform: Unix (libc::kill) + Windows (OpenProcess)\n- [ ] RAII guard ensures release on drop\n- [ ] No data corruption on forced cleanup\n- [ ] Tests simulate crash recovery\n\n## Complexity: 7/10","notes":"SCAFFOLDING EXISTS (2025-12-19): archive_lock.rs created with ArchiveLock, LockOwner struct (pid, timestamp, agent, hostname), LockGuard RAII, is_stale(), is_process_alive() with cross-platform support - all with tests. REMAINING: Integration into git_archive.rs not done. Need to wrap archive operations with ArchiveLock::acquire() and use LockGuard for automatic release.","status":"closed","issue_type":"task","created_at":"2025-12-18T00:25:23.07202+05:30","updated_at":"2025-12-23T00:22:43.615473+05:30","closed_at":"2025-12-19T15:24:05.910657+05:30"}
{"id":"mcpmail-228","title":"SVELTE-018: Implement touch-optimized interactions","description":"Mobile-first touch interactions following WCAG 2.2 SC 2.5.8 (44x44px targets).\n\n**Acceptance Criteria:**\n- [ ] All interactive elements ≥44×44px touch targets\n- [ ] Bottom navigation in 'easy reach zone' (bottom third)\n- [ ] FAB (Floating Action Button) for compose/quick actions\n- [ ] Swipe-to-archive on message list items\n- [ ] Pull-to-refresh on unified inbox\n- [ ] Long-press for context menu (message actions)\n- [ ] touch-action: manipulation on all buttons\n- [ ] No hover-dependent interactions\n\n**Design Spec (from mobile-frontend-design):**\n- Thumb zones: Primary actions in bottom third\n- Bottom nav: 56dp height (Material Design 3)\n- safe-area-inset-* for notched devices\n- active:scale(0.96) for touch feedback\n\n**Reference Files:**\n- .tmp/skills/mobile-frontend-design/resources/touch-interactions.md (comprehensive guide)\n- .tmp/skills/mobile-frontend-design/resources/microinteractions.md\n\n**MCP:** mcp__shadcn__view_items_in_registries for touch-friendly components","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:54:15.72732+05:30","updated_at":"2025-12-23T16:51:07.300324+05:30","closed_at":"2025-12-23T16:51:07.300324+05:30","dependencies":[{"issue_id":"mcpmail-228","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:54:59.862903+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-228","depends_on_id":"mcpmail-93","type":"blocks","created_at":"2025-12-22T05:55:42.816317+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-229","title":"Phase 7: Test Coverage Expansion","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-09T16:19:46.759693+05:30","updated_at":"2025-12-23T00:22:43.61603+05:30","closed_at":"2025-12-09T16:47:20.673849+05:30"}
{"id":"mcpmail-23","title":"GAP: Export Scrubbing Presets (standard/strict/none)","description":"## Problem\nPython export supports data redaction presets. Rust export has no scrubbing.\n\n## Python Presets\n- `none`: Lossless export\n- `standard`: Clear ack/read state, remove file reservations, scrub secrets (tokens, keys)\n- `strict`: All standard + replace message bodies + remove attachments\n\n## Implementation\n- Add scrub_preset field to ExportBmc\n- Implement ScrubPreset enum\n- Apply redactions before export based on preset","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T17:59:47.408796+05:30","updated_at":"2025-12-23T00:22:43.552314+05:30","closed_at":"2025-12-21T02:57:55.696514+05:30"}
{"id":"mcpmail-230","title":"SVELTE-016: Enable precompress and verify asset caching","description":"Production optimization: enable SvelteKit precompression and verify immutable asset caching.\n\n**Acceptance Criteria:**\n- [ ] svelte.config.js: precompress: true\n- [ ] Verify static_files.rs handles /_app/immutable/ with max-age=31536000\n- [ ] Verify .gz files generated in build/\n- [ ] Bundle size \u003c 200KB gzip\n\n**Reference Files:**\n- crates/services/web-ui/svelte.config.js\n- crates/libs/lib-server/src/static_files.rs\n\n**Blocks:** Build integration (must be done before final testing)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:51:24.304353+05:30","updated_at":"2025-12-23T21:08:17.19635+05:30","closed_at":"2025-12-23T21:08:17.19635+05:30","dependencies":[{"issue_id":"mcpmail-230","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:51:56.290888+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-230","depends_on_id":"mcpmail-36","type":"blocks","created_at":"2025-12-22T05:52:29.092528+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-231","title":"PORT-2.3: Audit and fix potential file handle leaks in store modules","description":"## Problem\nFile handle leaks in image processing and git operations can exhaust FD limits.\n\n## Implementation\nAudit and fix:\n- attachments.rs - image processing with image crate\n- git_archive.rs - repository file operations\n- precommit_guard.rs - script file generation\n\nPatterns to apply:\n- Explicit scope for File/BufReader lifetime\n- Drop guards for critical resources\n- with_capacity() for known sizes\n\n## Files\n- crates/libs/lib-core/src/store/attachments.rs\n- crates/libs/lib-core/src/store/git_archive.rs\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/storage.py\n- Commit a1e29e2: fix(stability): prevent file handle leaks in PIL and HTTP\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: file handle, leak, PIL)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 2.3)\n\n## Acceptance Criteria\n- [ ] Audit all file ops in lib-core/src/store/\n- [ ] Add explicit drops where FD lifetime matters\n- [ ] Stress test: 1000 attachments, verify FD count stable\n- [ ] Document ownership patterns in code comments\n- [ ] No clippy warnings about unused handles\n\n## Complexity: 4/10","status":"closed","issue_type":"task","created_at":"2025-12-18T00:25:36.575085+05:30","updated_at":"2025-12-23T00:22:43.616571+05:30","closed_at":"2025-12-19T06:31:03.831198+05:30"}
{"id":"mcpmail-232","title":"Add contact policy tests (open, auto, contacts_only, block_all)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T16:20:15.345797+05:30","updated_at":"2025-12-23T00:22:43.616764+05:30","closed_at":"2025-12-09T16:41:13.264084+05:30","dependencies":[{"issue_id":"mcpmail-232","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:15.346156+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-233","title":"SVELTE-013: Implement Command Palette (Cmd+K)","description":"Spotlight-style command palette using cmdk-sv. This is core to 'keyboard-first interaction' design principle.\n\n**Acceptance Criteria:**\n- [ ] Cmd+K opens centered modal with backdrop blur\n- [ ] Actions: Navigate (Projects, Inbox, Search), Theme toggle, Quick search\n- [ ] Magic UI Spotlight animation (shadow-2xl, scale-in)\n- [ ] Fuzzy search using fuse.js\n- [ ] Keyboard navigation (arrow keys, Enter to select, Esc to close)\n\n**Design Spec:**\n- Centered modal, shadow-2xl\n- Backdrop blur (backdrop-blur-sm)\n- animation: command-in 150ms ease-out\n\n**Reference Files:**\n- Python mail_unified_inbox.html (search bar with Cmd+K hint)\n- crates/services/web-ui-leptos/src/components/CommandPalette.rs (if exists)\n\n**Dependencies:** cmdk-sv, fuse.js\n\n**MCP:** mcp__shadcn__view_items_in_registries for @shadcn/command","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:51:08.301369+05:30","updated_at":"2025-12-23T19:26:35.395956+05:30","closed_at":"2025-12-23T19:26:35.395956+05:30","dependencies":[{"issue_id":"mcpmail-233","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:51:40.904313+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-233","depends_on_id":"mcpmail-319","type":"blocks","created_at":"2025-12-22T05:52:13.712482+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-234","title":"SVELTE-012: Add Playwright E2E and visual regression tests","description":"## Summary\nAdd comprehensive E2E tests for all routes.\n\n## Implementation\n**File**: `crates/services/web-ui/playwright.config.ts`\n```typescript\nimport { defineConfig, devices } from '@playwright/test';\n\nexport default defineConfig({\n    testDir: './tests',\n    fullyParallel: true,\n    reporter: 'html',\n    use: {\n        baseURL: 'http://localhost:5173',\n        trace: 'on-first-retry'\n    },\n    projects: [\n        { name: 'chromium', use: { ...devices['Desktop Chrome'] } },\n        { name: 'mobile', use: { ...devices['iPhone 13'] } },\n    ],\n    webServer: {\n        command: 'bun run dev',\n        url: 'http://localhost:5173',\n        reuseExistingServer: !process.env.CI\n    }\n});\n```\n\n**File**: `tests/mail.spec.ts`\n```typescript\ntest('unified inbox loads', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await expect(page.getByRole('heading')).toContainText('Inbox');\n});\n\ntest('keyboard navigation j/k', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await page.keyboard.press('j');\n    // Assert first message selected\n});\n```\n\n## Test Coverage\n- [ ] Dashboard\n- [ ] Projects list \u0026 detail\n- [ ] Unified inbox (split view, filters, keyboard)\n- [ ] Thread view\n- [ ] Search\n- [ ] Mobile responsive views\n- [ ] Visual regression snapshots\n\n## Reference Files\n- Leptos: crates/services/web-ui-leptos/scripts/visual-regression.ts\n\n## Acceptance Criteria\n- [ ] All routes have E2E tests\n- [ ] Visual regression baselines captured\n- [ ] Mobile tests pass\n- [ ] CI integration works\n\n## Quality Gates\n- 100% route coverage\n- \u003c5s test suite runtime","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:39:33.513212+05:30","updated_at":"2025-12-23T03:23:48.839334+05:30","closed_at":"2025-12-23T03:23:48.839334+05:30","dependencies":[{"issue_id":"mcpmail-234","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:40:57.783024+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-234","depends_on_id":"mcpmail-51","type":"blocks","created_at":"2025-12-22T05:41:02.917089+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-234","depends_on_id":"mcpmail-89","type":"blocks","created_at":"2025-12-22T05:41:08.052145+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-234","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:26.687495+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-235","title":"Add force_release_reservation tests with staleness detection","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T16:20:27.133463+05:30","updated_at":"2025-12-23T00:22:43.617546+05:30","closed_at":"2025-12-09T16:39:34.497142+05:30","dependencies":[{"issue_id":"mcpmail-235","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:27.134301+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-236","title":"Add thread summarization tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T16:20:28.770925+05:30","updated_at":"2025-12-23T00:22:43.617771+05:30","closed_at":"2025-12-09T16:40:53.706348+05:30","dependencies":[{"issue_id":"mcpmail-236","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:28.772652+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-237","title":"T2: Response structs for PendingReview API","description":"Add Serialize structs: PendingReviewsResponse, PendingReview, SenderInfo, ProjectInfo, ThreadInfo, RecipientStatus. Strong types, no primitive obsession. Complexity: 3/10. File: crates/libs/lib-server/src/tools.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:55.619368+05:30","updated_at":"2025-12-23T00:22:43.618013+05:30","closed_at":"2025-12-18T18:35:40.656636+05:30"}
{"id":"mcpmail-238","title":"Add file reservation conflict tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T16:20:40.829989+05:30","updated_at":"2025-12-23T00:22:43.618255+05:30","closed_at":"2025-12-09T16:39:34.45161+05:30","dependencies":[{"issue_id":"mcpmail-238","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:40.83085+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-239","title":"Add mark_message_read and acknowledge_message tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T16:20:45.048859+05:30","updated_at":"2025-12-23T00:22:43.618506+05:30","closed_at":"2025-12-09T16:37:38.166483+05:30","dependencies":[{"issue_id":"mcpmail-239","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:45.051015+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-24","title":"Refactor ProjectCard to use new Card and Badge components","description":"## Summary\nRefactor ProjectCard to use the new Card compound components and Badge component instead of inline classes.\n\n## Implementation Details\n\n### Refactor project_card.rs\n```rust\nuse crate::components::{Card, CardHeader, CardTitle, CardContent, Badge, BadgeVariant};\n\n#[component]\npub fn ProjectCard(\n    slug: String,\n    human_key: String,\n    created_at: String,\n    status: String,\n    agent_count: i32,\n    message_count: i32,\n) -\u003e impl IntoView {\n    let badge_variant = match status.as_str() {\n        \"Active\" =\u003e BadgeVariant::Success,\n        \"Inactive\" =\u003e BadgeVariant::Secondary,\n        _ =\u003e BadgeVariant::Default,\n    };\n\n    view! {\n        \u003cCard class=\"hover:shadow-md transition-shadow\"\u003e\n            \u003cCardHeader class=\"pb-2\"\u003e\n                \u003cdiv class=\"flex items-center justify-between\"\u003e\n                    \u003cCardTitle class=\"text-lg\"\u003e{human_key}\u003c/CardTitle\u003e\n                    \u003cBadge variant=badge_variant\u003e{status}\u003c/Badge\u003e\n                \u003c/div\u003e\n            \u003c/CardHeader\u003e\n            \u003cCardContent\u003e\n                \u003cdiv class=\"flex items-center gap-4 text-sm text-muted-foreground\"\u003e\n                    \u003cspan\u003e{agent_count} \" agents\"\u003c/span\u003e\n                    \u003cspan\u003e{message_count} \" messages\"\u003c/span\u003e\n                \u003c/div\u003e\n            \u003c/CardContent\u003e\n        \u003c/Card\u003e\n    }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/project_card.rs\n\n## Acceptance Criteria\n- [ ] Uses Card, CardHeader, CardTitle, CardContent components\n- [ ] Uses Badge component for status\n- [ ] Badge variant changes based on status (Active=Success, Inactive=Secondary)\n- [ ] Uses text-muted-foreground semantic color\n- [ ] Hover effect preserved\n- [ ] Visual output unchanged","notes":"Claimed by worker-iwvb","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:31.80915+05:30","updated_at":"2025-12-23T00:22:43.552589+05:30","closed_at":"2025-12-19T01:04:37.3303+05:30","dependencies":[{"issue_id":"mcpmail-24","depends_on_id":"mcpmail-43","type":"blocks","created_at":"2025-12-18T23:13:46.880215+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-24","depends_on_id":"mcpmail-120","type":"blocks","created_at":"2025-12-18T23:13:46.928231+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-240","title":"MCP: Add pre-built convenience macros (macro_start_session, macro_prepare_thread, etc.)","description":"Add Python-compatible convenience macros as built-in MCP tools: macro_start_session (register + reserve), macro_prepare_thread (join thread), macro_file_reservation_cycle (reserve + release pattern), macro_contact_handshake (two-way contact). Currently Rust has generic register_macro/invoke_macro but no pre-built macros. See ${PYTHON_SRC}/src/mcp_agent_mail/app.py lines 5033-5350.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T22:31:56.329346+05:30","updated_at":"2025-12-23T00:22:43.618738+05:30","closed_at":"2025-12-22T02:56:33.741762+05:30"}
{"id":"mcpmail-241","title":"Add tests and AGENTS.md documentation for robot-* flags","description":"Add tests for robot-* flags and update AGENTS.md.\n\n## Unit Tests\n```rust\n#[test]\nfn test_robot_help_json_valid() {\n    let output = handle_robot_help();\n    let parsed: RobotHelpOutput = serde_json::from_str(\u0026output).unwrap();\n    assert_eq\\!(parsed.schema_version, \"1.0.0\");\n    assert\\!(\\!parsed.commands.is_empty());\n}\n\n#[test]\nfn test_robot_examples_self_documenting() {\n    // The meta case: asking for examples of robot-examples\n    let output = handle_robot_examples(Some(\"robot-examples\"));\n    let parsed: RobotExamplesOutput = serde_json::from_str(\u0026output).unwrap();\n    // Should include at least one example for robot-examples itself\n    assert\\!(parsed.examples.iter().any(|ex| ex.command == \"robot-examples\"));\n}\n\n#[test]\nfn test_robot_status_exit_codes() {\n    let (output, exit_code) = handle_robot_status();\n    let parsed: RobotStatusOutput = serde_json::from_str(\u0026output).unwrap();\n    assert_eq\\!(parsed.exit_code, exit_code);\n}\n```\n\n## Integration Tests\n```bash\n# Should output valid JSON\nmcp-agent-mail --robot-help | jq .\n\n# Should include robot-* in its own examples\nmcp-agent-mail --robot-examples --command robot-examples | jq '.examples | length'\n```\n\n## AGENTS.md Update\nAdd to Layer 1 tool reference:\n```markdown\n| **AI discovery** | mcp-agent-mail | `--robot-help`, `--robot-examples`, `--robot-status` |\n```\n\n## Location\n- crates/services/mcp-agent-mail/src/robot_help.rs (tests)\n- AGENTS.md (documentation)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:37:01.52465+05:30","updated_at":"2025-12-23T00:22:43.619042+05:30","closed_at":"2025-12-22T03:29:39.38316+05:30","dependencies":[{"issue_id":"mcpmail-241","depends_on_id":"mcpmail-375","type":"blocks","created_at":"2025-12-21T08:43:43.520501+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-241","depends_on_id":"mcpmail-28","type":"blocks","created_at":"2025-12-21T08:43:43.573269+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-242","title":"Enable precompression in svelte.config.js","description":"Set precompress: true in adapter-static config to generate gzip/brotli compressed assets for better load times.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T02:45:31.830097+05:30","updated_at":"2025-12-23T00:22:43.619319+05:30","closed_at":"2025-12-15T18:44:27.646908+05:30","dependencies":[{"issue_id":"mcpmail-242","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:31.830657+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-243","title":"Add ARIA labels to interactive elements","description":"Add aria-label and aria-expanded to sidebar toggle, aria-current to active nav items. Improve screen reader experience.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T02:45:32.255109+05:30","updated_at":"2025-12-23T00:22:43.619635+05:30","closed_at":"2025-12-15T18:44:54.584078+05:30","dependencies":[{"issue_id":"mcpmail-243","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:32.255641+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-244","title":"Add global --robot-help flag to Cli struct (clap)","description":"Add the --robot-help global flag to the main Cli struct using clap.\n\n## Implementation\n```rust\n#[derive(Parser)]\n#[command(name = \"mcp-agent-mail\")]\nstruct Cli {\n    #[command(subcommand)]\n    command: Option\u003cCommands\u003e,  // Now optional!\n\n    /// AI-optimized capability discovery (JSON output)\n    #[arg(long, global = true)]\n    robot_help: bool,\n\n    /// Output format for robot flags\n    #[arg(long, default_value = \"json\", global = true)]\n    format: String,\n\n    #[arg(long, default_value = \"plain\", global = true)]\n    log_format: String,\n}\n```\n\n## Behavior\n- When `--robot-help` is set, skip normal command dispatch\n- Output JSON to stdout, exit 0\n- `--format yaml` for YAML alternative\n\n## Edge Cases\n- `mcp-agent-mail --robot-help serve http` - robot-help takes precedence\n- `mcp-agent-mail serve http --robot-help` - same (global flag)\n\n## Location\ncrates/services/mcp-agent-mail/src/main.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:36:26.03029+05:30","updated_at":"2025-12-23T00:22:43.62117+05:30","closed_at":"2025-12-21T21:50:24.945667+05:30","dependencies":[{"issue_id":"mcpmail-244","depends_on_id":"mcpmail-246","type":"blocks","created_at":"2025-12-21T08:43:43.285345+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-245","title":"Create CommandRegistry with static example data","description":"Create ExampleRegistry covering ALL flags and subcommands.\n\n## Requirement: 100% Coverage\nEvery flag and subcommand MUST have example documentation. Missing = bug.\n\n## Registry Structure\n```rust\nuse std::collections::HashMap;\nuse once_cell::sync::Lazy;\n\n#[derive(Clone, Serialize)]\npub struct Example {\n    pub invocation: \u0026'static str,\n    pub description: \u0026'static str,\n}\n\n#[derive(Clone, Serialize)]\npub struct ExampleEntry {\n    pub description: \u0026'static str,\n    pub target_type: \u0026'static str,  // \"flag\" | \"subcommand\"\n    pub param_type: Option\u003c\u0026'static str\u003e,  // \"u16\", \"String\", etc.\n    pub default: Option\u003c\u0026'static str\u003e,\n    pub examples: Vec\u003cExample\u003e,\n}\n\npub static EXAMPLE_REGISTRY: Lazy\u003cHashMap\u003c\u0026'static str, ExampleEntry\u003e\u003e = Lazy::new(|| {\n    let mut m = HashMap::new();\n    \n    // ===== GLOBAL FLAGS =====\n    m.insert(\"--robot-help\", ExampleEntry {\n        description: \"AI-optimized capability discovery\",\n        target_type: \"flag\",\n        param_type: None,\n        default: None,\n        examples: vec\\![\n            Example { invocation: \"am --robot-help\", description: \"Show all capabilities as JSON\" },\n            Example { invocation: \"am --robot-help --format yaml\", description: \"YAML output\" },\n        ],\n    });\n    \n    m.insert(\"--robot-examples\", ExampleEntry {\n        description: \"Show usage examples for flags/subcommands\",\n        target_type: \"flag\",\n        param_type: None,\n        default: None,\n        examples: vec\\![\n            Example { invocation: \"am --robot-examples --port\", description: \"Examples for --port\" },\n            Example { invocation: \"am --robot-examples serve http\", description: \"Examples for serve http\" },\n            Example { invocation: \"am --robot-examples --robot-examples\", description: \"Self-documenting\" },\n        ],\n    });\n    \n    m.insert(\"--format\", ExampleEntry {\n        description: \"Output format for robot flags\",\n        target_type: \"flag\",\n        param_type: Some(\"String\"),\n        default: Some(\"json\"),\n        examples: vec\\![\n            Example { invocation: \"am --robot-help --format json\", description: \"JSON output (default)\" },\n            Example { invocation: \"am --robot-help --format yaml\", description: \"YAML output\" },\n        ],\n    });\n    \n    m.insert(\"--port\", ExampleEntry {\n        description: \"Server port number\",\n        target_type: \"flag\",\n        param_type: Some(\"u16\"),\n        default: Some(\"8765\"),\n        examples: vec\\![\n            Example { invocation: \"am serve http --port 9000\", description: \"Custom port\" },\n            Example { invocation: \"am service status --port 9000\", description: \"Check custom port\" },\n        ],\n    });\n    \n    // ... ALL other flags ...\n    \n    // ===== SUBCOMMANDS =====\n    m.insert(\"serve\", ExampleEntry { ... });\n    m.insert(\"serve http\", ExampleEntry { ... });\n    m.insert(\"serve mcp\", ExampleEntry { ... });\n    m.insert(\"health\", ExampleEntry { ... });\n    m.insert(\"tools\", ExampleEntry { ... });\n    m.insert(\"schema\", ExampleEntry { ... });\n    m.insert(\"archive\", ExampleEntry { ... });\n    m.insert(\"archive save\", ExampleEntry { ... });\n    m.insert(\"archive list\", ExampleEntry { ... });\n    m.insert(\"archive restore\", ExampleEntry { ... });\n    // ... ALL subcommands ...\n    \n    m\n});\n```\n\n## Coverage Checklist (from main.rs analysis)\n### Global Flags\n- [ ] --robot-help\n- [ ] --robot-examples  \n- [ ] --robot-status\n- [ ] --format\n- [ ] --log-format\n\n### Subcommands\n- [ ] serve, serve http, serve mcp\n- [ ] health\n- [ ] config, config set-port, config show-port\n- [ ] schema\n- [ ] tools\n- [ ] install, install alias\n- [ ] service, service stop, service status, service restart\n- [ ] share, share keypair, share verify, share encrypt, share decrypt\n- [ ] archive, archive save, archive list, archive restore, archive clear-and-reset\n- [ ] version\n\n### Per-Subcommand Flags\n- [ ] serve http: --port, --with-ui, --no-ui\n- [ ] serve mcp: --transport, --port\n- [ ] health: --url\n- [ ] schema: --format, --output\n- [ ] archive list: --json\n- [ ] archive restore: --yes\n- [ ] etc.\n\n## Location\ncrates/services/mcp-agent-mail/src/robot_help.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:36:09.880081+05:30","updated_at":"2025-12-23T00:22:43.62159+05:30","closed_at":"2025-12-22T02:26:41.248239+05:30","dependencies":[{"issue_id":"mcpmail-245","depends_on_id":"mcpmail-246","type":"blocks","created_at":"2025-12-21T08:43:43.230977+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-246","title":"Define RobotHelp JSON schema with version field","description":"Create the JSON schema for --robot-help output.\n\n## Schema Requirements\n- schema_version: string (semver for forward compat)\n- tool: string (tool name)\n- version: string (tool version from Cargo.toml)\n- commands: array of CommandSchema\n- robot_flags: array of RobotFlagSchema (self-documenting)\n\n## Rust Types\n```rust\n#[derive(Serialize)]\nstruct RobotHelpOutput {\n    schema_version: String,  // \"1.0.0\"\n    tool: String,            // \"mcp-agent-mail\"\n    version: String,         // env!(\"CARGO_PKG_VERSION\")\n    commands: Vec\u003cCommandSchema\u003e,\n    robot_flags: Vec\u003cRobotFlagSchema\u003e,\n}\n\n#[derive(Serialize)]\nstruct CommandSchema {\n    name: String,\n    description: String,\n    parameters: Vec\u003cParameterSchema\u003e,\n    exit_codes: HashMap\u003cString, String\u003e,\n}\n```\n\n## Location\nCreate new module: crates/services/mcp-agent-mail/src/robot_help.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:35:55.380914+05:30","updated_at":"2025-12-23T00:22:43.621924+05:30","closed_at":"2025-12-21T18:00:18.335706+05:30"}
{"id":"mcpmail-247","title":"Fix focus indicators in app.css","description":"Add :focus-visible styles with primary color outline for keyboard navigation visibility. Replace default browser outline.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T02:45:32.473718+05:30","updated_at":"2025-12-23T00:22:43.622209+05:30","closed_at":"2025-12-15T18:44:54.546033+05:30","dependencies":[{"issue_id":"mcpmail-247","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:32.47423+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-248","title":"GAP: CSP Security Headers for lib-server","description":"## Problem\nXSS test corpus exists but actual Content-Security-Policy headers are NOT implemented in lib-server.\n\n## Python Reference\n```\nContent-Security-Policy: script-src 'self'; connect-src 'self'; style-src 'self' 'unsafe-inline'\nX-Frame-Options: DENY\nX-Content-Type-Options: nosniff\n```\n\n## Implementation\n- Add CSP headers via tower middleware layer\n- Add X-Frame-Options, X-Content-Type-Options\n- Test with integration tests\n\n## Files\n- crates/libs/lib-server/src/lib.rs - add security headers layer","notes":"Claimed by worker-euq7","status":"closed","issue_type":"task","created_at":"2025-12-18T17:59:30.241356+05:30","updated_at":"2025-12-23T00:22:43.622459+05:30","closed_at":"2025-12-19T00:10:22.307511+05:30"}
{"id":"mcpmail-249","title":"Add global error boundary (+error.svelte)","description":"Create src/routes/+error.svelte with user-friendly error page showing status code, message, and home link.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T02:45:32.686597+05:30","updated_at":"2025-12-23T00:22:43.622673+05:30","closed_at":"2025-12-15T18:44:27.608155+05:30","dependencies":[{"issue_id":"mcpmail-249","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:32.687094+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-25","title":"Add ARIA region roles and aria-labels to SplitViewLayout panels","description":"## Summary\nAdd proper ARIA landmark roles to SplitViewLayout for screen reader navigation.\n\n## Implementation Details\n\n### Update split_view.rs\n```rust\n// Message list panel\nview! {\n    \u003cdiv\n        class=\"w-full lg:w-[35%] overflow-y-auto\"\n        role=\"region\"\n        aria-label=\"Message list\"\n    \u003e\n        // ... list content\n    \u003c/div\u003e\n}\n\n// Detail panel\nview! {\n    \u003cdiv\n        class=\"hidden lg:block lg:w-[65%] overflow-y-auto\"\n        role=\"region\"\n        aria-label=\"Message detail\"\n    \u003e\n        // ... detail content\n    \u003c/div\u003e\n}\n\n// Add Separator between panels\nview! {\n    \u003cSeparator orientation=Orientation::Vertical class=\"hidden lg:block\" /\u003e\n}\n```\n\n### Add Home/End Key Navigation\n```rust\n// In keyboard handler\nKeyboardEvent::Home =\u003e select_first_item(),\nKeyboardEvent::End =\u003e select_last_item(),\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/split_view.rs\n\n## Acceptance Criteria\n- [ ] List panel has role=\"region\" aria-label=\"Message list\"\n- [ ] Detail panel has role=\"region\" aria-label=\"Message detail\"\n- [ ] Separator component used between panels\n- [ ] Home key selects first message\n- [ ] End key selects last message\n- [ ] Screen reader announces panel names","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:32.051455+05:30","updated_at":"2025-12-23T00:22:43.552951+05:30","closed_at":"2025-12-19T01:53:44.259527+05:30","dependencies":[{"issue_id":"mcpmail-25","depends_on_id":"mcpmail-260","type":"blocks","created_at":"2025-12-18T23:13:46.976567+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-250","title":"LEPTOS-011: Toast Notification System","description":"## Summary\nCreate toast notification component for success/error/info messages.\n\n## Implementation\nCreate: `components/toast.rs`\n\n```rust\n#[derive(TwVariant)]\npub enum ToastVariant {\n    #[tw(class = \"bg-emerald-500\")]\n    Success,\n    #[tw(class = \"bg-destructive\")]\n    Error,\n    #[tw(class = \"bg-amber-500\")]\n    Warning,\n    #[tw(class = \"bg-primary\")]\n    Info,\n}\n```\n\n## Acceptance Criteria\n- [ ] Toast component with variants (success, error, warning, info)\n- [ ] Auto-dismiss after 5s (configurable)\n- [ ] Stack multiple toasts (max 3 visible)\n- [ ] Swipe to dismiss on mobile\n- [ ] Close button on desktop\n- [ ] Position: bottom-right desktop, bottom-center mobile\n- [ ] role=\"alert\" for error, role=\"status\" for others\n- [ ] Reduced motion: instant show/hide\n\n## Quality Gates\n- \u003c= 50ms render time\n- Accessible: announced by screen readers\n- Persists across route changes\n\n## Reference Skills\n- shadcn-ui: Toast component anatomy\n- mobile-frontend-design: Swipe gestures\n- production-hardening-frontend: Reduced motion","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T22:05:53.791057+05:30","updated_at":"2025-12-23T00:22:43.622919+05:30","closed_at":"2025-12-20T04:09:33.905483+05:30","dependencies":[{"issue_id":"mcpmail-250","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:14.077841+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-250","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:14.136906+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-251","title":"P2: Setup visual regression testing with screenshot baselines","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:33:47.454781+05:30","updated_at":"2025-12-23T00:22:43.623205+05:30","closed_at":"2025-12-15T18:44:40.033134+05:30","dependencies":[{"issue_id":"mcpmail-251","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.360917+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-252","title":"LEPTOS-009: Keyboard Navigation Enhancement","description":"## Summary\nAdd comprehensive keyboard navigation per WCAG 2.1 SC 2.1.1.\n\n## Implementation\nUpdate multiple components with keyboard handlers.\n\n## Acceptance Criteria\n- [ ] **SplitView**: j/k navigate list, Enter opens, Esc deselects\n- [ ] **Select**: Home/End jump, type-ahead search\n- [ ] **Dialog**: Focus trap, Esc closes\n- [ ] **FilterBar**: Tab through all controls\n- [ ] Skip link at page top\n- [ ] Focus indicator (2px ring) on all interactive\n- [ ] aria-activedescendant for roving tabindex\n\n## Quality Gates\n- Tab through entire inbox in \u003c= 20 keystrokes\n- No focus traps except modals\n- VoiceOver announces all controls\n\n## Reference Skills\n- shadcn-ui: Focus ring, keyboard patterns\n- mobile-frontend-design: Keyboard/focus management\n- production-hardening-frontend: WCAG 2.1 AA","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T22:04:29.593556+05:30","updated_at":"2025-12-23T00:22:43.623446+05:30","closed_at":"2025-12-20T03:56:05.428134+05:30","dependencies":[{"issue_id":"mcpmail-252","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:14.307344+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-253","title":"P2: Implement input fuzzing test suite","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:33:47.529532+05:30","updated_at":"2025-12-23T00:22:43.623724+05:30","closed_at":"2025-12-15T18:44:54.504577+05:30","dependencies":[{"issue_id":"mcpmail-253","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.403155+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-254","title":"P2: Add responsive viewport tests (mobile, tablet, desktop, wide)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:33:47.600304+05:30","updated_at":"2025-12-23T00:22:43.62397+05:30","closed_at":"2025-12-15T18:44:39.99096+05:30","dependencies":[{"issue_id":"mcpmail-254","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.446993+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-255","title":"Upgrade Layout component with skip link and semantic landmarks","description":"## Summary\nAdd skip link and proper semantic HTML landmarks to the Layout component.\n\n## Implementation Details\n\n### Update layout.rs\n```rust\n#[component]\npub fn Layout(children: Children) -\u003e impl IntoView {\n    view! {\n        // Skip link (first element)\n        \u003ca href=\"#main-content\" class=\"skip-link\"\u003e\n            \"Skip to main content\"\n        \u003c/a\u003e\n\n        // Header landmark\n        \u003cheader class=\"sticky top-0 z-50 ...\"\u003e\n            \u003cnav aria-label=\"Main navigation\"\u003e\n                // ... nav items\n            \u003c/nav\u003e\n        \u003c/header\u003e\n\n        // Main content landmark\n        \u003cmain id=\"main-content\" tabindex=\"-1\" class=\"flex-1\"\u003e\n            {children()}\n        \u003c/main\u003e\n\n        // Footer landmark\n        \u003cfooter\u003e\n            // ... footer content\n        \u003c/footer\u003e\n    }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/layout.rs\n\n## Acceptance Criteria\n- [ ] Skip link is first focusable element\n- [ ] Skip link targets #main-content\n- [ ] header element used for top bar\n- [ ] nav has aria-label=\"Main navigation\"\n- [ ] main has id=\"main-content\" and tabindex=\"-1\"\n- [ ] footer element used for footer\n- [ ] Tab to skip link, Enter jumps to main content","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:32.2979+05:30","updated_at":"2025-12-23T00:22:43.624239+05:30","closed_at":"2025-12-19T01:53:44.260083+05:30","dependencies":[{"issue_id":"mcpmail-255","depends_on_id":"mcpmail-266","type":"blocks","created_at":"2025-12-18T23:13:47.023277+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-256","title":"Add fluid typography and spacing scale with clamp()","description":"## Summary\nAdd mobile-first fluid typography and spacing using CSS clamp() function for seamless scaling across viewports.\n\n## Implementation Details\n\n### Add to tailwind.css\n```css\n:root {\n  /* Fluid Typography Scale */\n  --font-size-xs:  clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);\n  --font-size-sm:  clamp(0.875rem, 0.8rem + 0.375vw, 1rem);\n  --font-size-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);\n  --font-size-lg:  clamp(1.125rem, 1rem + 0.625vw, 1.25rem);\n  --font-size-xl:  clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);\n  --font-size-2xl: clamp(1.5rem, 1.3rem + 1vw, 2rem);\n  --font-size-3xl: clamp(1.875rem, 1.6rem + 1.375vw, 2.5rem);\n\n  /* Fluid Spacing Scale */\n  --space-xs:  clamp(0.25rem, 0.2rem + 0.25vw, 0.5rem);\n  --space-sm:  clamp(0.5rem, 0.4rem + 0.5vw, 1rem);\n  --space-md:  clamp(1rem, 0.8rem + 1vw, 1.5rem);\n  --space-lg:  clamp(1.5rem, 1.2rem + 1.5vw, 2rem);\n  --space-xl:  clamp(2rem, 1.6rem + 2vw, 3rem);\n\n  /* Touch Target Minimum (WCAG 2.1 AA) */\n  --touch-target-min: 44px;\n\n  /* Dynamic Viewport Height */\n  --vh-dynamic: 100dvh;\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/style/tailwind.css\n\n## Acceptance Criteria\n- [ ] 7 fluid font-size tokens defined with clamp()\n- [ ] 5 fluid spacing tokens defined with clamp()\n- [ ] --touch-target-min: 44px defined\n- [ ] --vh-dynamic: 100dvh defined\n- [ ] Text scales smoothly from 375px to 1440px viewport\n- [ ] No layout shifts during resize (CLS = 0)","notes":"Claimed by worker-yj20","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:14.452571+05:30","updated_at":"2025-12-23T00:22:43.624562+05:30","closed_at":"2025-12-19T00:04:31.605633+05:30","dependencies":[{"issue_id":"mcpmail-256","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:37.708281+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-257","title":"P2: Implement dark mode visual regression tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:33:47.673449+05:30","updated_at":"2025-12-23T00:22:43.624815+05:30","closed_at":"2025-12-15T18:44:39.951949+05:30","dependencies":[{"issue_id":"mcpmail-257","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.491143+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-258","title":"Create Dialog component with focus trap, ARIA, and Escape handling","description":"## Summary\nCreate a Dialog component with proper accessibility: focus trap, ARIA attributes, and keyboard handling.\n\n## Implementation Details\n\n### Create components/dialog.rs\nDialog with compound components: DialogHeader, DialogTitle, DialogDescription, DialogFooter\n\nKey ARIA requirements:\n- role=\"dialog\"\n- aria-modal=\"true\"\n- aria-labelledby linking to DialogTitle id\n- aria-describedby linking to DialogDescription id\n\nKey features:\n- Focus trapped within dialog when open (leptos-use::use_focus_trap)\n- Escape key closes dialog\n- Overlay click closes dialog\n- Focus returns to trigger on close\n\n## Dependencies\nAdd to Cargo.toml:\n```toml\nleptos-use = { version = \"0.15\", features = [\"use_focus_trap\", \"use_event_listener\"] }\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/dialog.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n- crates/services/web-ui-leptos/Cargo.toml\n\n## Acceptance Criteria\n- [ ] Dialog, DialogHeader, DialogTitle, DialogDescription, DialogFooter created\n- [ ] role=\"dialog\" and aria-modal=\"true\" present\n- [ ] aria-labelledby links to DialogTitle id\n- [ ] aria-describedby links to DialogDescription id\n- [ ] Focus trapped within dialog when open\n- [ ] Escape key closes dialog\n- [ ] Overlay click closes dialog\n- [ ] Focus returns to trigger on close","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:31.571288+05:30","updated_at":"2025-12-23T00:22:43.62511+05:30","closed_at":"2025-12-19T01:25:40.883674+05:30","dependencies":[{"issue_id":"mcpmail-258","depends_on_id":"mcpmail-22","type":"blocks","created_at":"2025-12-18T23:13:46.831361+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-259","title":"P2: Add Makefile targets for E2E test modes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:33:47.751529+05:30","updated_at":"2025-12-23T00:22:43.625343+05:30","closed_at":"2025-12-15T18:44:27.419155+05:30","dependencies":[{"issue_id":"mcpmail-259","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.535477+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-26","title":"ORCH-9: Integration tests for multi-agent workflow","description":"## Summary\nE2E tests for the complete multi-agent orchestration workflow.\n\n## Test Scenarios\n1. **Happy Path**: Worker → [COMPLETION] → Reviewer → [APPROVED] → Human\n2. **Fix Flow**: Worker → [COMPLETION] → Reviewer → [FIXED] → Human\n3. **Single-Agent**: Worker → [COMPLETION] (self-reviewed) → Human\n4. **Crash Recovery**: Abandoned task detection and reassignment\n5. **Conflict Resolution**: Multiple reviewers trying to claim\n\n## Implementation\n```rust\n#[tokio::test]\nasync fn test_full_orchestration_workflow() { ... }\n\n#[tokio::test]\nasync fn test_single_agent_fallback() { ... }\n\n#[tokio::test]\nasync fn test_review_claim_prevents_duplicates() { ... }\n\n#[tokio::test]\nasync fn test_abandoned_task_recovery() { ... }\n```\n\n## Acceptance Criteria\n- [ ] All 5 scenarios tested\n- [ ] Uses real MCP tools (not mocks)\n- [ ] Tests thread state machine transitions\n- [ ] Verifies message CC/BCC for audit trail","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T18:36:03.712332+05:30","updated_at":"2025-12-23T00:22:43.553244+05:30","closed_at":"2025-12-20T05:39:18.093422+05:30","dependencies":[{"issue_id":"mcpmail-26","depends_on_id":"mcpmail-45","type":"blocks","created_at":"2025-12-19T18:36:25.347654+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-26","depends_on_id":"mcpmail-46","type":"blocks","created_at":"2025-12-19T18:36:25.406147+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-260","title":"Create Separator component for horizontal/vertical dividers","description":"## Summary\nCreate a Separator component for visual dividers between content sections.\n\n## Implementation Details\n\n### Create components/separator.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::tw_merge;\n\n#[derive(Clone, Copy, Default, PartialEq)]\npub enum Orientation {\n    #[default]\n    Horizontal,\n    Vertical,\n}\n\n#[component]\npub fn Separator(\n    #[prop(optional)] orientation: Option\u003cOrientation\u003e,\n    #[prop(optional, into)] class: MaybeProp\u003cString\u003e,\n) -\u003e impl IntoView {\n    let orientation = orientation.unwrap_or_default();\n    let base_class = \"shrink-0 bg-border\";\n    let orientation_class = match orientation {\n        Orientation::Horizontal =\u003e \"h-[1px] w-full\",\n        Orientation::Vertical =\u003e \"w-[1px] h-full\",\n    };\n\n    view! {\n        \u003cdiv\n            class=tw_merge!(base_class, orientation_class, class.get())\n            role=\"separator\"\n            aria-orientation=match orientation {\n                Orientation::Horizontal =\u003e \"horizontal\",\n                Orientation::Vertical =\u003e \"vertical\",\n            }\n        /\u003e\n    }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/separator.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Separator component created with Horizontal/Vertical orientations\n- [ ] Uses bg-border semantic color\n- [ ] role=\"separator\" attribute present\n- [ ] aria-orientation set correctly\n- [ ] Component exported from mod.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:31.122121+05:30","updated_at":"2025-12-23T00:22:43.625604+05:30","closed_at":"2025-12-19T01:53:44.257439+05:30","dependencies":[{"issue_id":"mcpmail-260","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:46.729448+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-261","title":"GAP: Projects CLI Commands (mark-identity/adopt/status)","description":"## Problem\nPython has project management CLI commands. Rust has limited project commands.\n\n## Python Commands\n- `projects mark-identity --commit` - Write committed .agent-mail-project-id marker\n- `projects discovery-init --product` - Scaffold discovery YAML\n- `projects adopt \u003cfrom\u003e \u003cto\u003e` - Consolidate legacy projects with --dry-run/--apply\n- `projects status` - Inspect product and linked projects\n\n## Implementation\n- Add projects subcommand with subcommands\n- mark-identity: Create/commit .agent-mail-project-id\n- adopt: Migrate artifacts between projects\n- status: Show project details and product links","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T18:00:35.508225+05:30","updated_at":"2025-12-23T00:22:43.625892+05:30","closed_at":"2025-12-19T21:27:45.888047+05:30"}
{"id":"mcpmail-262","title":"GAP: Web UI Human Overseer Composer","description":"## Problem\nPython web UI allows sending overseer messages from browser. Rust UI has no compose feature.\n\n## Python Features\n- Operator message composer in web UI\n- Recipient checkboxes with Select All / Clear\n- Automatic 'MESSAGE FROM HUMAN OVERSEER' preamble\n- Policy bypass for human messages\n\n## Implementation\n- Add compose dialog component to web-ui-leptos\n- POST to send_overseer_message API\n- Add to dashboard or toolbar","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T18:00:25.015203+05:30","updated_at":"2025-12-23T00:22:43.626092+05:30","closed_at":"2025-12-20T00:37:28.335544+05:30"}
{"id":"mcpmail-263","title":"P2: Optimize WASM bundle (LTO, opt-level=z, brotli)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:39:52.005227+05:30","updated_at":"2025-12-23T00:22:43.626305+05:30","closed_at":"2025-12-15T19:00:42.649051+05:30","dependencies":[{"issue_id":"mcpmail-263","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.950645+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-264","title":"P2: Add PWA manifest and service worker","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:39:52.072272+05:30","updated_at":"2025-12-23T00:22:43.62653+05:30","closed_at":"2025-12-15T18:44:27.380335+05:30","dependencies":[{"issue_id":"mcpmail-264","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:14.99724+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-265","title":"GAP: Overdue ACK Escalation System","description":"## Problem\nPython escalates messages not acknowledged within TTL. Rust has ack_ts field but no escalation.\n\n## Python Features\n- ACK_TTL_ENABLED, ACK_TTL_SECONDS (default 1800)\n- ACK_ESCALATION_ENABLED, ACK_ESCALATION_MODE (log or file_reservation)\n- Background task scans for overdue ACKs\n- Escalates via log, overseer message, or file reservation\n\n## Implementation\n- Add background task for ACK TTL scanning\n- Implement escalation modes\n- Add configuration env vars","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T18:00:10.669211+05:30","updated_at":"2025-12-23T00:22:43.626789+05:30","closed_at":"2025-12-20T20:19:04.189535+05:30"}
{"id":"mcpmail-266","title":"Add reduced motion support and skip link for accessibility","description":"## Summary\nAdd prefers-reduced-motion media query and skip link component for keyboard navigation accessibility.\n\n## Implementation Details\n\n### 1. Add to tailwind.css\n```css\n/* Reduced Motion Support */\n@media (prefers-reduced-motion: reduce) {\n  *,\n  *::before,\n  *::after {\n    animation-duration: 0.01ms !important;\n    animation-iteration-count: 1 !important;\n    transition-duration: 0.01ms !important;\n    scroll-behavior: auto !important;\n  }\n}\n\n/* Skip Link Styles */\n.skip-link {\n  position: absolute;\n  top: -40px;\n  left: 0;\n  background: hsl(var(--primary));\n  color: hsl(var(--primary-foreground));\n  padding: 8px 16px;\n  z-index: 100;\n  transition: top 0.2s;\n}\n\n.skip-link:focus {\n  top: 0;\n}\n```\n\n### 2. Update layout.rs\nAdd skip link before navigation.\n\n## Files Changed\n- crates/services/web-ui-leptos/style/tailwind.css\n- crates/services/web-ui-leptos/src/components/layout.rs\n\n## Acceptance Criteria\n- [ ] prefers-reduced-motion media query defined\n- [ ] Animations disabled when user prefers reduced motion\n- [ ] Skip link hidden by default (top: -40px)\n- [ ] Skip link visible on focus (top: 0)\n- [ ] Skip link navigates to #main-content\n- [ ] main element has id=\"main-content\" and tabindex=\"-1\"\n- [ ] Skip link usable via keyboard Tab navigation","notes":"Claimed by worker-tkc9","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:14.899704+05:30","updated_at":"2025-12-23T00:22:43.627013+05:30","closed_at":"2025-12-18T23:55:16.911025+05:30","dependencies":[{"issue_id":"mcpmail-266","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:37.807521+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-267","title":"P2: Run Lighthouse audit (target score \u003e= 90)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:39:52.206282+05:30","updated_at":"2025-12-23T00:22:43.627311+05:30","closed_at":"2025-12-15T19:00:42.688963+05:30","dependencies":[{"issue_id":"mcpmail-267","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:15.085172+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-268","title":"Create Input component with focus ring and error states","description":"## Summary\nCreate a new Input component with shadcn styling, focus ring, and aria-invalid support.\n\n## Implementation Details\n\n### Create components/input.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::tw_merge;\n\nconst INPUT_CLASS: \u0026str = \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\";\n\n#[component]\npub fn Input(\n    #[prop(optional, into)] class: MaybeProp\u003cString\u003e,\n    #[prop(optional)] disabled: bool,\n    #[prop(optional)] invalid: bool,\n    #[prop(optional, into)] placeholder: MaybeProp\u003cString\u003e,\n    #[prop(optional, into)] value: MaybeProp\u003cString\u003e,\n    #[prop(optional)] on_input: Option\u003cCallback\u003cString\u003e\u003e,\n) -\u003e impl IntoView {\n    view! {\n        \u003cinput\n            class=tw_merge!(INPUT_CLASS, class.get())\n            disabled=disabled\n            aria-invalid=invalid.then_some(\"true\")\n            placeholder=placeholder.get()\n            value=value.get()\n        /\u003e\n    }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/input.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Input component created with shadcn classes\n- [ ] Focus ring visible on focus\n- [ ] aria-invalid attribute set when invalid=true\n- [ ] Disabled state styled correctly\n- [ ] Placeholder styled with muted-foreground\n- [ ] Height is 40px (h-10) meeting touch target\n- [ ] Component exported from mod.rs","notes":"Claimed by worker-lw2b","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:15.348906+05:30","updated_at":"2025-12-23T00:22:43.627584+05:30","closed_at":"2025-12-18T23:37:39.060941+05:30","dependencies":[{"issue_id":"mcpmail-268","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:37.900322+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-269","title":"P0 BUG: Pre-commit guard check_file_reservations is stub - returns Ok(None)","description":"## Problem\nThe pre-commit guard was marked complete (mcpmail-400.9) but the core functionality is a STUB.\n\n## Evidence\n```rust\n// precommit_guard.rs line 346-351\n// TODO: Implement actual reservation checking against database\n// For now, pass through with no violations\nOk(None)\n\n// line 409-411 (shell script)\n# TODO: Call agent mail API to verify file reservations\nexit 0\n```\n\n## Impact\nPre-commit hooks install but don't check file reservations - agents can commit reserved files.\n\n## Fix Required\nImplement Rust-native reservation checking in check_file_reservations():\n1. Query FileReservationBmc for active reservations\n2. Check if any staged files conflict with reservations held by other agents\n3. Return violations if conflicts found\n4. Respect advisory/enforce mode\n\n## Files\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Acceptance Criteria\n- [ ] check_file_reservations() queries database for active reservations\n- [ ] Returns violations when agent commits file reserved by another\n- [ ] Advisory mode logs warning but allows commit\n- [ ] Enforce mode blocks commit with conflict details\n- [ ] Integration test verifies conflict detection","status":"closed","issue_type":"bug","created_at":"2025-12-19T17:37:09.532686+05:30","updated_at":"2025-12-23T00:22:43.627846+05:30","closed_at":"2025-12-19T17:47:59.068581+05:30"}
{"id":"mcpmail-27","title":"LEPTOS-005: Add agent filter to attachments page","description":"Add filter by agent to attachments page.\n\n## Requirements\n1. **Backend**: Add agent_id field to Attachment model (optional FK to agents)\n2. **Backend**: Add agent filter param to list_attachments API\n3. **Frontend**: Add agent filter dropdown (cascades from project selection)\n\n## Why Deferred\n- Current Attachment model only has project_id, no agent association\n- Requires database schema migration\n- Requires API changes\n\n## Blocked By\n- Backend schema changes needed first\n\n## Acceptance Criteria\n- [ ] Attachment model has optional agent_id field\n- [ ] list_attachments API accepts agent filter param\n- [ ] Agent dropdown appears after project selection\n- [ ] Filters work correctly\n- [ ] Tests cover agent filtering","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T02:36:40.411417+05:30","updated_at":"2025-12-23T00:22:43.553557+05:30","closed_at":"2025-12-20T02:56:47.661481+05:30"}
{"id":"mcpmail-270","title":"Fix glob pattern matching in file_reservation_paths conflict detection","description":"## Problem\nThe `file_reservation_paths` MCP tool used exact string matching for conflict detection:\n```rust\nres.path_pattern == path  // 'src/**/*.rs' != 'src/main.rs'\n```\n\nThis meant reservations like `src/**/*.rs` would NOT conflict with `src/main.rs`.\n\n## Solution\n- Created `lib_core::utils::pathspec::paths_conflict()` function\n- Uses glob::Pattern matching (same as PrecommitGuard)\n- Handles bidirectional matching (pattern vs literal and vice versa)\n- Detects overlapping patterns via common prefix analysis\n\n## Files Changed\n- `lib-core/src/utils/pathspec.rs` (NEW) - Pathspec matching utility\n- `lib-core/src/utils.rs` - Added module export\n- `lib-mcp/src/tools.rs` - Fixed conflict detection\n\n## Testing\n- 8 unit tests for pathspec matching\n- All existing tests pass\n- Clippy clean","status":"closed","issue_type":"bug","created_at":"2025-12-19T21:01:40.051818+05:30","updated_at":"2025-12-23T00:22:43.628077+05:30","closed_at":"2025-12-19T21:03:06.370094+05:30"}
{"id":"mcpmail-271","title":"Component: Message Detail Header with Actions","description":"## Task\nCreate rich message detail header matching Python reference.\n\n## Design (from screenshots)\n```\n┌─────────────────────────────────────────────────────────────┐\n│  Backend-Frontend Harmonization Sync                        │\n│                                                             │\n│  [🟠 FROM]      [🟣 TO]        [📁 PROJECT]    [📅 SENT]  │\n│   OrangeLake    PinkCastle     /data/proj...   Oct 26, 2025│\n│                                                 at 11:37 PM │\n│                                                             │\n│  [📋 Copy Link]  [↗ Open in Project]                        │\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Components\n1. **Subject Line** - Large, bold title\n2. **Metadata Row** - Grid of FROM/TO/PROJECT/SENT\n   - Each with label + avatar/icon + value\n3. **Action Buttons** - Secondary style\n   - Copy Link: Copies message URL to clipboard\n   - Open in Project: Navigates to project detail\n\n## Implementation\n```rust\n#[component]\npub fn MessageDetailHeader(\n    #[prop(into)] subject: String,\n    #[prop(into)] sender: String,\n    #[prop(into)] recipients: Vec\u003cString\u003e,\n    #[prop(into)] project_slug: String,\n    #[prop(into)] sent_at: String,\n    #[prop(into)] message_id: i64,\n) -\u003e impl IntoView {\n    let copy_link = move |_| {\n        let url = format!(\"{}/inbox/{}\", window_origin(), message_id);\n        copy_to_clipboard(\u0026url);\n        // Show toast\n    };\n\n    view! {\n        \u003cdiv class=\"p-6 border-b border-cream-200 dark:border-charcoal-700\"\u003e\n            \u003ch1 class=\"font-display text-xl font-bold mb-4\"\u003e{subject}\u003c/h1\u003e\n            \n            \u003cdiv class=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\"\u003e\n                \u003cMetadataItem label=\"FROM\" icon=\"user\"\u003e\n                    \u003cAgentAvatar name=sender.clone() size=\"sm\" /\u003e\n                    \u003cspan\u003e{sender}\u003c/span\u003e\n                \u003c/MetadataItem\u003e\n                // ... TO, PROJECT, SENT\n            \u003c/div\u003e\n            \n            \u003cdiv class=\"flex gap-2\"\u003e\n                \u003cbutton class=\"btn-secondary\" on:click=copy_link\u003e\n                    \u003ci data-lucide=\"copy\" class=\"icon-sm\" /\u003e\n                    \"Copy Link\"\n                \u003c/button\u003e\n                \u003ca href={format!(\"/projects/{}\", project_slug)} class=\"btn-secondary\"\u003e\n                    \u003ci data-lucide=\"external-link\" class=\"icon-sm\" /\u003e\n                    \"Open in Project\"\n                \u003c/a\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    }\n}\n```\n\n## Files\n- `components/message_detail_header.rs` (new)\n- `pages/message_detail.rs` (use new component)\n\n## Acceptance Criteria\n- [ ] Copy Link shows toast notification on success\n- [ ] Project link navigates correctly\n- [ ] Avatars display for sender/recipients\n- [ ] Responsive grid (4 cols → 2 cols on mobile)","notes":"Claimed by worker-zcv8, will integrate AgentAvatar from olf5","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:08:42.277713+05:30","updated_at":"2025-12-23T00:22:43.628323+05:30","closed_at":"2025-12-18T16:19:45.322724+05:30"}
{"id":"mcpmail-272","title":"P2: Integrate Probar E2E tests with Leptos UI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:39:52.274207+05:30","updated_at":"2025-12-23T00:22:43.628535+05:30","closed_at":"2025-12-15T18:44:27.338188+05:30","dependencies":[{"issue_id":"mcpmail-272","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:15.12772+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-273","title":"P2: Create Dockerfile and docker-compose.yml","description":"Create multi-stage Dockerfile (builder + runtime) with musl for static binary. Add docker-compose.yml with services: mcp-server, optional reverse proxy. Support volume mounts for data/ and .env.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:14.48199+05:30","updated_at":"2025-12-23T00:22:43.628767+05:30","closed_at":"2025-12-15T22:21:00.923571+05:30","dependencies":[{"issue_id":"mcpmail-273","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:14.483351+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-274","title":"Component: Agent Avatar with Color Generation","description":"## Task\nCreate reusable AgentAvatar component matching Python reference design.\n\n## Design (from screenshots)\n- Circular avatar with colored background\n- Background color derived from agent name hash\n- White/cream initials (first 1-2 chars of name)\n- Sizes: sm (32px), md (40px), lg (48px)\n- Subtle shadow on hover\n\n## Color Palette (from Python UI)\nColors rotate based on name hash:\n- Indigo: #6366f1 (GreenHill)\n- Orange: #f97316 (OrangeLake)  \n- Pink: #ec4899 (PinkCastle)\n- Teal: #14b8a6\n- Purple: #8b5cf6\n- Amber: #f59e0b\n\n## Implementation\n```rust\n#[component]\npub fn AgentAvatar(\n    #[prop(into)] name: String,\n    #[prop(default = \"md\")] size: \u0026'static str,\n) -\u003e impl IntoView {\n    let initials = get_initials(\u0026name);\n    let bg_color = hash_to_color(\u0026name);\n    let size_class = match size {\n        \"sm\" =\u003e \"w-8 h-8 text-xs\",\n        \"lg\" =\u003e \"w-12 h-12 text-base\",\n        _ =\u003e \"w-10 h-10 text-sm\",\n    };\n    \n    view! {\n        \u003cdiv \n            class={format!(\"{} rounded-full flex items-center justify-center font-medium text-white\", size_class)}\n            style={format!(\"background-color: {}\", bg_color)}\n        \u003e\n            {initials}\n        \u003c/div\u003e\n    }\n}\n```\n\n## Files\n- `components/avatar.rs` (new)\n- `components/mod.rs` (add export)\n\n## Acceptance Criteria\n- [ ] Consistent colors for same agent name\n- [ ] Accessible (aria-label with full name)\n- [ ] Works in dark mode (text remains readable)","notes":"Claimed by worker-olf5","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:07:20.145639+05:30","updated_at":"2025-12-23T00:22:43.629052+05:30","closed_at":"2025-12-18T15:29:42.808638+05:30"}
{"id":"mcpmail-275","title":"P2: Implement /api/metrics/tools endpoint","description":"Add /api/metrics/tools endpoint returning tool invocation counts, latencies, error rates. Python parity feature for monitoring tool usage patterns.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:14.927742+05:30","updated_at":"2025-12-23T00:22:43.629261+05:30","closed_at":"2025-12-12T19:19:12.613085+05:30","dependencies":[{"issue_id":"mcpmail-275","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:14.928653+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-276","title":"LEPTOS-002: Add shadcn CSS Variables Infrastructure","description":"## Summary\nAdd shadcn/ui semantic color tokens to tailwind.css alongside existing project tokens.\n\n## Implementation\nAdd to `style/tailwind.css`:\n```css\n:root {\n  --background: 0 0% 100%;\n  --foreground: 222.2 84% 4.9%;\n  --card: 0 0% 100%;\n  --primary: 37 91% 55%;\n  --ring: 37 91% 55%;\n  --radius: 0.5rem;\n  \n  /* Fluid Typography */\n  --font-size-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);\n  \n  /* Touch Targets */\n  --touch-target-min: 44px;\n}\n\n.dark { /* dark mode tokens */ }\n\n@media (prefers-reduced-motion: reduce) {\n  *, *::before, *::after {\n    animation-duration: 0.01ms !important;\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] 14 semantic tokens defined (--background, --foreground, --card, etc.)\n- [ ] Dark mode tokens in .dark class\n- [ ] Existing tokens preserved (--bg-base, --accent-amber)\n- [ ] Fluid typography scale (7 sizes with clamp())\n- [ ] Fluid spacing scale (5 sizes)\n- [ ] --touch-target-min: 44px defined\n- [ ] .focus-ring utility class\n- [ ] Reduced motion @media support\n\n## Quality Gates\n- Tokens render correctly in DevTools\n- No duplicate CSS variable names\n\n## Reference Skills\n- shadcn-ui: Design system tokens\n- mobile-frontend-design: Touch targets, fluid typography\n- production-hardening-frontend: Reduced motion support","status":"closed","issue_type":"task","created_at":"2025-12-19T22:03:09.300185+05:30","updated_at":"2025-12-23T00:22:43.629553+05:30","closed_at":"2025-12-20T01:42:35.424431+05:30"}
{"id":"mcpmail-277","title":"PORT: Archive Browser Tests (20 git history tests)","description":"## Description\nPort the 20 archive browser tests for git history exploration functionality.\n\n## Test Categories\n\n### Commit Browsing\n- List commits\n- View commit details\n- Commit diff display\n\n### File Navigation\n- Browse files at commit\n- View file content\n- File history\n\n### Activity Timeline\n- Activity graph\n- Time-based filtering\n- Project filtering\n\n### Network Graph\n- Branch visualization\n- Merge points\n- Worktree display\n\n## Reference\n- Python: tests/test_archive_browser.py\n\n## Implementation Notes\n- Requires git2-rs integration\n- Tests archive HTML routes\n- Validates commit traversal\n- May use libgit2 for history access","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:58:18.271584+05:30","updated_at":"2025-12-23T00:22:43.629882+05:30","closed_at":"2025-12-21T07:20:06.726745+05:30"}
{"id":"mcpmail-278","title":"PORT: Mail Viewer E2E Tests (26 browser tests)","description":"## Description\nPort the 26 mail viewer E2E tests for browser-based functionality validation.\n\n## Test Categories\n\n### Page Rendering\n- Viewer loads correctly\n- Message list displays\n- Message detail view\n- Thread navigation\n\n### Interaction\n- Message selection\n- Reply composition\n- Search functionality\n- Filtering\n\n### Data Binding\n- Message content rendering\n- Attachment display\n- Timestamp formatting\n- Importance badges\n\n## Reference\n- Python: tests/test_mail_viewer_e2e.py\n\n## Implementation Notes\n- Consider using Playwright or Probar for browser automation\n- Tests static viewer HTML/JS/CSS\n- Validates client-side JavaScript behavior\n- May overlap with E2E_TEST_PLAN.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:58:18.080662+05:30","updated_at":"2025-12-23T00:22:43.63009+05:30","closed_at":"2025-12-21T07:29:48.573535+05:30"}
{"id":"mcpmail-279","title":"PORT: Performance Benchmark Tests (8 scaling tests)","description":"## Description\nPort performance benchmark tests to validate export scaling and efficiency.\n\n## Tests\n1. test_small_bundle_export_performance\n2. test_medium_bundle_export_performance\n3. test_large_bundle_export_performance\n4. test_database_compressibility\n5. test_chunk_size_validation\n6. test_vacuum_improves_locality\n7. test_browser_performance_requirements_documentation\n8. test_export_scales_linearly (parametrized)\n\n## Reference\n- Python: tests/test_performance_benchmarks.py\n\n## Implementation Notes\n- Use criterion for Rust benchmarks\n- Test with varying database sizes\n- Validate O(n) scaling for exports\n- Test chunk size boundaries","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:58:17.892959+05:30","updated_at":"2025-12-23T00:22:43.630299+05:30","closed_at":"2025-12-21T07:41:51.013852+05:30"}
{"id":"mcpmail-28","title":"Add --robot-status flag for system health JSON","description":"Add --robot-status for machine-readable system health check.\n\n## CLI Interface\n```bash\nmcp-agent-mail --robot-status\nmcp-agent-mail --robot-status --format yaml\n```\n\n## Output Schema\n```json\n{\n  \"schema_version\": \"1.0.0\",\n  \"tool\": \"mcp-agent-mail\",\n  \"version\": \"0.3.0\",\n  \"timestamp\": \"2025-12-21T08:30:00Z\",\n  \"status\": \"healthy\",\n  \"checks\": {\n    \"database\": {\"status\": \"ok\", \"path\": \"data/mcp_agent_mail.db\"},\n    \"git_archive\": {\"status\": \"ok\", \"path\": \"data/archive\"},\n    \"config\": {\"status\": \"ok\", \"port\": 8765}\n  },\n  \"exit_code\": 0\n}\n```\n\n## Exit Codes\n- 0: All checks pass\n- 1: One or more checks failed\n\n## Implementation\n```rust\n#[derive(Serialize)]\nstruct RobotStatusOutput {\n    schema_version: String,\n    tool: String,\n    version: String,\n    timestamp: String,\n    status: String,  // \"healthy\" | \"degraded\" | \"unhealthy\"\n    checks: HashMap\u003cString, CheckResult\u003e,\n    exit_code: u8,\n}\n```\n\n## Location\ncrates/services/mcp-agent-mail/src/robot_help.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:36:48.979701+05:30","updated_at":"2025-12-23T00:22:43.553829+05:30","closed_at":"2025-12-21T22:21:22.700522+05:30","dependencies":[{"issue_id":"mcpmail-28","depends_on_id":"mcpmail-244","type":"blocks","created_at":"2025-12-21T08:43:43.46268+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-280","title":"PORT: Project Mail Web UI Routes (inbox/message/thread views)","description":"## Description\nPort the Python project-specific mail web UI routes for viewing inbox, messages, and threads.\n\n## Missing Routes\n\n### Inbox \u0026 Messages\n- `/mail/{project}` - Project overview HTML\n- `/mail/{project}/inbox/{agent}` - Agent inbox HTML\n- `/mail/{project}/inbox/{agent}/mark-read` - Mark single message read (POST)\n- `/mail/{project}/inbox/{agent}/mark-all-read` - Mark all messages read (POST)\n- `/mail/{project}/message/{mid}` - Message detail HTML\n\n### Threads \u0026 Search\n- `/mail/{project}/thread/{thread_id}` - Thread view HTML\n- `/mail/{project}/search` - Search results HTML\n\n### File Management\n- `/mail/{project}/file_reservations` - File reservations HTML\n- `/mail/{project}/attachments` - Attachments HTML\n\n### Overseer\n- `/mail/{project}/overseer/compose` - Compose overseer message HTML\n- `/mail/{project}/overseer/send` - Send overseer message (POST)\n\n### Projects List\n- `/mail/projects` - All projects list HTML\n\n## Reference\n- Python: mcp_agent_mail/src/mcp_agent_mail/http.py lines 1305-2092\n\n## Implementation Notes\n- Uses Jinja2 templates in Python\n- Consider Leptos components or HTMX + Askama\n- Depends on unified inbox feature (s0j bead)","notes":"Claimed by worker-f6w, analyzing existing Leptos UI","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:51:52.574271+05:30","updated_at":"2025-12-23T00:22:43.630534+05:30","closed_at":"2025-12-21T08:06:35.113783+05:30"}
{"id":"mcpmail-281","title":"P2: Implement /api/recent activity endpoint","description":"Add /api/recent endpoint returning recent activity across all projects: messages, reservations, agent registrations. Useful for dashboard/monitoring. Python parity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:15.252902+05:30","updated_at":"2025-12-23T00:22:43.630758+05:30","closed_at":"2025-12-15T21:42:22.886554+05:30","dependencies":[{"issue_id":"mcpmail-281","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:15.253673+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-282","title":"P2: Implement export module (JSON/CSV mailbox export)","description":"Add CLI export command and /api/export endpoint. Support JSON and CSV formats. Export full mailbox or filtered by agent/date range. Python: mcp_agent_mail.cli export --format json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:15.581081+05:30","updated_at":"2025-12-23T00:22:43.63104+05:30","closed_at":"2025-12-15T22:21:00.985846+05:30","dependencies":[{"issue_id":"mcpmail-282","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:15.581859+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-283","title":"PORT-5.2: Add graceful FTS5 query error handling","description":"## Problem\nMalformed FTS5 queries can crash search. Need graceful handling.\n\n## Implementation\n- Wrap search in match for FTS5 syntax errors\n- Log warning for invalid queries\n- Return empty result with explanation\n- is_fts_syntax_error() helper\n\n## Files\n- crates/libs/lib-core/src/model/message.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/db.py\n- Commit e64842c: fix(stability): graceful FTS5 query handling\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: FTS5, syntax error, graceful)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 5.2)\n\n## Acceptance Criteria\n- [ ] Malformed FTS queries don't crash\n- [ ] Warning logged for invalid queries\n- [ ] Empty result returned (not error)\n- [ ] Tests for malformed queries\n\n## Complexity: 3/10","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:28:12.508717+05:30","updated_at":"2025-12-23T00:22:43.631307+05:30","closed_at":"2025-12-19T18:44:34.918513+05:30"}
{"id":"mcpmail-284","title":"PORT-5.1: Handle FTS5 leading wildcards gracefully","description":"## Problem\nFTS5 doesn't support leading wildcards (*foo). Need graceful handling.\n\n## Implementation\n- sanitize_fts_query() function\n- Detect leading wildcard, strip and convert to prefix search\n- Escape special FTS5 characters (\" and \\)\n- Return clear error for empty/all-wildcard queries\n\n## Files\n- crates/libs/lib-core/src/model/message.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/db.py\n- Commit 2fbc0ee: fix(fts): handle leading wildcards without space\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: wildcard, FTS5, fts)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 5.1)\n\n## Acceptance Criteria\n- [ ] Leading wildcards handled gracefully\n- [ ] Clear error if query invalid\n- [ ] FTS5 special characters escaped\n- [ ] Tests for edge cases\n\n## Complexity: 3/10","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:28:12.441315+05:30","updated_at":"2025-12-23T00:22:43.631536+05:30","closed_at":"2025-12-19T18:44:34.649049+05:30"}
{"id":"mcpmail-285","title":"P2: Enable stricter clippy lints (unwrap_used, expect_used)","description":"Per PMAT recommendation, enable additional clippy lints to catch unwrap usage at compile time. Add to Cargo.toml: [lints.clippy] unwrap_used = 'deny', expect_used = 'warn'. This prevents future unwrap additions and flags existing expect() calls for review. Run: cargo clippy -- -D clippy::unwrap_used to find all violations. Fix or annotate with #[allow] and justification comment.","notes":"Implementing stricter clippy lints","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T20:52:50.029506+05:30","updated_at":"2025-12-23T00:22:43.631779+05:30","closed_at":"2025-12-17T23:47:05.851289+05:30"}
{"id":"mcpmail-286","title":"P2: Add JWT authentication test with mock JWKS server","description":"JWT auth (4823d14) has bearer tests but no JWT test. Add test_auth_jwt_success/failure using wiremock to mock JWKS endpoint, generate test JWT with RS256, verify validation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T17:59:02.867501+05:30","updated_at":"2025-12-23T00:22:43.632042+05:30","closed_at":"2025-12-12T18:50:56.976188+05:30","dependencies":[{"issue_id":"mcpmail-286","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T17:59:02.868087+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-287","title":"Add InstallPrecommitGuardParams and UninstallPrecommitGuardParams structs","description":"Add parameter structs with JsonSchema derive for MCP tool definitions in lib-mcp/src/tools.rs:\n- InstallPrecommitGuardParams { project_slug: String, git_repo_path: String }\n- UninstallPrecommitGuardParams { project_slug: String, git_repo_path: String }","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:13.001119+05:30","updated_at":"2025-12-23T00:22:43.632268+05:30","closed_at":"2025-12-17T19:27:26.284876+05:30","dependencies":[{"issue_id":"mcpmail-287","depends_on_id":"mcpmail-305","type":"blocks","created_at":"2025-12-16T20:06:13.001822+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-288","title":"Add ToolSchema entries for precommit guard tools","description":"Add ToolSchema entries in get_tool_schemas() function:\n- install_precommit_guard: Install git pre-commit hook for file reservation checks\n- uninstall_precommit_guard: Remove the pre-commit guard hook","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:13.378742+05:30","updated_at":"2025-12-23T00:22:43.632514+05:30","closed_at":"2025-12-17T19:27:26.285883+05:30","dependencies":[{"issue_id":"mcpmail-288","depends_on_id":"mcpmail-305","type":"blocks","created_at":"2025-12-16T20:06:13.379392+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-289","title":"Update README with sidecar deployment docs","description":"Document sidecar usage: Claude Desktop config, Docker/K8s sidecar patterns, --no-ui vs --with-ui modes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T17:52:52.527503+05:30","updated_at":"2025-12-23T00:22:43.632812+05:30","closed_at":"2025-12-17T19:02:11.26907+05:30","dependencies":[{"issue_id":"mcpmail-289","depends_on_id":"mcpmail-290","type":"blocks","created_at":"2025-12-17T17:53:00.161654+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-29","title":"T5: Route registration for pending-reviews","description":"Register routes: /api/messages/pending-reviews (GET), /api/pending_reviews (Python alias). Complexity: 2/10. File: crates/libs/lib-server/src/api.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:56.416056+05:30","updated_at":"2025-12-23T00:22:43.554205+05:30","closed_at":"2025-12-18T18:35:40.658229+05:30","dependencies":[{"issue_id":"mcpmail-29","depends_on_id":"mcpmail-31","type":"blocks","created_at":"2025-12-18T17:46:09.376189+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-290","title":"Add Makefile sidecar build targets","description":"Add build-sidecar, build-sidecar-minimal, and build-claude-desktop targets. Include trunk build step before cargo build.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T17:52:52.316473+05:30","updated_at":"2025-12-23T00:22:43.633049+05:30","closed_at":"2025-12-17T19:01:05.931522+05:30","dependencies":[{"issue_id":"mcpmail-290","depends_on_id":"mcpmail-327","type":"blocks","created_at":"2025-12-17T17:53:00.123619+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-291","title":"Add quick_standup_workflow convenience tool","description":"Add MCP tool that broadcasts a standup request to all agents in a project:\n- QuickStandupParams { project_slug, sender_name, questions?: Vec\u003cString\u003e }\n- Sends message to all agents asking for status update\n- Default questions: What did you work on? What are blockers? What's next?\n- Returns list of message_ids sent","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:57.674929+05:30","updated_at":"2025-12-23T00:22:43.633337+05:30","closed_at":"2025-12-17T20:29:05.52586+05:30","dependencies":[{"issue_id":"mcpmail-291","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:57.675613+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-292","title":"Add quick_review_workflow convenience tool","description":"Add MCP tool that initiates a code review workflow:\n- QuickReviewParams { project_slug, reviewer_name, author_name, files: Vec\u003cString\u003e, description }\n- Sends review request with file list\n- Reserves files for reviewer\n- Returns review_id for tracking","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:58.596133+05:30","updated_at":"2025-12-23T00:22:43.63518+05:30","closed_at":"2025-12-17T20:29:05.526434+05:30","dependencies":[{"issue_id":"mcpmail-292","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:58.596804+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-293","title":"Add list_builtin_workflows MCP tool","description":"Add tool to list pre-defined workflow templates:\n- Returns array of built-in workflow names and descriptions\n- Includes: standup, handoff, review, sync, deploy-check\n- Each entry has: name, description, required_params, optional_params","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:59.083861+05:30","updated_at":"2025-12-23T00:22:43.63558+05:30","closed_at":"2025-12-17T20:29:05.52497+05:30","dependencies":[{"issue_id":"mcpmail-293","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:59.084554+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-294","title":"P0: Create .env.example with all 30+ environment variables","description":"Create .env.example with: HTTP_HOST, HTTP_PORT, HTTP_BEARER_TOKEN, HTTP_AUTH_MODE, HTTP_JWKS_URL, HTTP_ALLOW_LOCALHOST_UNAUTHENTICATED, SQLITE_PATH, GIT_REPO_PATH, LLM_ENABLED, OPENAI_API_KEY, plus 20+ more Python parity vars.","status":"closed","issue_type":"task","created_at":"2025-12-12T10:23:21.653348+05:30","updated_at":"2025-12-23T00:22:43.635871+05:30","closed_at":"2025-12-15T17:47:43.722088+05:30","dependencies":[{"issue_id":"mcpmail-294","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:23:21.654231+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-295","title":"Phase 1: Core Architecture","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-09T01:39:23.315607+05:30","updated_at":"2025-12-23T00:22:43.636145+05:30","closed_at":"2025-12-09T01:39:37.728084+05:30"}
{"id":"mcpmail-296","title":"GAP: MCP Resources API (resource://inbox, resource://thread)","description":"## Problem\nPython implements MCP resource URIs for lazy loading. Rust only has tool-based API.\n\n## Python Resources\n- resource://inbox/{agent}?project=\u003cpath\u003e\u0026limit=20\u0026include_bodies\n- resource://thread/{id}?project=\u003cpath\u003e\u0026include_bodies\n- resource://agent/{name}?project=\u003cpath\u003e\n- resource://product/{key}\n- resource://identity/{/abs/path}\n\n## Implementation\n- Add MCP resource handler in lib-mcp\n- Implement resource URI parsing\n- Map to existing BMC methods\n- Support include_bodies for lazy loading","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T18:00:24.541906+05:30","updated_at":"2025-12-23T00:22:43.636362+05:30","closed_at":"2025-12-20T08:18:48.721591+05:30"}
{"id":"mcpmail-297","title":"Epic: Web-UI Production Hardening","description":"Production hardening for SvelteKit web-ui covering security, performance, accessibility, and code organization based on frontend-dev-guidelines and production-hardening-frontend skills review.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-10T02:45:06.333713+05:30","updated_at":"2025-12-23T00:22:43.636617+05:30","closed_at":"2025-12-15T18:44:27.686702+05:30"}
{"id":"mcpmail-298","title":"LEPTOS-001: Add tailwind_fuse for CVA Patterns","description":"## Summary\nAdd tailwind_fuse crate to web-ui-leptos for CVA (Class Variance Authority) equivalent pattern matching shadcn-ui component system.\n\n## Implementation\n```toml\n# Cargo.toml\ntailwind_fuse = \"0.3\"\n```\n\n```rust\nuse tailwind_fuse::*;\n\n#[derive(TwClass)]\n#[tw(class = \"inline-flex items-center justify-center rounded-md\")]\npub struct ButtonClass {\n    pub variant: ButtonVariant,\n    pub size: ButtonSize,\n}\n```\n\n## Acceptance Criteria\n- [ ] `tailwind_fuse = \"0.3\"` added to Cargo.toml\n- [ ] Example ButtonClass with variant/size derives compiles\n- [ ] `tw_merge!` macro works for class concatenation\n- [ ] cargo check passes\n- [ ] No duplicate variant classes in output\n\n## Quality Gates\n- `cargo check \u0026\u0026 cargo clippy -- -D warnings`\n\n## Reference Skills\n- shadcn-ui: CVA patterns, variant anatomy","status":"closed","issue_type":"task","created_at":"2025-12-19T22:03:08.978407+05:30","updated_at":"2025-12-23T00:22:43.636995+05:30","closed_at":"2025-12-20T01:42:35.355305+05:30"}
{"id":"mcpmail-299","title":"Add shadcn CSS semantic tokens and tailwind_fuse dependency","description":"## Summary\nAdd shadcn/ui CSS custom properties to tailwind.css and add tailwind_fuse crate for CVA-style variant management in Rust.\n\n## Implementation Details\n\n### 1. Add to Cargo.toml\n```toml\ntailwind_fuse = \"0.3\"\n```\n\n### 2. Add to tailwind.css (coexist with existing tokens)\n```css\n:root {\n  --background: 0 0% 100%;\n  --foreground: 222.2 84% 4.9%;\n  --card: 0 0% 100%;\n  --card-foreground: 222.2 84% 4.9%;\n  --primary: 37 91% 55%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 210 40% 96.1%;\n  --secondary-foreground: 222.2 47.4% 11.2%;\n  --muted: 210 40% 96.1%;\n  --muted-foreground: 215.4 16.3% 46.9%;\n  --accent: 210 40% 96.1%;\n  --accent-foreground: 222.2 47.4% 11.2%;\n  --destructive: 0 84.2% 60.2%;\n  --destructive-foreground: 210 40% 98%;\n  --border: 214.3 31.8% 91.4%;\n  --input: 214.3 31.8% 91.4%;\n  --ring: 37 91% 55%;\n  --radius: 0.5rem;\n}\n\n.dark {\n  --background: 222.2 84% 4.9%;\n  --foreground: 210 40% 98%;\n  /* ... dark mode values */\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/Cargo.toml\n- crates/services/web-ui-leptos/style/tailwind.css\n\n## Acceptance Criteria\n- [ ] tailwind_fuse = \"0.3\" added to Cargo.toml\n- [ ] All 14 shadcn semantic tokens defined in :root\n- [ ] Dark mode tokens defined in .dark class\n- [ ] Existing custom tokens (--bg-base, --accent-amber) preserved\n- [ ] cargo check passes\n- [ ] Variables render correctly in browser DevTools","notes":"Claimed by worker - prerequisite for lw2b","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:14.2303+05:30","updated_at":"2025-12-23T00:22:43.637356+05:30","closed_at":"2025-12-18T23:37:39.00436+05:30"}
{"id":"mcpmail-2eq4","title":"SVELTE-022c: AppHeader Breadcrumbs","description":"Dynamic breadcrumbs, Cmd+K trigger, mobile hamburger, desktop toggle.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T16:57:02.609067+05:30","updated_at":"2025-12-23T19:13:06.927201+05:30","closed_at":"2025-12-23T19:13:06.927201+05:30","dependencies":[{"issue_id":"mcpmail-2eq4","depends_on_id":"mcpmail-8dqi","type":"blocks","created_at":"2025-12-23T16:57:30.771741+05:30","created_by":"amrit"}]}
{"id":"mcpmail-3","title":"GAP: Quota Enforcement System","description":"## Problem\nPython has storage quota enforcement. Rust has no limits.\n\n## Python Features\n- QUOTA_ENABLED - Enable enforcement\n- QUOTA_ATTACHMENTS_LIMIT_BYTES - Per-project attachment cap\n- QUOTA_INBOX_LIMIT_COUNT - Per-agent message cap\n\n## Implementation\n- Add quota checking before writes\n- Return QuotaExceeded error\n- Add quota status endpoint","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T18:00:24.774285+05:30","updated_at":"2025-12-23T00:22:43.545545+05:30","closed_at":"2025-12-21T23:39:05.23922+05:30"}
{"id":"mcpmail-30","title":"MCP: Expose search_messages_product and summarize_thread_product tools","description":"The tools exist in lib-mcp/src/tools/mod.rs (lines 3801-3930) but are not exposed in tool schemas. Add them to get_all_tool_schemas() to make them discoverable. These enable cross-project search and thread summarization.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T22:31:56.548727+05:30","updated_at":"2025-12-23T00:22:43.554611+05:30","closed_at":"2025-12-22T03:09:35.64878+05:30"}
{"id":"mcpmail-301","title":"PORT: XSS Security Test Corpus (8 sanitization tests)","description":"## Description\nPort the critical XSS security test corpus from Python to validate viewer security.\n\n## XSS Vector Categories Tested\n- script_tags (5 vectors)\n- event_handlers (9 vectors)\n- javascript_urls (5 vectors)\n- data_urls (3 vectors)\n- meta_refresh (3 vectors)\n- svg_xss (4 vectors)\n- css_injection (4 vectors)\n- html5_vectors (4 vectors)\n- markdown_specific (varies)\n\n## Tests\n1. test_xss_vectors_properly_escaped (parametrized)\n2. test_xss_in_subject_lines\n3. test_xss_in_attachment_metadata\n4. test_markdown_specific_xss_vectors\n5. test_dompurify_sanitization_end_to_end\n6. test_csp_header_enforcement\n7. test_xss_corpus_coverage\n8. test_xss_regression_suite_readme\n\n## Reference\n- Python: tests/test_xss_corpus.py\n\n## Implementation Notes\n- P0 CRITICAL - Security vulnerability prevention\n- Must validate all vectors are escaped/sanitized\n- CSP header enforcement validation\n- DOMPurify integration testing\n- Covers OWASP Top 10 XSS prevention","notes":"Claimed by worker-1fka","status":"closed","issue_type":"task","created_at":"2025-12-18T00:58:02.028387+05:30","updated_at":"2025-12-23T00:22:43.63843+05:30","closed_at":"2025-12-18T15:07:13.449118+05:30"}
{"id":"mcpmail-302","title":"REVIEW: macro_file_reservation_cycle has no action validation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T03:06:53.820317+05:30","updated_at":"2025-12-23T00:22:43.638676+05:30","closed_at":"2025-12-22T03:08:57.606277+05:30"}
{"id":"mcpmail-303","title":"P0: Replace pre-commit hooks with prek (Rust-based)","description":"## Problem\nCurrent pre-commit hooks are shell scripts. Need faster, Rust-native alternative.\n\n## Solution\nReplace with **prek** - pre-commit re-engineered in Rust by j178.\n\n## Installation\n```bash\n# Build from source (Rust 1.89+ required)\ncargo install --locked prek\n\n# Or shell installer (standalone binary)\ncurl --proto '=https' --tlsv1.2 -LsSf https://github.com/j178/prek/releases/download/v0.2.22/prek-installer.sh | sh\n```\n\n## Why prek over pre-commit?\n- Single binary, no Python dependency\n- Multiple times faster than pre-commit\n- Half the disk space usage\n- Full pre-commit config compatibility\n- Native Rust hook support with automatic toolchain management\n\n## Migration Steps\n1. `cargo install --locked prek`\n2. Convert .claude/hooks/ scripts to .pre-commit-config.yaml\n3. Configure hooks: cargo fmt, cargo clippy, cargo audit, bd sync\n4. `prek install` to set up hooks\n5. Remove shell-based hooks\n6. Update CONTRIBUTING.md\n\n## References\n- https://github.com/j178/prek\n- https://prek.j178.dev/quickstart/\n\n## Acceptance Criteria\n- [ ] prek installed via cargo\n- [ ] All current checks migrated (fmt, clippy, audit, beads)\n- [ ] Pre-commit hooks run in \u003c2s\n- [ ] Documentation updated","status":"closed","issue_type":"task","created_at":"2025-12-18T01:33:28.417101+05:30","updated_at":"2025-12-23T00:22:43.638928+05:30","closed_at":"2025-12-19T18:30:47.482937+05:30"}
{"id":"mcpmail-304","title":"Add offline fallback page for PWA","description":"Create src/routes/offline/+page.svelte with friendly offline message. Update vite.config.ts workbox navigateFallback to /offline.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-10T02:45:44.418415+05:30","updated_at":"2025-12-23T00:22:43.639185+05:30","closed_at":"2025-12-15T18:44:27.764758+05:30","dependencies":[{"issue_id":"mcpmail-304","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:44.418961+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-305","title":"Epic: Pre-commit Guard MCP Integration","description":"Pre-commit guard hooks currently work only via REST API. Need to expose install_precommit_guard and uninstall_precommit_guard as MCP tools for Claude Desktop and other MCP clients to use directly.\n\nCurrent State:\n- REST API: /api/setup/install_guard (POST) - works\n- REST API: /api/setup/uninstall_guard (POST) - works\n- MCP: Not exposed - missing from lib-mcp/src/tools.rs\n\nRequired Changes:\n1. Add InstallPrecommitGuardParams struct with path_pattern field\n2. Add UninstallPrecommitGuardParams struct with path_pattern field\n3. Add ToolSchema entries for install_precommit_guard and uninstall_precommit_guard\n4. Register both tools in the tool_router! macro\n5. Implement the tool handlers calling lib-core PrecommitGuardBmc\n6. Add integration tests for MCP tool calls\n\nAcceptance Criteria:\n- MCP clients can call install_precommit_guard and uninstall_precommit_guard tools\n- Tool schemas appear in tools/list response\n- Git hooks are correctly installed/uninstalled via MCP","notes":"Starting P2 epic in worktree: .sandboxes/agent-precommit-guard. Following multi-agent workflow from AGENTS.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-16T20:05:50.940667+05:30","updated_at":"2025-12-23T00:22:43.639506+05:30","closed_at":"2025-12-17T19:27:41.015463+05:30"}
{"id":"mcpmail-306","title":"NTM-004: Implement macro_start_session tool","description":"Add macro_start_session as specific convenience tool for session initialization.\n\nNTM expects this dedicated tool for starting agent sessions. Current implementation has generic invoke_macro.\n\n**Implementation options:**\n1. Add as alias to invoke_macro with name='start_session'\n2. Add as dedicated tool that calls the start_session macro\n\n**Proposed approach - dedicated tool:**\n```rust\n#[tool(description = \"Initialize an agent session (register + check inbox).\")]\nasync fn macro_start_session(\n    \u0026self,\n    params: Parameters\u003cMacroStartSessionParams\u003e,\n) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    // Equivalent to invoke_macro(name=\"start_session\", ...)\n    let invoke_params = InvokeMacroParams {\n        project_slug: params.0.project_slug,\n        macro_name: \"start_session\".to_string(),\n        ..Default::default()\n    };\n    self.invoke_macro(Parameters(invoke_params)).await\n}\n```\n\n**Acceptance Criteria:**\n- [ ] Tool implemented\n- [ ] Calls start_session macro internally\n- [ ] Schema added  \n- [ ] Tests added\n- [ ] Works with ntm client\n\n**Reference Files:**\n- crates/libs/lib-core/src/model/macro_def.rs:237 (start_session macro definition)\n- crates/libs/lib-mcp/src/tools/mod.rs (invoke_macro implementation)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T06:39:47.214491+05:30","updated_at":"2025-12-23T00:22:43.639811+05:30","closed_at":"2025-12-22T07:43:45.824626+05:30","dependencies":[{"issue_id":"mcpmail-306","depends_on_id":"mcpmail-387","type":"blocks","created_at":"2025-12-22T06:58:24.535649+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-307","title":"Add unit tests for capability auto-grant","description":"Missing unit tests for capability auto-grant behavior in register_agent. Should test: 1) New agent gets default capabilities 2) Existing agent doesn't re-grant 3) Partial failure handling","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T20:22:23.1481+05:30","updated_at":"2025-12-23T00:22:43.64006+05:30","closed_at":"2025-12-22T20:33:00.194424+05:30"}
{"id":"mcpmail-308","title":"ORCH-4: Add check_reviewer_exists helper","description":"## Summary\nHelper function to check if a reviewer agent exists for single-agent fallback.\n\n## Implementation\n```rust\npub async fn check_reviewer_exists(\n    ctx: \u0026Ctx,\n    mm: \u0026ModelManager,\n    project_id: i64,\n) -\u003e Result\u003cOption\u003cAgent\u003e\u003e\n```\n\n## Use Case\nWorker calls this before sending [COMPLETION]:\n- If reviewer exists → send to reviewer, CC human\n- If no reviewer → send directly to human (self-reviewed)\n\n## Acceptance Criteria\n- [ ] Returns Some(agent) if agent named 'reviewer' exists\n- [ ] Returns None if no reviewer registered\n- [ ] Checks agent is active (not stale)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:34:35.884154+05:30","updated_at":"2025-12-23T00:22:43.640269+05:30","closed_at":"2025-12-20T00:50:52.018165+05:30"}
{"id":"mcpmail-31","title":"T3: REST handler GET /api/messages/pending-reviews","description":"Add list_pending_reviews handler with Query extractor. Params: project, sender, limit (clamped 1-50). Resolve project_slug to id, sender_name to id. Transform PendingReviewRow to response. Complexity: 5/10. File: crates/libs/lib-server/src/tools.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:55.881552+05:30","updated_at":"2025-12-23T00:22:43.55497+05:30","closed_at":"2025-12-18T18:35:40.657221+05:30","dependencies":[{"issue_id":"mcpmail-31","depends_on_id":"mcpmail-33","type":"blocks","created_at":"2025-12-18T17:46:08.809292+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-31","depends_on_id":"mcpmail-237","type":"blocks","created_at":"2025-12-18T17:46:08.859943+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-310","title":"EPIC: Gmail-Style Unified Inbox Enhancement","description":"## Overview\nEnhance the Unified Inbox to match Python reference - Gmail-style split view with comprehensive filtering.\n\n## Current State (Leptos)\n- Single column message list\n- Basic importance filter dropdown\n- Click navigates to separate detail page\n\n## Target State (Python Reference)\n- **Split View Layout**: Left panel (message list 35%) + Right panel (message detail 65%)\n- **Comprehensive Filter Bar**:\n  - Global search input with placeholder \"Search all messages across all projects and agents...\"\n  - Project dropdown (with \"All Projects\" option)\n  - Sender dropdown (dynamically populated)\n  - Recipient dropdown\n  - Importance dropdown (All/High/Normal)\n  - Threads toggle\n  - View toggle (list/grid icons)\n  - Message count badge\n- **Rich Message List Items**:\n  - Agent avatar (colored circle with initials)\n  - Project path badge (clickable)\n  - Thread indicator badge (purple)\n  - Selection checkbox\n  - Time grouping (Just now, 5m ago, etc.)\n- **Message Detail Panel** (inline, no navigation):\n  - FROM/TO with avatars\n  - PROJECT badge with path\n  - SENT timestamp\n  - Action buttons: Copy Link, Open in Project\n  - Message content with markdown rendering\n\n## Design System Compliance\n- Use existing amber/teal/purple accents\n- Use existing card-elevated, badge-*, btn-* classes\n- Match existing Digital Correspondence aesthetic\n\n## Acceptance Criteria\n- [ ] Split view works on desktop (≥1024px)\n- [ ] Falls back to single column on mobile\n- [ ] Filter bar is sticky on scroll\n- [ ] Message selection updates detail panel without page reload\n- [ ] Keyboard navigation (up/down arrows)\n- [ ] Touch-friendly on tablet (44px min targets)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T06:07:06.844779+05:30","updated_at":"2025-12-23T00:22:43.640757+05:30","closed_at":"2025-12-22T05:32:53.121162+05:30","dependencies":[{"issue_id":"mcpmail-310","depends_on_id":"mcpmail-362","type":"blocks","created_at":"2025-12-19T22:08:53.794333+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-310","depends_on_id":"mcpmail-98","type":"blocks","created_at":"2025-12-19T22:08:53.847496+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-310","depends_on_id":"mcpmail-252","type":"blocks","created_at":"2025-12-19T22:08:53.901327+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-311","title":"P0: Port ComposeMessage modal component","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:39.508884+05:30","updated_at":"2025-12-23T00:22:43.641027+05:30","closed_at":"2025-12-12T00:53:16.406505+05:30","dependencies":[{"issue_id":"mcpmail-311","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.445728+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-311","depends_on_id":"mcpmail-62","type":"blocks","created_at":"2025-12-11T23:40:25.636946+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-312","title":"P0: Create App router with 6 route skeletons","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:34.209864+05:30","updated_at":"2025-12-23T00:22:43.641336+05:30","closed_at":"2025-12-12T00:21:09.298266+05:30","dependencies":[{"issue_id":"mcpmail-312","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.170819+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-312","depends_on_id":"mcpmail-69","type":"blocks","created_at":"2025-12-11T23:40:25.324092+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-313","title":"CLI: Add 'guard status' command","description":"Port Python guard status command. Shows: WORKTREES_ENABLED, AGENT_MAIL_GUARD_MODE, PROJECT_IDENTITY_MODE, hooks_dir location, pre-commit/pre-push hook presence. See ${PYTHON_SRC}/src/mcp_agent_mail/cli.py lines 3033-3079.","notes":"Worker: Starting guard status command implementation","status":"closed","issue_type":"feature","created_at":"2025-12-21T22:31:50.365933+05:30","updated_at":"2025-12-23T00:22:43.641607+05:30","closed_at":"2025-12-22T00:56:39.695345+05:30"}
{"id":"mcpmail-314","title":"Phase 4: MCP Protocol Integration","description":"Integrate mcp-protocol-sdk crate. Expose API as MCP-compliant server. Tool registration and discovery. JSON-RPC 2.0 transport layer.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-09T01:40:02.857678+05:30","updated_at":"2025-12-23T00:22:43.641935+05:30","closed_at":"2025-12-09T05:29:47.989845+05:30"}
{"id":"mcpmail-315","title":"Epic: Production Hardening (PMAT Quality Gate)","description":"Production hardening based on PMAT analysis. Current scores: Repo Health 89/100 (A-), Rust Project Score 102/134 (76.1%, A+), Quality Gate FAILED (37 violations). Key issues: 144 unwrap() calls in production code, 1 CVE (RSA timing), 5 complexity hotspots \u003e10, test coverage at 65% (target 85%). Goal: Pass quality gate, eliminate crash risks, improve Rust score to 85%+.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-17T20:50:54.446547+05:30","updated_at":"2025-12-23T00:22:43.642141+05:30","dependencies":[{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-96","type":"blocks","created_at":"2025-12-17T20:53:48.155059+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-338","type":"blocks","created_at":"2025-12-17T20:53:48.248166+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-418","type":"blocks","created_at":"2025-12-17T20:53:48.372806+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-147","type":"blocks","created_at":"2025-12-17T20:53:48.488461+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-334","type":"blocks","created_at":"2025-12-17T20:53:48.583741+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-386","type":"blocks","created_at":"2025-12-17T20:53:48.674899+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-337","type":"blocks","created_at":"2025-12-17T20:53:48.764253+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-55","type":"blocks","created_at":"2025-12-17T20:53:48.856045+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-285","type":"blocks","created_at":"2025-12-17T20:53:48.941916+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-88","type":"blocks","created_at":"2025-12-17T20:53:49.031043+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-90","type":"blocks","created_at":"2025-12-17T20:53:49.190832+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-91","type":"blocks","created_at":"2025-12-17T20:53:49.291744+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-353","type":"blocks","created_at":"2025-12-19T19:03:53.177854+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-47","type":"blocks","created_at":"2025-12-19T19:03:53.224948+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-396","type":"blocks","created_at":"2025-12-19T19:03:53.271159+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-18","type":"blocks","created_at":"2025-12-19T19:03:53.316743+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-079d","type":"blocks","created_at":"2025-12-24T02:59:06.300934+05:30","created_by":"daemon"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-pnbk","type":"blocks","created_at":"2025-12-24T02:59:06.493771+05:30","created_by":"daemon"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-7c5x","type":"blocks","created_at":"2025-12-24T02:59:06.674709+05:30","created_by":"daemon"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-jegz","type":"blocks","created_at":"2025-12-24T02:59:06.858655+05:30","created_by":"daemon"},{"issue_id":"mcpmail-315","depends_on_id":"mcpmail-8yc8","type":"blocks","created_at":"2025-12-24T02:59:07.137486+05:30","created_by":"daemon"}]}
{"id":"mcpmail-316","title":"SVELTE-017: Add PWA support with @vite-pwa/sveltekit","description":"Make the SvelteKit app installable as a Progressive Web App for mobile-first experience.\n\n**Acceptance Criteria:**\n- [ ] Install @vite-pwa/sveltekit plugin\n- [ ] Configure manifest.json with Agent Mail branding (Indigo #6366f1 theme)\n- [ ] Add 192x192 and 512x512 maskable icons\n- [ ] Service worker with cache-first for assets, network-first for API\n- [ ] InstallPrompt.svelte component with platform detection (iOS instructions)\n- [ ] UpdatePrompt.svelte for SW updates\n- [ ] Lighthouse PWA audit passing (\u003e90 score)\n- [ ] Works offline with meaningful fallback\n\n**Design Spec (from mobile-frontend-design skill):**\n- display: standalone\n- orientation: portrait-primary\n- theme_color: #6366f1 (Indigo-500)\n- background_color: #ffffff\n\n**Reference Files:**\n- .tmp/skills/sveltekit-pwa-skills/resources/pwa-setup.md\n- .tmp/skills/mobile-frontend-design/resources/pwa-fundamentals.md\n\n**Dependencies:**\n- bun add -D @vite-pwa/sveltekit","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-22T05:54:10.430319+05:30","updated_at":"2025-12-23T21:12:56.352507+05:30","closed_at":"2025-12-23T21:12:56.352507+05:30","dependencies":[{"issue_id":"mcpmail-316","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:54:54.739968+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-316","depends_on_id":"mcpmail-36","type":"blocks","created_at":"2025-12-22T05:55:37.688189+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-317","title":"GAP: Share Preview Server (local HTTP viewer)","description":"## Problem\nPython has local preview server for exported bundles. Rust has no equivalent.\n\n## Python Command\n- `share preview --port 9000 --open-browser`\n- Serves exported HTML/JS bundle locally\n- Auto-opens browser\n\n## Implementation\n- Add share preview subcommand\n- Spawn axum server serving static files from bundle dir\n- Optional --open flag to launch browser","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T17:59:47.163917+05:30","updated_at":"2025-12-23T00:22:43.64278+05:30","closed_at":"2025-12-21T02:59:58.355138+05:30"}
{"id":"mcpmail-318","title":"Add stdio transport for Claude Desktop","description":"Implement stdio transport so MCP server can be used directly with Claude Desktop","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T04:45:23.306711+05:30","updated_at":"2025-12-23T00:22:43.642979+05:30","closed_at":"2025-12-09T05:29:25.193356+05:30","labels":["mcp","transport"]}
{"id":"mcpmail-319","title":"SVELTE-004: Create UnifiedInbox Svelte stores","description":"## Summary\nPort Python unifiedInboxManager() Alpine.js component to Svelte stores.\n\n## Implementation\n**File**: `src/lib/stores/unifiedInbox.ts`\n\n### State Stores (writable)\n```typescript\nexport const allMessages = writable\u003cMessage[]\u003e([]);\nexport const searchQuery = writable('');\nexport const showFilters = writable(false);\nexport const sortBy = writable\u003c'newest' | 'oldest' | 'sender' | 'longest'\u003e('newest');\nexport const viewMode = writable\u003c'split' | 'list'\u003e('split');\nexport const isFullscreen = writable(false);\nexport const selectedMessage = writable\u003cMessage | null\u003e(null);\nexport const selectedMessages = writable\u003cnumber[]\u003e([]);\nexport const filters = writable\u003cFilter\u003e({ project: '', sender: '', recipient: '', importance: '', hasThread: '' });\nexport const autoRefreshEnabled = writable(true);\nexport const isRefreshing = writable(false);\n```\n\n### Derived Stores\n```typescript\nexport const filteredMessages = derived(\n    [allMessages, searchQuery, filters, sortBy],\n    ([$messages, $query, $filters, $sort]) =\u003e {\n        // Filter by search, project, sender, recipient, importance, hasThread\n        // Sort by newest/oldest/sender/longest\n        return result;\n    }\n);\nexport const uniqueProjects = derived(allMessages, ...);\nexport const uniqueSenders = derived(allMessages, ...);\nexport const uniqueRecipients = derived(allMessages, ...);\nexport const filtersActive = derived(filters, ...);\n```\n\n### Actions\n```typescript\nexport function clearFilters() { ... }\nexport function toggleSelectAll() { ... }\nexport function selectNextMessage() { ... }  // j key\nexport function selectPreviousMessage() { ... }  // k key\n```\n\n## Reference Files\n- Python: mcp_agent_mail/templates/mail_unified_inbox.html (lines 1-100)\n- Pattern: Alpine.js x-data → Svelte stores\n\n## Acceptance Criteria\n- [ ] All 14 stores defined with correct types\n- [ ] filteredMessages derived store works with search/filter/sort\n- [ ] Unique* derived stores deduplicate correctly\n- [ ] Actions update stores correctly\n- [ ] TypeScript types exported\n\n## Quality Gates\n- bun run check (no TS errors)\n- Unit tests for derived store logic","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T05:35:03.574072+05:30","updated_at":"2025-12-23T00:22:43.64326+05:30","closed_at":"2025-12-22T23:33:31.909227+05:30","dependencies":[{"issue_id":"mcpmail-319","depends_on_id":"mcpmail-93","type":"blocks","created_at":"2025-12-22T05:40:11.527867+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-319","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:45.65618+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-32","title":"SVELTE-009: Port Magic UI components to Svelte","description":"## Summary\nPort Leptos Magic UI animated components to Svelte.\n\n## Components to Port\n1. **TypingText.svelte** - Typewriter effect\n2. **NumberCounter.svelte** - Animated number with tweened()\n3. **AnimatedGradient.svelte** - Shifting gradient background\n4. **ShimmerText.svelte** - Loading shimmer effect\n5. **GridPattern.svelte** - Background grid pattern\n6. **BlurFade.svelte** - Fade with blur animation\n\n## Implementation Example\n**File**: `src/lib/components/magic/NumberCounter.svelte`\n```svelte\n\u003cscript lang=\"ts\"\u003e\n    import { tweened } from 'svelte/motion';\n    import { cubicOut } from 'svelte/easing';\n    \n    export let value: number;\n    export let duration = 1000;\n    export let format = (n: number) =\u003e Math.round(n).toLocaleString();\n    \n    const displayed = tweened(0, { duration, easing: cubicOut });\n    $: displayed.set(value);\n\u003c/script\u003e\n\n\u003cspan class=\"tabular-nums\"\u003e{format($displayed)}\u003c/span\u003e\n```\n\n## Reference Files\n- Leptos: crates/services/web-ui-leptos/src/components/magic/\n- Svelte Motion: svelte/motion (tweened, spring)\n\n## Acceptance Criteria\n- [ ] All 6 components ported\n- [ ] Animations smooth (60fps)\n- [ ] SSR-safe (check browser before DOM APIs)\n- [ ] TypeScript props typed\n- [ ] Accessible (prefers-reduced-motion)\n\n## Quality Gates\n- bun run check passes\n- Visual regression tests","notes":"Completed: All 6 Magic UI components ported to Svelte. Files: src/lib/components/magic/{TypingText,NumberCounter,AnimatedGradient,ShimmerText,GridPattern,BlurFade}.svelte. TypeScript check passed. Build blocked by pre-existing mode-watcher/Vite 6 issue.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:38:57.523028+05:30","updated_at":"2025-12-23T00:22:43.555324+05:30","closed_at":"2025-12-22T22:51:33.336484+05:30","dependencies":[{"issue_id":"mcpmail-32","depends_on_id":"mcpmail-93","type":"blocks","created_at":"2025-12-22T05:40:37.250722+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-32","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:11.272604+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-320","title":"PORT: Query Locality \u0026 Resource Cleanup Tests (19 tests)","description":"## Description\nPort query locality and resource cleanup tests for database performance and reliability.\n\n## Query Locality Tests (9 tests)\n- test_thread_list_query_uses_indexes\n- test_get_thread_messages_all_query_uses_index\n- test_get_thread_messages_specific_thread_query_uses_index\n- test_fts_search_query_uses_fts_index\n- test_like_search_fallback_query_performance\n- test_get_message_detail_query_uses_primary_key\n- test_query_plan_dbstat_locality\n- test_query_plan_documentation\n- test_query_scalability_with_limits (parametrized)\n\n## Resource Cleanup Tests (10 tests)\n- test_git_repo_context_manager_normal_operation\n- test_git_repo_context_manager_closes_on_exception\n- test_git_repo_context_manager_handles_invalid_repo\n- test_open_repo_if_available_returns_none_for_non_repo\n- test_open_repo_if_available_returns_none_for_none\n- test_open_repo_if_available_returns_repo_for_valid_git\n- test_open_repo_if_available_closes_on_validation_failure\n- test_open_repo_if_available_closes_on_working_tree_exception\n- test_file_reservation_statuses_cleanup_on_exception\n- test_file_reservation_release_works\n\n## Reference\n- Python: tests/test_query_locality.py\n- Python: tests/test_resource_cleanup.py\n\n## Implementation Notes\n- EXPLAIN QUERY PLAN validation\n- Index usage verification\n- File handle leak prevention\n- Context manager cleanup on exception","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:58:54.084446+05:30","updated_at":"2025-12-23T00:22:43.643615+05:30","closed_at":"2025-12-20T06:32:34.644645+05:30"}
{"id":"mcpmail-321","title":"PORT-1.2: Implement production-grade input validation with actionable suggestions","description":"## Problem\nAI agents make input mistakes. Need clear, actionable error messages with suggestions.\n\n## Implementation\nCreate lib-core/src/utils/validation.rs with:\n- ValidationError enum with thiserror\n- validate_agent_name() - alphanumeric + underscore, 1-64 chars\n- validate_project_key() - absolute path or human_key\n- validate_reservation_path() - must be relative\n- validate_ttl() - 60s to 7 days range\n- All errors include: field, provided, reason, suggestion\n\n## Files\n- crates/libs/lib-core/src/error.rs\n- crates/libs/lib-core/src/utils/validation.rs (NEW)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/app.py\n- Commit cbd2f1f: feat(app): add comprehensive input validation\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: validation, InvalidInput)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 1.2)\n\n## NIST Control: SI-10 (Input Validation)\n\n## Acceptance Criteria\n- [ ] All MCP tools validate inputs before processing\n- [ ] Errors include: field, provided value, reason, suggestion\n- [ ] All validation errors marked recoverable: true\n- [ ] Suggestions are actionable (not just \"invalid\")\n- [ ] 100% test coverage on validation module\n- [ ] Integrated with tracing for audit log (AU-3)\n\n## Complexity: 7/10","notes":"SCAFFOLDING EXISTS (2025-12-19): validation.rs created with ValidationError enum, validate_agent_name(), validate_project_key(), validate_reservation_path(), validate_ttl() - all with tests. REMAINING: Integration into MCP tools and API handlers not done. Need to wire validation functions into lib-mcp/tools.rs and lib-server/api/ handlers.","status":"closed","issue_type":"task","created_at":"2025-12-18T00:24:26.120223+05:30","updated_at":"2025-12-23T00:22:43.643867+05:30","closed_at":"2025-12-19T06:33:33.064626+05:30"}
{"id":"mcpmail-322","title":"Workflow test: verify agent coordination","description":"**NO CODE CHANGES** - Pure workflow validation.\n\n**Test Steps:**\n1. Register agent via MCP `register_agent`\n2. Send [CLAIMING] message via `send_message`\n3. Reserve a dummy file via `file_reservation_paths`\n4. Check inbox via `check_inbox`\n5. Send [PROGRESS] message\n6. Release reservation via `release_reservation`\n7. Send [COMPLETION] message\n8. Close this bead\n\n**Success Criteria:**\n- All MCP tools respond correctly\n- Messages appear in inbox\n- File reservation acquired and released\n- No errors in workflow\n\n**Files to reserve (for test only):**\n- `docs/WORKFLOW_TEST.md` (does not need to exist)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T18:35:32.683413+05:30","updated_at":"2025-12-23T00:22:43.644136+05:30","closed_at":"2025-12-22T18:45:05.699122+05:30"}
{"id":"mcpmail-323","title":"GAP: Guard Status CLI Command","description":"## Problem\nPython has `guard status` to print hook installation state. Rust has no equivalent.\n\n## Python Command\n```\nmcp_agent_mail guard status\nInstalled hooks:\n  pre-commit: /path/to/repo/.git/hooks/pre-commit (mcp-agent-mail)\n  pre-push: not installed\n```\n\n## Implementation\n- Add guard status subcommand\n- Check .git/hooks for pre-commit and pre-push\n- Report installation state and version","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T18:00:10.904458+05:30","updated_at":"2025-12-23T00:22:43.64435+05:30","closed_at":"2025-12-19T21:27:46.14752+05:30"}
{"id":"mcpmail-324","title":"PORT: HTTP Transport \u0026 Redis Tests (15 infrastructure tests)","description":"## Description\nPort HTTP transport and Redis fallback tests for infrastructure resilience.\n\n## Test Files\n- test_http_transport.py (5 tests)\n- test_http_auth_rate_limit.py (1 test)\n- test_http_negative_jwt.py (4 tests)\n- test_http_redis_rate_limit.py (varies)\n- test_logging_and_redis_fallback.py (2 tests)\n\n## Key Test Areas\n\n### HTTP Transport\n- SSE connection handling\n- Streamable HTTP\n- Connection lifecycle\n- Error recovery\n\n### JWT Authentication\n- Valid JWT acceptance\n- Expired JWT rejection\n- Invalid signature rejection\n- Missing claims handling\n\n### Rate Limiting\n- Per-identity bucket keys\n- Per-tool rate limits\n- Redis-backed limiting\n- In-memory fallback\n\n### Logging\n- Structured logging\n- Error capture\n- Redis connection loss handling\n\n## Reference\n- Python: tests/test_http_*.py\n- Python: tests/test_logging_and_redis_fallback.py\n\n## Implementation Notes\n- Redis connection pool testing\n- Graceful degradation to in-memory\n- JWT RBAC integration\n- Per-tool rate limit config","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:58:33.72781+05:30","updated_at":"2025-12-23T00:22:43.644596+05:30","closed_at":"2025-12-20T06:51:42.570708+05:30"}
{"id":"mcpmail-325","title":"PORT-1.1: Consolidate summarize_thread tools into single unified tool","description":"## Problem\nTwo separate tools (summarize_thread, summarize_threads) create API redundancy.\n\n## Implementation\n- Merge into single tool accepting String or Vec\u003cString\u003e\n- Use #[serde(untagged)] enum for flexible input\n- Return SummarizeResult with summaries + optional errors\n- Partial failures don't break entire operation\n\n## Files\n- crates/libs/lib-mcp/src/tools.rs\n- crates/libs/lib-core/src/model/message.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/app.py\n- Commit f6c642c: perf(tools): consolidate summarize_thread and summarize_threads\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: summarize_thread)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 1.1)\n\n## Acceptance Criteria\n- [ ] Single tool accepts both String and Vec\u003cString\u003e\n- [ ] JSON schema validates both input types\n- [ ] Partial failures return errors array, don't panic\n- [ ] Backward compatible\n- [ ] Tests: test_summarize_single, test_summarize_multiple, test_partial_failure\n\n## Complexity: 6/10","status":"closed","issue_type":"task","created_at":"2025-12-18T00:24:10.848639+05:30","updated_at":"2025-12-23T00:22:43.644816+05:30","closed_at":"2025-12-18T09:31:57.192433+05:30"}
{"id":"mcpmail-326","title":"P1: Pre-register 5 built-in macros","description":"Pre-register 5 macros on first server start: macro_start_session (register+inbox), macro_prepare_thread (create+reserve), macro_file_reservation_cycle (reserve/work/release), macro_contact_handshake (cross-project), macro_broadcast_message (multi-recipient).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:54:32.69642+05:30","updated_at":"2025-12-23T00:22:43.645019+05:30","closed_at":"2025-12-15T20:44:23.420784+05:30","dependencies":[{"issue_id":"mcpmail-326","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:54:32.697165+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-327","title":"Add --with-ui/--no-ui CLI flags to mcp-agent-mail","description":"Update mcp-agent-mail CLI to support --with-ui and --no-ui flags for 'serve http' command. Default to UI enabled when feature compiled in.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T17:52:52.107239+05:30","updated_at":"2025-12-23T00:22:43.645249+05:30","closed_at":"2025-12-17T19:00:04.495041+05:30","dependencies":[{"issue_id":"mcpmail-327","depends_on_id":"mcpmail-151","type":"blocks","created_at":"2025-12-17T17:53:00.08312+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-328","title":"Add --robot-help flag to mcp-cli for AI discovery","description":"Implement self-documenting --robot-* flags for AI agent discovery.\n\n## Design Principles\n1. **Every flag/subcommand has examples** - No flag without documentation\n2. **Works with any flag or subcommand** - Dynamic discovery\n3. **Self-documenting** - Robot flags document themselves\n\n## CLI Interface\n\n```bash\n# Discovery\nam --robot-help                      # Full capability JSON\n\n# Examples for FLAGS\nam --robot-examples --port           # Examples of --port usage\nam --robot-examples --json           # Examples of --json usage\nam --robot-examples --format         # Examples of --format usage\n\n# Examples for SUBCOMMANDS  \nam --robot-examples serve            # Examples of 'serve' subcommand\nam --robot-examples serve http       # Examples of 'serve http'\nam --robot-examples archive save     # Examples of 'archive save'\n\n# Self-documenting (meta)\nam --robot-examples --robot-help     # How to use --robot-help\nam --robot-examples --robot-examples # How to use --robot-examples itself\n\n# Status\nam --robot-status                    # System health JSON\n```\n\n## Output Schema\n\n```json\n{\n  \"schema_version\": \"1.0.0\",\n  \"target\": \"--port\",\n  \"target_type\": \"flag\",\n  \"description\": \"Server port number\",\n  \"type\": \"u16\",\n  \"default\": \"8765\",\n  \"examples\": [\n    {\n      \"invocation\": \"am serve http --port 9000\",\n      \"description\": \"Start server on custom port\"\n    },\n    {\n      \"invocation\": \"am health --url http://localhost:9000\",\n      \"description\": \"Health check custom port\"\n    }\n  ]\n}\n```\n\n## Implementation Strategy\n1. Create ExampleRegistry with static data for ALL flags/subcommands\n2. Parse --robot-examples argument to detect what follows (flag vs subcommand)\n3. Lookup in registry, output JSON\n4. If flag/subcommand missing from registry = bug (fail-fast)\n\n## Recursion Safety\n- Data-driven: examples are static const data\n- No runtime computation for example lookup\n- `--robot-examples --robot-examples` just filters static data\n\n## Location\ncrates/services/mcp-agent-mail/src/main.rs\ncrates/services/mcp-agent-mail/src/robot_help.rs (new)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T08:27:34.98915+05:30","updated_at":"2025-12-23T00:22:43.645585+05:30","closed_at":"2025-12-21T23:50:45.699278+05:30"}
{"id":"mcpmail-329","title":"Add security headers (_headers file for static hosting)","description":"Create _headers file with CSP, X-Frame-Options, X-Content-Type-Options, Referrer-Policy for production builds. Since using adapter-static, headers must be configured via hosting platform.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T02:45:19.938927+05:30","updated_at":"2025-12-23T00:22:43.645861+05:30","closed_at":"2025-12-15T18:44:54.464287+05:30","dependencies":[{"issue_id":"mcpmail-329","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:19.939465+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-33","title":"T1: Core query list_pending_reviews() in MessageBmc","description":"Add list_pending_reviews() to MessageBmc with single SQL query returning all nested data. Includes: message fields, sender info, project context, thread count, recipients JSON array. Uses json_group_array for recipient aggregation. Complexity: 7/10. File: crates/libs/lib-core/src/model/message.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:55.358862+05:30","updated_at":"2025-12-23T00:22:43.555637+05:30","closed_at":"2025-12-18T18:35:40.655058+05:30"}
{"id":"mcpmail-330","title":"P1: Add test for outbox endpoint (35bb558)","description":"Outbox endpoint (35bb558) added /api/outbox but no test. Add test_list_outbox() to verify: messages sent BY agent appear in outbox, messages TO agent do NOT appear in outbox.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-12T17:59:02.638237+05:30","updated_at":"2025-12-23T00:22:43.646106+05:30","closed_at":"2025-12-15T19:59:16.514016+05:30","dependencies":[{"issue_id":"mcpmail-330","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T17:59:02.638861+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-331","title":"PORT-1.3: Implement agent mistake detection helpers with Levenshtein similarity","description":"## Problem\nAI agents make predictable mistakes. Proactive detection improves UX.\n\n## Implementation\nCreate lib-core/src/utils/mistake_detection.rs with:\n- detect_path_as_project_key() - relative path where absolute expected\n- detect_path_as_agent_name() - path chars in agent name\n- detect_id_confusion() - thread_id vs message_id\n- suggest_similar() - Levenshtein distance for entity suggestions\n- sanitize_agent_name() - cleanup for suggestions\n\n## Dependencies\n- Add strsim crate for Levenshtein distance\n\n## Files\n- crates/libs/lib-core/src/utils/mistake_detection.rs (NEW)\n- crates/libs/lib-core/Cargo.toml (add strsim)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/app.py\n- Commit 5b06416: feat(ux): add intelligent error handling for common agent mistakes\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: mistake, similar)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 1.3)\n\n## Acceptance Criteria\n- [ ] Detects 5+ common mistake patterns\n- [ ] Levenshtein similarity for entity suggestions (max_distance=3)\n- [ ] Confidence scores (0.0-1.0) for filtering\n- [ ] Integrated with validation error responses\n- [ ] Tests for each detection function\n\n## Complexity: 5/10","notes":"SCAFFOLDING EXISTS (2025-12-19): mistake_detection.rs created with MistakeSuggestion struct, detect_path_as_project_key(), detect_path_as_agent_name(), detect_id_confusion(), suggest_similar() using strsim crate - all with tests. REMAINING: Integration into error responses not done. Need to wire detection functions into lib-core/error.rs and API error handlers to provide suggestions.","status":"closed","issue_type":"task","created_at":"2025-12-18T00:24:39.468723+05:30","updated_at":"2025-12-23T00:22:43.646368+05:30","closed_at":"2025-12-19T06:43:13.454651+05:30"}
{"id":"mcpmail-332","title":"Add deny.toml for dependency policy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T16:41:39.457161+05:30","updated_at":"2025-12-23T00:22:43.646605+05:30","closed_at":"2025-12-17T16:49:04.037341+05:30"}
{"id":"mcpmail-333","title":"CLI: Add 'mail status' command","description":"Port Python mail status command. Shows: resolved project_key for a directory, registration status, active file reservations, product linkage. See ${PYTHON_SRC}/src/mcp_agent_mail/cli.py @mail_app.command('status').","notes":"Worker: Starting mail status command implementation","status":"closed","issue_type":"feature","created_at":"2025-12-21T22:31:52.694406+05:30","updated_at":"2025-12-23T00:22:43.646799+05:30","closed_at":"2025-12-22T01:57:15.300268+05:30"}
{"id":"mcpmail-334","title":"P2: Fix attachments.rs security - use user context instead of root","description":"File crates/libs/lib-server/src/api/attachments.rs:44 uses Ctx::root_ctx() instead of proper user context from request. This bypasses user-level authorization checks. Security impact: Any user can access any attachment. Fix: Extract user context from request auth, use for all attachment operations. Add test to verify user isolation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T20:52:23.651958+05:30","updated_at":"2025-12-23T00:22:43.647061+05:30","closed_at":"2025-12-17T23:41:34.349293+05:30"}
{"id":"mcpmail-335","title":"Single Binary Sidecar with Optional Embedded UI","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T17:52:31.988812+05:30","updated_at":"2025-12-23T00:22:43.647334+05:30","closed_at":"2025-12-17T19:02:11.441805+05:30"}
{"id":"mcpmail-336","title":"PORT-6.2: Improve installer with latest pull and server restart","description":"## Problem\nInstaller should update existing installations and handle running servers.\n\n## Implementation\n- Pull latest if repo exists\n- Stop existing server before starting new\n- Handle piped stdin (curl | bash)\n- Graceful error messages\n\n## Files\n- scripts/install.sh\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/scripts/install.sh\n- Commits: bb49ba4, b846430, dd1a63c\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: installer, pull, stop)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 6.2)\n\n## Acceptance Criteria\n- [ ] Pulls latest when repo exists\n- [ ] Stops existing server before start\n- [ ] Handles piped stdin (exec 0\u003c/dev/tty)\n- [ ] Graceful error messages\n\n## Complexity: 4/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:06.262284+05:30","updated_at":"2025-12-23T00:22:43.647549+05:30","closed_at":"2025-12-19T16:51:17.901233+05:30"}
{"id":"mcpmail-337","title":"P2: Address 6 dead code violations from PMAT quality gate","description":"PMAT quality-gate found 6 dead code violations. Run cargo +nightly udeps --workspace to identify unused dependencies. Remove or feature-gate unused code paths. Common causes: 1) Unused imports after refactoring, 2) Dead functions from removed features, 3) Unused pub exports. Each removal should have associated test verification.","notes":"No dead_code warnings from cargo/clippy - may be stale or dependency-related. Will revisit after other P2 tasks.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-17T20:52:31.144821+05:30","updated_at":"2025-12-23T21:20:27.799729+05:30","closed_at":"2025-12-23T21:20:27.799729+05:30"}
{"id":"mcpmail-338","title":"P0: Fix precommit_guard.rs unwrap() in async file ops","description":"File crates/libs/lib-core/src/model/precommit_guard.rs has 4 unwrap() calls in async file operations (line 39, 41, etc). These can crash when: 1) File permissions denied, 2) Disk full, 3) Path doesn't exist. Replace with ? operator and proper Result propagation. Also contains SATD: TODO at line 27 for API call implementation.","status":"closed","issue_type":"bug","created_at":"2025-12-17T20:51:37.494482+05:30","updated_at":"2025-12-23T00:22:43.648015+05:30","closed_at":"2025-12-17T20:58:22.220317+05:30"}
{"id":"mcpmail-339","title":"PORT-3.2: Add advisory and bypass modes to pre-commit guard","description":"## Problem\nNeed flexible guard modes: enforce (block), warn (advisory), bypass (skip).\n\n## Implementation\n- Add GuardMode enum: Enforce, Warn, Bypass\n- GuardMode::from_env() checking AGENT_MAIL_BYPASS, AGENT_MAIL_GUARD_MODE\n- Enforce: return Err on conflict\n- Warn: log warning, return Ok with warnings\n- Bypass: skip all checks\n\n## Files\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/guard.py\n- Commit 8fd0238: fix(guard): honor WORKTREES_ENABLED gate\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: AGENT_MAIL_BYPASS, warn)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 3.2)\n\n## Acceptance Criteria\n- [ ] AGENT_MAIL_BYPASS=1 skips all checks\n- [ ] AGENT_MAIL_GUARD_MODE=warn allows with warning\n- [ ] Default mode is enforce\n- [ ] Warning includes conflict details\n- [ ] Tests for each mode\n\n## Complexity: 4/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:26.138365+05:30","updated_at":"2025-12-23T00:22:43.648279+05:30","closed_at":"2025-12-19T06:00:35.430164+05:30"}
{"id":"mcpmail-34","title":"EPIC: P0 API - List Pending Reviews (Single-Call Complete Data)","status":"closed","issue_type":"epic","created_at":"2025-12-18T17:45:23.444339+05:30","updated_at":"2025-12-23T00:22:43.555937+05:30","closed_at":"2025-12-18T18:35:45.656635+05:30"}
{"id":"mcpmail-340","title":"Add integration tests for precommit guard MCP tools","description":"Add tests in lib-mcp/tests/ that verify:\n- install_precommit_guard appears in tools/list\n- install_precommit_guard tool call succeeds with valid params\n- uninstall_precommit_guard tool call succeeds","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:14.217589+05:30","updated_at":"2025-12-23T00:22:43.650022+05:30","closed_at":"2025-12-17T19:27:26.28642+05:30","dependencies":[{"issue_id":"mcpmail-340","depends_on_id":"mcpmail-305","type":"blocks","created_at":"2025-12-16T20:06:14.21829+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-341","title":"PORT-3.4: Support custom core.hooksPath in guard installation","description":"## Problem\nGuard installation should respect git's core.hooksPath configuration.\n\n## Implementation\n- get_hooks_dir() reading git config\n- Handle absolute paths directly\n- Resolve relative paths from repo root\n- Fallback to .git/hooks\n\n## Files\n- crates/libs/lib-core/src/model/precommit_guard.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/guard.py\n- Commit 733cfd3: test(guard): custom core.hooksPath tests\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: hooksPath)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 3.4)\n\n## Acceptance Criteria\n- [ ] Respects absolute core.hooksPath\n- [ ] Resolves relative paths from repo root\n- [ ] Falls back to .git/hooks\n- [ ] Tests with custom hooks path\n\n## Complexity: 3/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:26:26.265391+05:30","updated_at":"2025-12-23T00:22:43.650308+05:30","closed_at":"2025-12-19T15:44:15.953556+05:30"}
{"id":"mcpmail-342","title":"MCP Tools workflow test: verify tool calling","description":"**NO CODE CHANGES** - Test MCP tool calling workflow.\n\n**Test Steps (using MCP tools):**\n1. ensure_project\n2. register_agent\n3. send_message (to Coordinator)\n4. file_reservation_paths\n5. check_inbox\n6. release_reservation\n7. send_message [COMPLETION]\n8. bd close\n\n**Success Criteria:**\n- All MCP tools respond correctly\n- Messages delivered\n- Reservations work\n- No errors","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T19:02:26.452577+05:30","updated_at":"2025-12-23T00:22:43.650509+05:30","closed_at":"2025-12-22T19:11:36.447266+05:30"}
{"id":"mcpmail-343","title":"Fix unwrap() in export.rs (line 59)","description":"Replace Response::builder().unwrap() with expect() or error propagation. File: crates/libs/lib-server/src/api/export.rs:59","status":"closed","issue_type":"bug","created_at":"2025-12-17T15:03:35.092254+05:30","updated_at":"2025-12-23T00:22:43.650727+05:30","closed_at":"2025-12-17T16:38:59.019925+05:30","dependencies":[{"issue_id":"mcpmail-343","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:35.09264+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-344","title":"Update wasmtime in dev-dependencies","description":"jugar-probar uses wasmtime 29.0.1 with RUSTSEC-2025-0046 (Low) and RUSTSEC-2025-0118 (Low). Check if newer version available or if jugar-probar has update.","notes":"Starting work in worktree sandbox: .sandboxes/agent-wasmtime-fix","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-17T15:03:47.136907+05:30","updated_at":"2025-12-23T00:22:43.650956+05:30","closed_at":"2025-12-17T18:13:52.701012+05:30","dependencies":[{"issue_id":"mcpmail-344","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:47.137278+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-345","title":"Update Makefile: change web-ui to web-ui-leptos","description":"Makefile references SvelteKit (web-ui) but project uses Leptos (web-ui-leptos). Update build-web target to: cd crates/services/web-ui-leptos \u0026\u0026 trunk build --release","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T15:03:44.277395+05:30","updated_at":"2025-12-23T00:22:43.651196+05:30","closed_at":"2025-12-17T17:10:56.589252+05:30","dependencies":[{"issue_id":"mcpmail-345","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:44.277752+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-346","title":"Monitor RSA advisory RUSTSEC-2023-0071","description":"rsa 0.9.9 has Marvin Attack timing sidechannel (Medium severity). No fix available. Only in dev-deps for JWT testing. Monitor for upstream fix.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-17T15:03:49.894026+05:30","updated_at":"2025-12-23T00:22:43.651416+05:30","closed_at":"2025-12-17T18:20:59.243773+05:30","dependencies":[{"issue_id":"mcpmail-346","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:49.894404+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-347","title":"Update Makefile: add test-fast, coverage, audit targets","description":"Add missing targets to Makefile: test-fast (unit tests only), coverage (cargo llvm-cov), audit (cargo audit + deny), quality-gate (pmat). Required by pmat repo-score recommendations.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T15:03:42.064511+05:30","updated_at":"2025-12-23T00:22:43.651635+05:30","closed_at":"2025-12-17T17:10:57.5971+05:30","dependencies":[{"issue_id":"mcpmail-347","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:42.064962+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-348","title":"Fix unwrap() in ratelimit.rs (line 52)","description":"Replace NonZeroU32::new(100).unwrap() with const or expect(). pmat flagged as critical defect. File: crates/libs/lib-server/src/ratelimit.rs:52","status":"closed","issue_type":"bug","created_at":"2025-12-17T15:03:33.508613+05:30","updated_at":"2025-12-23T00:22:43.651853+05:30","closed_at":"2025-12-17T16:39:00.946458+05:30","dependencies":[{"issue_id":"mcpmail-348","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:33.509033+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-349","title":"Fix unwrap() in attachments.rs (line 158)","description":"Replace Response::builder().unwrap() with expect() or error propagation. File: crates/libs/lib-server/src/api/attachments.rs:158","status":"closed","issue_type":"bug","created_at":"2025-12-17T15:03:36.357333+05:30","updated_at":"2025-12-23T00:22:43.652088+05:30","closed_at":"2025-12-17T16:38:57.54933+05:30","dependencies":[{"issue_id":"mcpmail-349","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:36.357724+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-35","title":"P0: Multi-Agent Orchestration System","description":"## Overview\nImplement the multi-agent orchestration workflow defined in AGENTS.md Layer 5.\n\n## Components\n\n### 1. Agent Registration \u0026 Discovery\n- Worker, Reviewer, Human agent registration\n- Agent capability tracking\n- Presence detection (is reviewer available?)\n\n### 2. Message Protocol Implementation\n- [TASK_STARTED] notification\n- [COMPLETION] report format\n- [APPROVED] / [FIXED] review results\n- Thread conventions (TASK-\u003cid\u003e, REVIEW-\u003cdate\u003e, ESCALATE-\u003cid\u003e)\n\n### 3. Git Worktree Integration\n- Worker worktree: .sandboxes/worker-\u003ctask-id\u003e\n- Reviewer fix worktree: .sandboxes/reviewer-fix-\u003ctask-id\u003e\n- Automated merge and cleanup\n\n### 4. Quality Gate Automation\n- Pre-commit validation\n- Completion report generation\n- Gate failure handling\n\n### 5. Single-Agent Fallback\n- Detect missing reviewer\n- Self-review workflow\n- Direct-to-human notification\n\n### 6. Error Recovery\n- Crash recovery\n- Merge conflict resolution\n- Message retry with backoff\n\n## Reference\n- AGENTS.md Layer 5: Multi-Agent Orchestration\n- MCP Agent Mail tools (45 total)\n\n## Acceptance Criteria\n- [ ] Worker can claim task, implement, send completion mail\n- [ ] Reviewer can validate, fix if needed, notify human\n- [ ] Single-agent fallback works when no reviewer\n- [ ] Quality gates enforced at all stages\n- [ ] Error recovery handles crashes and conflicts\n- [ ] Metrics tracked via list_tool_metrics()","status":"closed","issue_type":"epic","created_at":"2025-12-18T01:47:45.522975+05:30","updated_at":"2025-12-23T00:22:43.556212+05:30","closed_at":"2025-12-20T03:46:42.247077+05:30"}
{"id":"mcpmail-350","title":"Add .pmat-gates.toml configuration","description":"Create .pmat-gates.toml with: tdg_min_grade=B, max_critical_defects=0, max_unwrap_in_src=0, coverage_min=70. Ignore paths: target/, tests/, .sandboxes/","status":"closed","issue_type":"task","created_at":"2025-12-17T15:03:39.186582+05:30","updated_at":"2025-12-23T00:22:43.652325+05:30","closed_at":"2025-12-17T16:39:01.207888+05:30","dependencies":[{"issue_id":"mcpmail-350","depends_on_id":"mcpmail-351","type":"parent-child","created_at":"2025-12-17T15:03:39.186982+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-351","title":"GitHub Binary Release v0.1.0","description":"Epic for releasing mcp-agent-mail as GitHub binary. Includes security fixes, Makefile updates, CI improvements, and release workflow enhancements. Based on pmat analysis (TDG: 95.8/100 A+, Repo Score: 76.5/100 B)","status":"closed","issue_type":"epic","created_at":"2025-12-17T15:03:23.831435+05:30","updated_at":"2025-12-23T00:22:43.652547+05:30","closed_at":"2025-12-17T18:20:59.406166+05:30"}
{"id":"mcpmail-352","title":"Rename InfoBanner to Alert with AlertTitle/AlertDescription compound pattern","description":"## Summary\nRename InfoBanner to Alert following shadcn naming, add AlertTitle and AlertDescription compound components.\n\n## Implementation Details\n\n### 1. Rename file\n- info_banner.rs → alert.rs\n\n### 2. Refactor to compound pattern\n```rust\nuse leptos::*;\nuse tailwind_fuse::*;\n\nconst ALERT_BASE: \u0026str = \"relative w-full rounded-lg border p-4 [\u0026\u003esvg~*]:pl-7 [\u0026\u003esvg+div]:translate-y-[-3px] [\u0026\u003esvg]:absolute [\u0026\u003esvg]:left-4 [\u0026\u003esvg]:top-4 [\u0026\u003esvg]:text-foreground\";\nconst TITLE_CLASS: \u0026str = \"mb-1 font-medium leading-none tracking-tight\";\nconst DESCRIPTION_CLASS: \u0026str = \"text-sm [\u0026_p]:leading-relaxed\";\n\n#[derive(TwVariant, Clone, Copy, Default)]\npub enum AlertVariant {\n    #[tw(default, class = \"bg-background text-foreground\")]\n    Default,\n    #[tw(class = \"border-destructive/50 text-destructive dark:border-destructive [\u0026\u003esvg]:text-destructive\")]\n    Destructive,\n    #[tw(class = \"border-emerald-500/50 text-emerald-600 [\u0026\u003esvg]:text-emerald-600\")]\n    Success,\n    #[tw(class = \"border-amber-500/50 text-amber-600 [\u0026\u003esvg]:text-amber-600\")]\n    Warning,\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/info_banner.rs → alert.rs\n- crates/services/web-ui-leptos/src/components/mod.rs\n- All files importing InfoBanner\n\n## Acceptance Criteria\n- [ ] InfoBanner renamed to Alert\n- [ ] AlertTitle and AlertDescription compound components added\n- [ ] Alert has role=\"alert\" attribute\n- [ ] 4 variants: Default, Destructive, Success, Warning\n- [ ] Icon positioning classes ([\u0026\u003esvg]) applied\n- [ ] All existing usages updated\n- [ ] No broken imports","notes":"Claimed by worker-06ls","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T23:11:53.367457+05:30","updated_at":"2025-12-23T00:22:43.652883+05:30","closed_at":"2025-12-19T00:59:20.979205+05:30","dependencies":[{"issue_id":"mcpmail-352","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:41.159364+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-353","title":"P1: Add HSTS security header (Strict-Transport-Security)","description":"## Summary\nAdd HSTS header to lib-server security middleware.\n\n## Implementation\n```rust\n.layer(SetResponseHeaderLayer::overriding(\n    HeaderName::from_static(\"strict-transport-security\"),\n    HeaderValue::from_static(\"max-age=31536000; includeSubDomains\"),\n))\n```\n\n## Location\ncrates/libs/lib-server/src/lib.rs lines 125-139 (existing security headers)\n\n## Acceptance Criteria\n- [ ] HSTS header added with max-age=31536000\n- [ ] includeSubDomains directive included\n- [ ] cargo test passes\n- [ ] Verify header with curl -I\n\n## Reference\nproduction-hardening-backend skill: OWASP Security Headers","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T19:03:34.945343+05:30","updated_at":"2025-12-23T00:22:43.653131+05:30","closed_at":"2025-12-20T04:21:22.878425+05:30"}
{"id":"mcpmail-354","title":"PORT: Archive Browser Web UI Routes (7 routes)","description":"## Description\nPort the Python archive browser web UI routes that provide visualization and exploration of git archive history.\n\n## Missing Routes\n\n1. `/mail/archive/guide` - Archive usage guide HTML\n2. `/mail/archive/activity` - Activity timeline HTML\n3. `/mail/archive/commit/{sha}` - Commit detail HTML\n4. `/mail/archive/timeline` - Visual timeline HTML\n5. `/mail/archive/browser` - File browser HTML\n6. `/mail/archive/browser/{project}/file` - File content view\n7. `/mail/archive/network` - Git network graph HTML\n8. `/mail/archive/time-travel` - Time travel UI\n9. `/mail/archive/time-travel/snapshot` - Snapshot at point in time\n\n## Reference\n- Python: mcp_agent_mail/src/mcp_agent_mail/http.py\n- Lines 2436-2723\n\n## Implementation Notes\n- All HTML routes use Jinja2 templates in Python\n- Rust may use Askama, Tera, or HTMX for templating\n- Consider using existing Leptos WASM frontend patterns\n- Lower priority than core API functionality","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:51:40.404417+05:30","updated_at":"2025-12-23T00:22:43.653435+05:30","closed_at":"2025-12-21T08:12:42.426245+05:30"}
{"id":"mcpmail-355","title":"Epic: Workflow Macros Completion - Missing Convenience Tools","description":"Workflow macros are partially implemented. The REST API has list_macros, register_macro, unregister_macro, and invoke_macro. MCP has schemas but needs additional convenience tools.\n\nCurrent State:\n- REST: All 4 macro endpoints work\n- MCP: list_macros, register_macro, invoke_macro schemas defined\n- MCP: Tool implementations need verification\n- Missing: Batch operations, macro templates, quick-workflow tools\n\nRequired Additions:\n1. Verify MCP macro tools work end-to-end (tool_router registration)\n2. Add batch_invoke_macro for running multiple macros in sequence\n3. Add workflow templates (common patterns like 'code-review', 'deploy-check')\n4. Add list_builtin_macros to show pre-defined workflows\n5. Add macro validation before registration\n\nConvenience Tools (Python Parity):\n- quick_standup_workflow: Broadcasts standup request to all agents\n- quick_handoff_workflow: Facilitates task handoff between agents\n- quick_review_workflow: Initiates code review flow\n\nAcceptance Criteria:\n- All macro MCP tools callable via tools/call\n- Batch operations work atomically\n- Built-in workflow templates available","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-16T20:06:29.764539+05:30","updated_at":"2025-12-23T00:22:43.653653+05:30","closed_at":"2025-12-17T20:31:40.188858+05:30"}
{"id":"mcpmail-356","title":"P0: Implement Dashboard E2E tests (D-001 to D-007)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:20.124906+05:30","updated_at":"2025-12-23T00:22:43.653951+05:30","closed_at":"2025-12-15T18:44:26.878426+05:30","dependencies":[{"issue_id":"mcpmail-356","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:00.867573+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-356","depends_on_id":"mcpmail-75","type":"blocks","created_at":"2025-12-11T23:34:23.969589+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-357","title":"Add quick_handoff_workflow convenience tool","description":"Add MCP tool that facilitates task handoff between agents:\n- QuickHandoffParams { project_slug, from_agent, to_agent, task_summary, file_paths?: Vec\u003cString\u003e }\n- Sends handoff message with context\n- Optionally transfers file reservations\n- Returns handoff confirmation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:58.124085+05:30","updated_at":"2025-12-23T00:22:43.654203+05:30","closed_at":"2025-12-17T20:29:05.526193+05:30","dependencies":[{"issue_id":"mcpmail-357","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:58.124753+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-358","title":"Upgrade Select component with CVA variants, full ARIA, and keyboard navigation","description":"## Summary\nMajor refactor of Select component to use tailwind_fuse, add missing ARIA attributes, and implement full keyboard navigation.\n\n## Implementation Details\n\n### Required Changes to select.rs\n\n1. **Convert to tailwind_fuse**\n   - Replace format!() class concatenation with tw_merge!\n   - Add SelectSize variant enum\n\n2. **Add Missing ARIA Attributes**\n   - aria-controls linking trigger to listbox\n   - aria-activedescendant for focused option\n   - aria-haspopup=\"listbox\"\n   - Unique IDs for listbox and options\n\n3. **Add Keyboard Navigation**\n   - Home/End keys to jump to first/last option\n   - Type-ahead search (first matching option)\n   - Escape to close\n\n4. **Use Semantic Colors**\n   - Replace amber-400, charcoal-800 with bg-popover, text-popover-foreground\n\n### Target Classes (from shadcn)\nTrigger: flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm focus:ring-2 focus:ring-ring\nContent: relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/select.rs\n\n## Acceptance Criteria\n- [ ] Uses tailwind_fuse for class merging\n- [ ] aria-controls links trigger to listbox with matching ID\n- [ ] aria-activedescendant updates on arrow key navigation\n- [ ] Home key selects first option\n- [ ] End key selects last option\n- [ ] Type-ahead: typing 'a' focuses first option starting with 'a'\n- [ ] Escape key closes dropdown\n- [ ] Uses bg-popover instead of project-specific colors\n- [ ] Focus ring visible on trigger\n- [ ] All options have unique IDs","notes":"Claimed by worker-7rv3","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T23:11:52.92012+05:30","updated_at":"2025-12-23T00:22:43.654476+05:30","closed_at":"2025-12-19T00:47:02.436366+05:30","dependencies":[{"issue_id":"mcpmail-358","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:41.068459+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-359","title":"T6: Integration tests for list_pending_reviews","description":"TDD tests: empty when all acked, includes partial ack, full context present, filter by project, filter by sender, limit clamped. Complexity: 6/10. File: crates/libs/lib-core/tests/message_tests.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:56.68488+05:30","updated_at":"2025-12-23T00:22:43.654711+05:30","closed_at":"2025-12-19T05:35:27.033327+05:30","dependencies":[{"issue_id":"mcpmail-359","depends_on_id":"mcpmail-29","type":"blocks","created_at":"2025-12-18T17:46:09.608497+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-36","title":"SVELTE-011: Build integration and scripts","description":"## Summary\nCreate build scripts for SvelteKit → Rust embedding workflow.\n\n## Implementation\n**File**: `scripts/build-web-ui.sh`\n```bash\n#\\!/bin/bash\nset -e\ncd crates/services/web-ui\nbun install\nbun run build\n# Verify output\n[ -f build/index.html ] || exit 1\necho \"Build complete: $(du -sh build/)\"\n```\n\n**File**: `Makefile` (optional)\n```makefile\n.PHONY: web-ui\nweb-ui:\n    ./scripts/build-web-ui.sh\n\n.PHONY: release\nrelease: web-ui\n    cargo build -p mcp-agent-mail --release --features with-web-ui\n```\n\n## Reference Files\n- Current: crates/services/web-ui-leptos/Trunk.toml\n- Target: crates/services/web-ui/package.json\n\n## Acceptance Criteria\n- [ ] `./scripts/build-web-ui.sh` builds successfully\n- [ ] Output verified (index.html exists)\n- [ ] Cargo build with embedded UI works\n- [ ] Binary size reasonable (\u003c 15MB)\n- [ ] CI integration documented\n\n## Quality Gates\n- Script is idempotent\n- Exit codes correct for CI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:39:28.168221+05:30","updated_at":"2025-12-23T00:22:43.556499+05:30","closed_at":"2025-12-23T00:18:30.616522+05:30","dependencies":[{"issue_id":"mcpmail-36","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:40:47.514093+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-36","depends_on_id":"mcpmail-100","type":"blocks","created_at":"2025-12-22T05:40:52.650091+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-36","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:21.55447+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-360","title":"Verify MCP macro tools (list_macros, invoke_macro, register_macro) work end-to-end","description":"Audit lib-mcp/src/tools.rs to verify:\n1. Macro tool handlers are properly registered in tool_router\n2. list_macros returns macros from MacroDefBmc\n3. invoke_macro executes macro steps and returns results\n4. register_macro creates custom macros in DB\nAdd integration tests if missing.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:56.857595+05:30","updated_at":"2025-12-23T00:22:43.654956+05:30","closed_at":"2025-12-17T20:15:36.366574+05:30","dependencies":[{"issue_id":"mcpmail-360","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:56.859055+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-361","title":"Generate JSON schemas for tool arguments","description":"Use schemars to auto-generate JSON schemas for all tool input types","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T04:45:24.292545+05:30","updated_at":"2025-12-23T00:22:43.655205+05:30","closed_at":"2025-12-09T05:45:50.815856+05:30","labels":["mcp","schema"]}
{"id":"mcpmail-362","title":"LEPTOS-003: Mark-Read UI Button","description":"## Summary\nAdd mark-read toggle button to MessageDetail. API `/api/message/read` already exists.\n\n## Implementation\nLocation: `components/message_detail.rs`\n\n```rust\n// Toggle button with optimistic update\nview! {\n    \u003cbutton\n        class=tw_merge!(btn_class, \"h-10 w-10\")\n        on:click=toggle_read_status\n        aria-pressed=is_read\n        aria-label=if is_read { \"Mark as unread\" } else { \"Mark as read\" }\n    \u003e\n        \u003cIcon icon=if is_read { \"eye-off\" } else { \"eye\" } /\u003e\n    \u003c/button\u003e\n}\n```\n\n## Acceptance Criteria\n- [ ] Toggle button in MessageDetail header (eye/eye-off icon)\n- [ ] Button \u003e= 44x44px touch target\n- [ ] Calls POST /api/message/{id}/read endpoint\n- [ ] Optimistic UI update (immediate visual feedback)\n- [ ] Error toast on API failure with retry option\n- [ ] Keyboard accessible (Enter/Space activates)\n- [ ] aria-pressed attribute reflects state\n- [ ] Visual state: read (muted) vs unread (bold)\n\n## Quality Gates\n- cargo clippy -- -D warnings\n- Visual regression screenshot added\n- VoiceOver announces state change\n\n## Reference Skills\n- shadcn-ui: Button variants, focus ring\n- mobile-frontend-design: 44px touch targets\n- kaizen-solaris-review: Error handling with Result","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T22:03:36.730264+05:30","updated_at":"2025-12-23T00:22:43.655449+05:30","closed_at":"2025-12-20T01:50:28.245551+05:30","dependencies":[{"issue_id":"mcpmail-362","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:10.653804+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-362","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:10.707607+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-363","title":"Create Skeleton loading component","description":"## Summary\nCreate a Skeleton component for loading state placeholders.\n\n## Implementation Details\n\n### Create components/skeleton.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::tw_merge;\n\nconst SKELETON_CLASS: \u0026str = \"animate-pulse rounded-md bg-muted\";\n\n#[component]\npub fn Skeleton(\n    #[prop(optional, into)] class: MaybeProp\u003cString\u003e,\n) -\u003e impl IntoView {\n    view! {\n        \u003cdiv class=tw_merge!(SKELETON_CLASS, class.get()) /\u003e\n    }\n}\n```\n\n### Usage Example\n```rust\n// Card skeleton\nview! {\n    \u003cCard\u003e\n        \u003cCardHeader\u003e\n            \u003cSkeleton class=\"h-4 w-[250px]\" /\u003e\n            \u003cSkeleton class=\"h-4 w-[200px]\" /\u003e\n        \u003c/CardHeader\u003e\n        \u003cCardContent\u003e\n            \u003cSkeleton class=\"h-[125px] w-full\" /\u003e\n        \u003c/CardContent\u003e\n    \u003c/Card\u003e\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/skeleton.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Skeleton component created\n- [ ] Uses animate-pulse for loading animation\n- [ ] Uses bg-muted semantic color\n- [ ] Respects prefers-reduced-motion\n- [ ] Component exported from mod.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:12:31.34391+05:30","updated_at":"2025-12-23T00:22:43.655761+05:30","closed_at":"2025-12-19T01:06:24.990918+05:30","dependencies":[{"issue_id":"mcpmail-363","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:46.781625+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-364","title":"Create static_files.rs handler for SPA routing","description":"Create lib-server/src/static_files.rs with serve_embedded_file() handler. Support SPA routing (fallback to index.html) and proper MIME types.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T17:52:51.689483+05:30","updated_at":"2025-12-23T00:22:43.656007+05:30","closed_at":"2025-12-17T18:56:51.102263+05:30","dependencies":[{"issue_id":"mcpmail-364","depends_on_id":"mcpmail-372","type":"blocks","created_at":"2025-12-17T17:52:59.952018+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-365","title":"PORT: File Locks API Endpoint (/mail/api/locks)","description":"## Description\nPort the file locks JSON API endpoint from Python.\n\n## Missing Endpoint\n`GET /mail/api/locks` - Returns JSON list of all active file reservations across projects.\n\n## Python Implementation\n- Returns all active file reservations\n- Used by web UI to display lock status\n- Aggregates across all projects\n\n## Reference\n- Python: mcp_agent_mail/src/mcp_agent_mail/http.py line 1136\n\n## Implementation Notes\n- Simple GET endpoint returning JSON\n- Can leverage existing list_file_reservations logic\n- Lower priority - mainly for web UI dashboard","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T00:51:40.630777+05:30","updated_at":"2025-12-23T00:22:43.65629+05:30","closed_at":"2025-12-21T07:58:01.90411+05:30"}
{"id":"mcpmail-366","title":"PORT-1.4: Conditional build slot tool registration based on WORKTREES_ENABLED","description":"## Problem\nBuild slot tools should only register when WORKTREES_ENABLED=true.\n\n## Implementation\n- Add McpConfig struct with worktrees_enabled, git_identity_enabled\n- parse_bool_env() for truthy values: 1, true, yes, t, y (case-insensitive)\n- Conditionally register acquire/renew/release_build_slot\n- Log which mode is active at startup\n\n## Files\n- crates/libs/lib-common/src/config.rs\n- crates/libs/lib-mcp/src/lib.rs\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/src/mcp_agent_mail/app.py\n- Commit d13ea8f: perf(tools): conditionally register build slot tools\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: WORKTREES_ENABLED)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 1.4)\n\n## Acceptance Criteria\n- [ ] Build slot tools only in tools/list when WORKTREES_ENABLED=true\n- [ ] GIT_IDENTITY_ENABLED as alternative gate\n- [ ] Truthy: \"1\", \"true\", \"yes\", \"t\", \"y\" (case-insensitive)\n- [ ] Startup log indicates mode\n- [ ] Tests verify conditional registration\n\n## Complexity: 3/10","status":"closed","issue_type":"task","created_at":"2025-12-18T00:24:51.8991+05:30","updated_at":"2025-12-23T00:22:43.656548+05:30","closed_at":"2025-12-19T06:22:07.144826+05:30"}
{"id":"mcpmail-367","title":"Create mcp-stdio binary","description":"New binary crate that runs the MCP server over stdio for Claude Desktop integration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T04:45:23.61322+05:30","updated_at":"2025-12-23T00:22:43.656756+05:30","closed_at":"2025-12-09T05:29:25.652614+05:30","labels":["binary","mcp"]}
{"id":"mcpmail-368","title":"P1: Implement Message Detail E2E tests (M-001 to M-007)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T23:33:39.116277+05:30","updated_at":"2025-12-23T00:22:43.656958+05:30","closed_at":"2025-12-15T18:44:27.175875+05:30","dependencies":[{"issue_id":"mcpmail-368","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:13.221713+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-369","title":"LEPTOS-008: Fix Message Recipients Display","description":"## Summary\nRecipients are hardcoded in MessageDetail:133. Fix to display actual message recipients from API response.\n\n## Problem\nFile: `components/message_detail.rs:133`\nCurrent: Hardcoded recipient display\nExpected: Parse recipients from message API response\n\n## Acceptance Criteria\n- [ ] Parse `recipients` field from message API response\n- [ ] Display as comma-separated list with avatars\n- [ ] Show \"+N more\" if \u003e 3 recipients\n- [ ] Expandable to full list on click\n- [ ] Handle empty recipients gracefully\n- [ ] Handle null/undefined gracefully\n\n## Quality Gates\n- No hardcoded strings remaining\n- Visual regression test added\n- cargo clippy -- -D warnings\n\n## Reference Skills\n- rust-skills: Option handling, no unwrap\n- shadcn-ui: Avatar component","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-19T22:04:29.255749+05:30","updated_at":"2025-12-23T00:22:43.657224+05:30","closed_at":"2025-12-20T03:33:31.051949+05:30"}
{"id":"mcpmail-3698","title":"Add sorting controls to project and agent list views","description":"## Overview\nAdd sortable column headers to project and agent list views, enabling users to organize items by name, date, or activity.\n\n## TDD Acceptance Criteria\n\n### RED Phase - Failing Tests First\n\n```typescript\n// tests/e2e/sorting.spec.ts\nimport { test, expect } from \"@playwright/test\";\n\ntest.describe(\"List Sorting\", () =\u003e {\n  test(\"projects list has sortable column headers\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    // Sort controls should exist\n    const sortByName = page.getByRole(\"button\", { name: /sort by name/i });\n    const sortByDate = page.getByRole(\"button\", { name: /sort by date/i });\n    \n    await expect(sortByName).toBeVisible();\n    await expect(sortByDate).toBeVisible();\n  });\n\n  test(\"clicking sort header changes sort direction\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    const sortByName = page.getByRole(\"button\", { name: /sort by name/i });\n    \n    // Click to sort ascending\n    await sortByName.click();\n    await expect(sortByName).toHaveAttribute(\"aria-sort\", \"ascending\");\n    \n    // Click again for descending\n    await sortByName.click();\n    await expect(sortByName).toHaveAttribute(\"aria-sort\", \"descending\");\n  });\n\n  test(\"sort preference persists in URL\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    await page.getByRole(\"button\", { name: /sort by name/i }).click();\n    \n    // URL should reflect sort state\n    await expect(page).toHaveURL(/sort=name/);\n    await expect(page).toHaveURL(/order=asc/);\n  });\n\n  test(\"agents list supports sorting by last active\", async ({ page }) =\u003e {\n    await page.goto(\"/projects/test-project\");\n    \n    const sortByActivity = page.getByRole(\"button\", { name: /sort by activity/i });\n    await expect(sortByActivity).toBeVisible();\n    \n    await sortByActivity.click();\n    await expect(sortByActivity).toHaveAttribute(\"aria-sort\", \"descending\");\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n```svelte\n\u003c!-- lib/components/SortableHeader.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { page } from \"$app/stores\";\n  import { goto } from \"$app/navigation\";\n  import ArrowUp from \"lucide-svelte/icons/arrow-up\";\n  import ArrowDown from \"lucide-svelte/icons/arrow-down\";\n  import ArrowUpDown from \"lucide-svelte/icons/arrow-up-down\";\n\n  interface Props {\n    field: string;\n    label: string;\n  }\n\n  let { field, label }: Props = $props();\n\n  let currentSort = $derived($page.url.searchParams.get(\"sort\"));\n  let currentOrder = $derived($page.url.searchParams.get(\"order\") || \"asc\");\n  let isActive = $derived(currentSort === field);\n  let ariaSort = $derived(\n    isActive ? (currentOrder === \"asc\" ? \"ascending\" : \"descending\") : \"none\"\n  );\n\n  function toggleSort() {\n    const url = new URL($page.url);\n    if (currentSort === field) {\n      url.searchParams.set(\"order\", currentOrder === \"asc\" ? \"desc\" : \"asc\");\n    } else {\n      url.searchParams.set(\"sort\", field);\n      url.searchParams.set(\"order\", \"asc\");\n    }\n    goto(url.toString(), { replaceState: true });\n  }\n\u003c/script\u003e\n\n\u003cbutton\n  type=\"button\"\n  onclick={toggleSort}\n  aria-sort={ariaSort}\n  class=\"flex items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\"\n\u003e\n  {label}\n  {#if isActive}\n    {#if currentOrder === \"asc\"}\n      \u003cArrowUp class=\"h-4 w-4\" /\u003e\n    {:else}\n      \u003cArrowDown class=\"h-4 w-4\" /\u003e\n    {/if}\n  {:else}\n    \u003cArrowUpDown class=\"h-4 w-4 opacity-50\" /\u003e\n  {/if}\n\u003c/button\u003e\n```\n\n### REFACTOR Phase\n- Extract sorting logic into reusable hook\n- Add keyboard navigation (Enter/Space to toggle)\n- Persist sort preference to localStorage\n- Add visual indicator for default sort\n\n## Files to Modify\n- `web-ui/src/lib/components/SortableHeader.svelte` (new)\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/projects/[slug]/+page.svelte`\n\n## Definition of Done\n- [ ] All Playwright tests pass\n- [ ] Sort controls have proper ARIA attributes\n- [ ] Sort state persists in URL query params\n- [ ] Works on mobile (touch-friendly targets)\n- [ ] Keyboard accessible","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T05:12:54.584967+05:30","updated_at":"2025-12-24T05:12:54.584967+05:30"}
{"id":"mcpmail-37","title":"SVELTE-014: Implement Tutorial/Onboarding Modal","description":"Progressive disclosure onboarding for new users. Gradient header modal with step indicators.\n\n**Acceptance Criteria:**\n- [ ] Modal with gradient header (Purple → Indigo → Pink)\n- [ ] Step indicators (dots or numbers)\n- [ ] Next/Back navigation\n- [ ] Steps: Welcome, Keyboard shortcuts, Filters, Auto-refresh\n- [ ] localStorage persistence for 'seen' state\n- [ ] Trigger: First visit or via help menu\n\n**Design Spec:**\n- Gradient: from-purple-600 via-indigo-500 to-pink-500\n- Step indicators at bottom\n- Smooth transitions between steps\n\n**Reference Files:**\n- Codex plan Phase 3A: 'Tutorial modal with gradient header'","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:51:13.634688+05:30","updated_at":"2025-12-23T21:15:46.777578+05:30","closed_at":"2025-12-23T21:15:46.777578+05:30","dependencies":[{"issue_id":"mcpmail-37","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:51:46.03018+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-37","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:52:18.841224+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-370","title":"Epic: Python Port v2 - Feature Parity from f2b563d","description":"## Overview\nPort Python mcp_agent_mail changes since commit f2b563dad55aa03fcb2a3563b773089f6f03ef50 to Rust.\n\n## Scope\n- 40 commits, ~3000 LoC changes\n- Tool consolidation \u0026 input validation (P0)\n- Storage robustness with LRU cache (P0)\n- Guard/worktree support (P1)\n- HTTP/rate limiting fixes (P1)\n- CLI enhancements (P1)\n- FTS improvements (P2)\n\n## Reference Documentation\n- **Python Tree**: docs/mcp-agent-mail-python-tree.md\n- **Python Diff**: docs/mcp-agent-mail-python-beads-diff.md\n- **Python Source**: /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail\n- **Port Plan**: docs/PYTHON_PORT_PLAN_v2.md\n\n## Quality Gates (per task)\n- cargo check \u0026\u0026 cargo fmt --check \u0026\u0026 cargo clippy -- -D warnings\n- cargo test with \u003e= 85% coverage\n- pmat analyze tdg --min-grade B\n\n## NIST SP 800-53 Controls\nSI-10 (Input Validation), AU-3 (Audit), SC-5 (DoS Protection)","status":"closed","issue_type":"epic","created_at":"2025-12-18T00:23:53.731485+05:30","updated_at":"2025-12-23T00:22:43.657436+05:30","closed_at":"2025-12-20T03:46:42.045662+05:30"}
{"id":"mcpmail-371","title":"Add touch target enforcement and focus ring patterns","description":"## Summary\nAdd CSS for WCAG-compliant touch targets (44×44px) and shadcn-style focus ring patterns.\n\n## Implementation Details\n\n### Add to tailwind.css (@layer base)\n```css\n@layer base {\n  /* Touch Target Enforcement (WCAG 2.1 AA) */\n  button,\n  [role=\"button\"],\n  a,\n  input[type=\"checkbox\"],\n  input[type=\"radio\"],\n  .select-trigger {\n    min-width: 44px;\n    min-height: 44px;\n  }\n\n  /* Touch-friendly spacing */\n  .button-group \u003e * + * {\n    margin-left: 0.5rem;\n  }\n}\n\n@layer utilities {\n  /* Focus ring pattern (shadcn) */\n  .focus-ring {\n    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background;\n  }\n}\n\n/* High Contrast Focus */\n@media (prefers-contrast: high) {\n  *:focus-visible {\n    outline: 3px solid currentColor !important;\n    outline-offset: 2px !important;\n  }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/style/tailwind.css\n\n## Acceptance Criteria\n- [ ] All buttons have min-width/min-height of 44px\n- [ ] All links have min-height of 44px\n- [ ] .focus-ring utility class defined\n- [ ] High contrast focus styles defined\n- [ ] Focus ring visible on Tab navigation\n- [ ] Touch targets measurable in DevTools ≥ 44×44px","notes":"Claimed by worker-8ike","status":"closed","issue_type":"task","created_at":"2025-12-18T23:11:14.670486+05:30","updated_at":"2025-12-23T00:22:43.657669+05:30","closed_at":"2025-12-19T00:01:13.964617+05:30","dependencies":[{"issue_id":"mcpmail-371","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:37.757566+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-372","title":"Add rust-embed feature flags to lib-server","description":"Add optional rust-embed and mime_guess deps with 'with-web-ui' feature flag. Propagate feature to mcp-agent-mail crate.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T17:52:51.274256+05:30","updated_at":"2025-12-23T00:22:43.657901+05:30","closed_at":"2025-12-17T18:48:55.843123+05:30"}
{"id":"mcpmail-373","title":"P0: Setup BrowserController with Chrome automation","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:19.701727+05:30","updated_at":"2025-12-23T00:22:43.658179+05:30","closed_at":"2025-12-15T18:44:26.957398+05:30","dependencies":[{"issue_id":"mcpmail-373","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:00.772933+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-374","title":"Implement install_precommit_guard MCP tool handler","description":"Implement the #[tool] annotated function that:\n1. Parses InstallPrecommitGuardParams\n2. Calls lib-core PrecommitGuardBmc::install()\n3. Returns success/failure in MCP CallToolResult format","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:13.791386+05:30","updated_at":"2025-12-23T00:22:43.658441+05:30","closed_at":"2025-12-17T19:27:26.286183+05:30","dependencies":[{"issue_id":"mcpmail-374","depends_on_id":"mcpmail-305","type":"blocks","created_at":"2025-12-16T20:06:13.792059+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-375","title":"Add --robot-examples flag with --command filter","description":"Implement --robot-examples that works with any flag or subcommand.\n\n## CLI Interface\n```bash\n# For flags (prefixed with --)\nam --robot-examples --port\nam --robot-examples --json\nam --robot-examples --robot-help      # Self-documenting\nam --robot-examples --robot-examples  # Meta (documents itself)\n\n# For subcommands (no -- prefix)\nam --robot-examples serve\nam --robot-examples serve http\nam --robot-examples archive save\nam --robot-examples tools\n```\n\n## Clap Implementation\n```rust\n#[derive(Parser)]\nstruct Cli {\n    /// Show examples for a flag or subcommand\n    /// Usage: --robot-examples --port OR --robot-examples serve http\n    #[arg(long, global = true, num_args = 0..)]\n    robot_examples: Option\u003cVec\u003cString\u003e\u003e,\n    // ...\n}\n```\n\n## Parsing Logic\n```rust\nfn handle_robot_examples(args: \u0026[String]) -\u003e Result\u003cString, Error\u003e {\n    if args.is_empty() {\n        // Show ALL examples\n        return Ok(serde_json::to_string_pretty(\u0026ALL_EXAMPLES)?);\n    }\n\n    let target = args.join(\" \");  // \"serve http\" or \"--port\"\n    let target_type = if target.starts_with(\"--\") { \"flag\" } else { \"subcommand\" };\n    \n    let examples = EXAMPLE_REGISTRY\n        .get(\u0026target)\n        .ok_or_else(|| Error::MissingExamples(target.clone()))?;\n    \n    Ok(serde_json::to_string_pretty(\u0026RobotExamplesOutput {\n        schema_version: \"1.0.0\".into(),\n        target,\n        target_type: target_type.into(),\n        examples: examples.clone(),\n    })?)\n}\n```\n\n## Example Registry Entry\n```rust\n(\"--robot-examples\", ExampleEntry {\n    description: \"Show usage examples for any flag or subcommand\",\n    target_type: \"flag\",\n    examples: vec\\![\n        Example {\n            invocation: \"am --robot-examples --port\",\n            description: \"Show examples for --port flag\",\n        },\n        Example {\n            invocation: \"am --robot-examples serve http\",\n            description: \"Show examples for 'serve http' subcommand\",\n        },\n        Example {\n            invocation: \"am --robot-examples --robot-examples\",\n            description: \"Self-documenting: show this very output\",\n        },\n    ],\n})\n```\n\n## Fail-Fast on Missing Examples\nIf a flag/subcommand is not in the registry:\n- Exit 1 with error JSON\n- This is a bug - all flags MUST have examples\n\n## Location\ncrates/services/mcp-agent-mail/src/robot_help.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T08:36:38.221359+05:30","updated_at":"2025-12-23T00:22:43.658712+05:30","closed_at":"2025-12-22T02:48:59.651652+05:30","dependencies":[{"issue_id":"mcpmail-375","depends_on_id":"mcpmail-244","type":"blocks","created_at":"2025-12-21T08:43:43.347189+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-375","depends_on_id":"mcpmail-245","type":"blocks","created_at":"2025-12-21T08:43:43.405547+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-376","title":"Fix bd sync worktree conflict on main branch","description":"## Problem\n`bd sync` fails with worktree error when sync.branch=main and you're working on main:\n```\nfatal: 'main' is already used by worktree at '/path/to/repo'\n```\n\n## Root Cause\n- bd sync uses git worktrees to commit JSONL changes\n- Git doesn't allow same branch in multiple worktrees\n- Current config: sync.branch=main, working branch=main → conflict\n\n## Solution Options\n1. Create dedicated `beads-sync` branch: `bd config set sync.branch beads-sync`\n2. Update config.yaml with `sync-branch: \"beads-sync\"`\n3. Consider if bd should handle this edge case internally\n\n## Impact\n- Low: JSONL still exported, just not auto-committed\n- Workaround: Manual git add/commit of .beads/issues.jsonl","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T21:27:53.093221+05:30","updated_at":"2025-12-23T00:22:43.659037+05:30","closed_at":"2025-12-21T23:53:19.637155+05:30"}
{"id":"mcpmail-377","title":"LEPTOS-010: Form Validation Module","description":"## Summary\nAdd client-side validation to ComposeMessage and other forms.\n\n## Implementation\nCreate: `utils/validation.rs`\n\n```rust\npub enum ValidationRule {\n    Required,\n    MinLength(usize),\n    MaxLength(usize),\n    Email,\n    Pattern(Regex),\n}\n\npub fn validate(value: \u0026str, rules: \u0026[ValidationRule]) -\u003e Result\u003c(), String\u003e\n```\n\n## Acceptance Criteria\n- [ ] Create validation.rs module with rule types\n- [ ] Required, MinLength, MaxLength, Email, Pattern rules\n- [ ] Error messages positioned below fields\n- [ ] Real-time validation (on blur + on change after first error)\n- [ ] Submit disabled until valid\n- [ ] aria-invalid and aria-describedby for errors\n\n## Quality Gates\n- Server-side validation ALWAYS runs (never trust client)\n- Error messages \u003c= 50 characters\n- Color contrast \u003e= 4.5:1 for error text\n\n## Reference Skills\n- rust-skills: Result\u003cT, E\u003e pattern, enums\n- shadcn-ui: Input error states\n- production-hardening-frontend: Input validation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T22:05:53.43841+05:30","updated_at":"2025-12-23T00:22:43.659248+05:30","closed_at":"2025-12-20T04:04:14.616529+05:30"}
{"id":"mcpmail-378","title":"Refactor to feature-based directory structure","description":"Reorganize src/lib into features/ (messaging, projects, agents) with api/, components/, hooks/, types/ subdirs. Create reusable components in components/ui/.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-10T02:45:44.014601+05:30","updated_at":"2025-12-23T00:22:43.659465+05:30","closed_at":"2025-12-15T18:44:54.6604+05:30","dependencies":[{"issue_id":"mcpmail-378","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:44.015065+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-379","title":"T4: MCP tool list_pending_reviews with JsonSchema","description":"Add list_pending_reviews MCP tool with JsonSchema params. Optional: project_slug, sender_name, limit. Returns JSON as text content. Description: List messages requiring acknowledgment. Complexity: 5/10. File: crates/libs/lib-mcp/src/tools.rs","status":"closed","issue_type":"task","created_at":"2025-12-18T17:45:56.148028+05:30","updated_at":"2025-12-23T00:22:43.659693+05:30","closed_at":"2025-12-18T18:35:40.657784+05:30","dependencies":[{"issue_id":"mcpmail-379","depends_on_id":"mcpmail-33","type":"blocks","created_at":"2025-12-18T17:46:09.083653+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-379","depends_on_id":"mcpmail-237","type":"blocks","created_at":"2025-12-18T17:46:09.135704+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-38","title":"SVELTE-015: Implement Microinteractions","description":"Polish phase: Add all specified microinteractions from design system.\n\n**Acceptance Criteria:**\n- [ ] Button hover: transform scale(1.02), color shift\n- [ ] Focus rings: ring-2 ring-indigo-500 ring-offset-2\n- [ ] Dropdown: animation dropdown-in 150ms ease-out\n- [ ] Modal: animation backdrop-in 200ms, scale-in 200ms\n- [ ] Checkbox: SVG stroke animation on check\n- [ ] List items: hover bg-slate-50 transition-colors\n\n**Design Spec (from Gemini):**\n- Button Hover: transform: scale(1.02)\n- Focus: ring-2 ring-indigo-500 ring-offset-2\n- Dropdowns: animation: dropdown-in 150ms\n\n**Reference Files:**\n- Python base.html animations section\n- Gemini Phase 4.1 Micro-interactions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:51:18.945215+05:30","updated_at":"2025-12-23T16:51:06.93943+05:30","closed_at":"2025-12-23T16:51:06.93943+05:30","dependencies":[{"issue_id":"mcpmail-38","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:51:51.161567+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-38","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:52:23.971683+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-380","title":"Add unregister_macro MCP tool","description":"Add MCP tool for unregister_macro matching REST API:\n- UnregisterMacroParams { project_slug, name }\n- ToolSchema entry\n- Handler calling MacroDefBmc::delete()\n- Integration test","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:06:57.257265+05:30","updated_at":"2025-12-23T00:22:43.659961+05:30","closed_at":"2025-12-17T20:15:36.367434+05:30","dependencies":[{"issue_id":"mcpmail-380","depends_on_id":"mcpmail-355","type":"blocks","created_at":"2025-12-16T20:06:57.257928+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-381","title":"P2: Implement real LLM thread summarization","description":"Replace stub summarize_thread with real LLM integration. Support OpenAI API (OPENAI_API_KEY). Generate concise thread summaries. Current: returns placeholder text. Python uses async LLM calls.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:15.932865+05:30","updated_at":"2025-12-23T00:22:43.660199+05:30","closed_at":"2025-12-15T21:11:33.162407+05:30","dependencies":[{"issue_id":"mcpmail-381","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:15.933601+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-383","title":"P2: Setup SSR with Actix/Axum (optional)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T23:39:52.136976+05:30","updated_at":"2025-12-23T00:22:43.660691+05:30","closed_at":"2025-12-15T19:00:42.728503+05:30","dependencies":[{"issue_id":"mcpmail-383","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:15.041115+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-384","title":"ORCH-4: Add list_pending_reviews MCP tool","description":"## Summary\nMCP tool to list all tasks awaiting review (in COMPLETED state).\n\n## Tool Signature\n```rust\n#[tool(description = \"List tasks awaiting review in COMPLETED state\")]\nasync fn list_pending_reviews(\n    project_slug: String,\n) -\u003e Result\u003cVec\u003cPendingReview\u003e\u003e\n\npub struct PendingReview {\n    pub thread_id: String,\n    pub task_title: String,\n    pub worker: String,\n    pub completion_time: DateTime\u003cUtc\u003e,\n    pub message_id: i64,\n}\n```\n\n## Acceptance Criteria\n- [ ] Scans all threads for [COMPLETION] without [APPROVED]/[FIXED]\n- [ ] Returns chronologically sorted list\n- [ ] Includes worker name and completion time","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:34:05.078738+05:30","updated_at":"2025-12-23T00:22:43.660934+05:30","closed_at":"2025-12-19T18:34:19.109799+05:30"}
{"id":"mcpmail-385","title":"REVIEW: guard check pattern matching needs unit tests and edge case fixes","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-22T02:56:09.277571+05:30","updated_at":"2025-12-23T00:22:43.661121+05:30","closed_at":"2025-12-22T02:58:49.115876+05:30"}
{"id":"mcpmail-386","title":"P2: Remove anyhow dependency from lib-server","description":"File crates/libs/lib-server/Cargo.toml:39 has TODO to remove anyhow crate. Project uses lib-core Error type (thiserror-based) consistently elsewhere. Remove anyhow, update any .context() calls to use .map_err() with proper error types. Ensures consistent error handling across codebase per AGENTS.md BMC pattern guidelines.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-17T20:52:27.575028+05:30","updated_at":"2025-12-23T00:22:43.661338+05:30","closed_at":"2025-12-17T23:41:37.169754+05:30"}
{"id":"mcpmail-387","title":"NTM-001: Add tool aliases for NTM compatibility","description":"Add tool name aliases for NTM compatibility.\n\n**Root cause:** Schema definitions (get_all_tool_schemas) don't match #[tool] implementations.\n\n**Actual state:**\n| NTM Expects | Schema Says | Impl Function | Solution |\n|-------------|-------------|---------------|----------|\n| fetch_inbox | check_inbox | list_inbox | Add alias → list_inbox |\n| whois | get_agent_profile | whois ✅ (exists\\!) | Sync schema only |\n| release_file_reservations | release_reservation | release_reservation | Add alias |\n| renew_file_reservations | renew_file_reservation | renew_file_reservation | Add alias |\n\n**Key finding:** `whois` IS implemented as #[tool] at line 2086, just missing from schema\\!\n\n**Implementation:**\n1. Add alias mapping in call_tool before routing:\n```rust\n// crates/libs/lib-mcp/src/tools/mod.rs call_tool()\nlet tool_name = match request.name.as_str() {\n    \"fetch_inbox\" | \"check_inbox\" =\u003e \"list_inbox\",\n    \"release_file_reservations\" =\u003e \"release_reservation\",\n    \"renew_file_reservations\" =\u003e \"renew_file_reservation\",\n    other =\u003e other,\n}.to_string();\n```\n\n2. Add missing tools to schema (get_all_tool_schemas):\n   - Add `whois` schema (already implemented, just missing from list)\n   - Add `fetch_inbox` as alias schema pointing to list_inbox\n   - Add plural aliases for file reservation tools\n\n**Acceptance Criteria:**\n- [ ] Alias mapping in call_tool dispatch\n- [ ] Schema sync: add whois, fetch_inbox aliases\n- [ ] Unit tests for alias routing\n- [ ] ntm Go client test succeeds\n\n**Reference Files:**\n- crates/libs/lib-mcp/src/tools/mod.rs:1726 (call_tool)\n- crates/libs/lib-mcp/src/tools/mod.rs:82 (get_all_tool_schemas)\n- crates/libs/lib-mcp/src/tools/mod.rs:2086 (whois impl - EXISTS\\!)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T06:39:31.369104+05:30","updated_at":"2025-12-23T00:22:43.661621+05:30","closed_at":"2025-12-22T07:31:38.937859+05:30"}
{"id":"mcpmail-388","title":"PORT: Product-Level Search/Summarize Tools (cross-project)","description":"## Description\nPort the product-level tools that operate across all projects linked to a product.\n\n## Missing Tools\n\n### 1. search_messages_product\n- Full-text search across ALL projects linked to a product\n- Uses FTS5 with query sanitization\n- Returns aggregated results from multiple projects\n\n### 2. summarize_thread_product\n- Summarize a thread across product-linked projects\n- Aggregates thread messages from multiple projects\n- LLM mode support for summaries\n\n## Reference\n- Python: mcp_agent_mail/src/mcp_agent_mail/app.py\n- Lines with: search_messages_product, summarize_thread_product\n\n## Implementation Notes\n- Gated by WORKTREES_ENABLED (like in Python)\n- Rust already has product_inbox (equivalent to fetch_inbox_product)\n- Need to add these 2 cross-product tools\n- Requires ProductProjectLink model support","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:51:40.179865+05:30","updated_at":"2025-12-23T00:22:43.663604+05:30","closed_at":"2025-12-20T08:32:01.632355+05:30"}
{"id":"mcpmail-389","title":"PORT-7.1: Add concurrency tests for parallel MCP operations","description":"## Problem\nNeed tests verifying thread safety and race condition handling.\n\n## Implementation\nPort 12 Python concurrency tests:\n1. test_concurrent_message_sends (10 parallel)\n2. test_concurrent_messages_to_same_thread (5 agents)\n3. test_concurrent_file_reservation_different_paths\n4. test_concurrent_file_reservation_same_path_conflict\n5. test_concurrent_file_reservation_overlapping_globs\n6. test_concurrent_inbox_fetches (10 parallel)\n7. test_concurrent_inbox_fetch_during_message_send\n8. test_concurrent_project_ensure (idempotent)\n9. test_concurrent_agent_registration\n10. test_concurrent_message_read_write\n11. test_concurrent_archive_writes\n12. test_concurrent_message_bundle_writes\n\n## Files\n- crates/libs/lib-core/tests/concurrent_tests.rs (NEW)\n\n## Python Reference\n- /Users/amrit/Documents/Projects/Rust/mouchak/mcp_agent_mail/tests/test_concurrent_writes.py\n- Commit 39575b9: test(concurrency): add tests for parallel MCP operations\n\n## Reference Docs\n- docs/mcp-agent-mail-python-beads-diff.md (search: concurrent, parallel)\n- docs/PYTHON_PORT_PLAN_v2.md (Task 7.1)\n\n## Acceptance Criteria\n- [ ] All 12 concurrency tests ported\n- [ ] Use tokio::spawn for parallelism\n- [ ] Proper error collection with join_all\n- [ ] Tests pass reliably (no flaky)\n\n## Complexity: 6/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:27:34.368789+05:30","updated_at":"2025-12-23T00:22:43.663904+05:30","closed_at":"2025-12-19T16:51:28.134193+05:30"}
{"id":"mcpmail-39","title":"SVELTE-019: Add responsive layout with container queries","description":"Mobile-first responsive design using container queries for component-level responsiveness.\n\n**Acceptance Criteria:**\n- [ ] Mobile-first CSS using min-width media queries\n- [ ] Container queries for MessageList/MessageDetail split\n- [ ] Breakpoints: phones (320-480px), tablets (768-1024px), desktops (1200px+)\n- [ ] safe-area-inset-* for notched devices (iPhone X+)\n- [ ] 35%/65% split on desktop, 100% stacked on mobile\n- [ ] Bottom nav on mobile converts to sidebar on desktop\n- [ ] No horizontal scrolling on any viewport\n\n**Design Spec (from mobile-frontend-design):**\n- container-type: inline-size for card components\n- env(safe-area-inset-*) for notches\n- 16px+ base font for readability\n- Fluid typography with clamp()\n\n**Reference Files:**\n- .tmp/skills/mobile-frontend-design/resources/responsive-design.md\n- .tmp/skills/mobile-frontend-design/SKILL.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:54:21.119192+05:30","updated_at":"2025-12-23T16:51:07.124948+05:30","closed_at":"2025-12-23T16:51:07.124948+05:30","dependencies":[{"issue_id":"mcpmail-39","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-22T05:55:05.021117+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-39","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:55:47.947271+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-390","title":"SVELTE-010: Implement remaining routes (attachments, file-reservations, archive)","description":"## Summary\nImplement secondary routes for complete feature parity.\n\n## Routes\n### /attachments\n- Grid view of attachments\n- Filter by project\n- Preview modal\n- Download links\n\n### /projects/[slug]/file-reservations\n- Table of active file locks\n- Agent name, path pattern, expiry\n- Release button for own reservations\n\n### /archive\n- List archive snapshots\n- Download/restore actions\n- Archive metadata display\n\n### Route Aliases\n- /mail/unified → redirect to /mail\n- /mail/unified-inbox → redirect to /mail\n\n## Reference Files\n- Leptos: crates/services/web-ui-leptos/src/pages/\n- API: /api/file_reservations/list, /api/archive/list\n\n## Acceptance Criteria\n- [ ] /attachments renders grid\n- [ ] /projects/[slug]/file-reservations shows table\n- [ ] /archive lists snapshots\n- [ ] Redirect aliases work\n- [ ] All routes mobile responsive\n\n## Quality Gates\n- bun run check passes\n- E2E tests for each route","notes":"Claimed by agent CrimsonFalcon","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T05:39:03.030254+05:30","updated_at":"2025-12-23T03:12:22.555399+05:30","closed_at":"2025-12-23T03:12:22.555399+05:30","dependencies":[{"issue_id":"mcpmail-390","depends_on_id":"mcpmail-52","type":"blocks","created_at":"2025-12-22T05:40:42.383752+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-390","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:16.416762+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-391","title":"Add HTTP/SSE transport option","description":"Optional HTTP transport for web-based MCP clients","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T04:45:24.013401+05:30","updated_at":"2025-12-23T00:22:43.66442+05:30","closed_at":"2025-12-09T06:54:57.621817+05:30","labels":["mcp","transport"]}
{"id":"mcpmail-392","title":"P2: Create systemd service files for Linux deployment","description":"Create deploy/systemd/mcp-agent-mail.service unit file for production Linux deployment. Include: ExecStart, WorkingDirectory, Environment, Restart=always, User/Group. Also create mcp-agent-mail.socket for socket activation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:55:14.142192+05:30","updated_at":"2025-12-23T00:22:43.664649+05:30","closed_at":"2025-12-15T22:21:00.855157+05:30","dependencies":[{"issue_id":"mcpmail-392","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:55:14.143241+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-393","title":"Phase 9: WASM-Native E2E Testing with Probar","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-11T23:33:07.479344+05:30","updated_at":"2025-12-23T00:22:43.664886+05:30","closed_at":"2025-12-15T18:44:27.298197+05:30"}
{"id":"mcpmail-394","title":"ORCH-5: Add WorktreeManager for agent isolation","description":"## Summary\nUtility for managing git worktrees for multi-agent isolation.\n\n## Implementation\n```rust\npub struct WorktreeManager {\n    base_path: PathBuf,  // .sandboxes/\n}\n\nimpl WorktreeManager {\n    pub fn new(base: \u0026Path) -\u003e Self;\n    \n    pub async fn create_worker_worktree(\n        task_id: \u0026str,\n    ) -\u003e Result\u003cPathBuf\u003e;\n    \n    pub async fn create_reviewer_worktree(\n        task_id: \u0026str,\n    ) -\u003e Result\u003cPathBuf\u003e;\n    \n    pub async fn merge_and_cleanup(\n        worktree_path: \u0026Path,\n        target_branch: \u0026str,\n    ) -\u003e Result\u003cString\u003e;  // Returns merge commit SHA\n    \n    pub async fn force_cleanup(\n        worktree_path: \u0026Path,\n    ) -\u003e Result\u003c()\u003e;\n    \n    pub fn list_active_worktrees() -\u003e Result\u003cVec\u003cWorktreeInfo\u003e\u003e;\n}\n```\n\n## Acceptance Criteria\n- [ ] Creates .sandboxes/worker-\u003cid\u003e worktrees\n- [ ] Creates .sandboxes/reviewer-fix-\u003cid\u003e worktrees\n- [ ] Merges feature/\u003cid\u003e to main on completion\n- [ ] Cleans up worktree and branch after merge\n- [ ] Lists active worktrees for monitoring","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:34:54.676035+05:30","updated_at":"2025-12-23T00:22:43.665606+05:30","closed_at":"2025-12-20T00:50:52.102232+05:30"}
{"id":"mcpmail-395","title":"Add workspace lints to Cargo.toml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T16:41:39.634657+05:30","updated_at":"2025-12-23T00:22:43.66582+05:30","closed_at":"2025-12-17T16:52:16.969301+05:30"}
{"id":"mcpmail-396","title":"P1: Add Permissions-Policy security header","description":"## Summary\nAdd Permissions-Policy header to lib-server security middleware.\n\n## Implementation\n```rust\n.layer(SetResponseHeaderLayer::overriding(\n    HeaderName::from_static(\"permissions-policy\"),\n    HeaderValue::from_static(\"geolocation=(), microphone=(), camera=()\"),\n))\n```\n\n## Location\ncrates/libs/lib-server/src/lib.rs lines 125-139 (existing security headers)\n\n## Acceptance Criteria\n- [ ] Permissions-Policy header added\n- [ ] Disable geolocation, microphone, camera by default\n- [ ] cargo test passes\n- [ ] Verify header with curl -I\n\n## Reference\nproduction-hardening-backend skill: OWASP Security Headers","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T19:03:41.584915+05:30","updated_at":"2025-12-23T00:22:43.666107+05:30","closed_at":"2025-12-20T04:21:25.124064+05:30"}
{"id":"mcpmail-397","title":"LEPTOS-012: Skeleton Loading Components","description":"## Summary\nCreate skeleton components for loading states per shadcn pattern.\n\n## Implementation\nCreate: `components/skeleton.rs`\n\n```rust\n#[component]\npub fn Skeleton(\n    #[prop(optional, into)] class: MaybeProp\u003cString\u003e,\n) -\u003e impl IntoView {\n    view! {\n        \u003cdiv class=tw_merge!(\"animate-pulse rounded-md bg-muted\", class.get()) /\u003e\n    }\n}\n\n// Pre-built skeletons\npub fn MessageListSkeleton() -\u003e impl IntoView { /* 5 items */ }\npub fn MessageDetailSkeleton() -\u003e impl IntoView { /* header + body */ }\npub fn AttachmentGridSkeleton() -\u003e impl IntoView { /* 3x3 grid */ }\n```\n\n## Acceptance Criteria\n- [ ] Skeleton base component with animate-pulse\n- [ ] MessageListSkeleton (5 items)\n- [ ] MessageDetailSkeleton\n- [ ] AttachmentGridSkeleton (3x3)\n- [ ] Respects prefers-reduced-motion\n- [ ] Uses bg-muted semantic color\n\n## Quality Gates\n- CLS = 0 (skeleton matches real content size)\n- Animation \u003c= 60fps\n- No layout shift on content load\n\n## Reference Skills\n- shadcn-ui: Skeleton component\n- production-hardening-frontend: CLS optimization\n- mobile-frontend-design: Loading states","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T22:06:41.171353+05:30","updated_at":"2025-12-23T00:22:43.666427+05:30","closed_at":"2025-12-20T04:13:17.087263+05:30","dependencies":[{"issue_id":"mcpmail-397","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:14.200307+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-397","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:14.253665+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-398","title":"EPIC: SvelteKit Web UI Transformation","description":"## Overview\nReplace Leptos WASM frontend with SvelteKit while maintaining single-binary deployment via rust-embed.\n\n## Current State\n- **Leptos (web-ui-leptos)**: 12 pages, 34+ components, fully implemented\n- **SvelteKit (web-ui)**: 5 basic pages, 1 component, skeleton implementation\n- **Embedding**: rust-embed points to web-ui-leptos/dist\n\n## Target State\n- SvelteKit 2.0 + Svelte 5 frontend matching Python reference design\n- Gmail-style unified inbox with split view, keyboard nav (j/k/f/Esc), Cmd+K\n- Single binary with embedded web-ui/build via rust-embed\n- Bundle size \u003c 200KB (vs ~2MB WASM)\n- Lighthouse \u003e 90 for Performance, A11y, Best Practices\n\n## Reference Implementation\n- Python: mcp_agent_mail/templates/mail_unified_inbox.html (Alpine.js + Jinja2)\n- Design: Indigo-500 (#6366f1) primary, Inter font, Gmail-style split view\n\n## Key Files\n- web-transform.md: Detailed transformation plan\n- crates/services/web-ui/: SvelteKit target\n- crates/libs/lib-server/src/embedded.rs: Embedding config\n- mcp_agent_mail/templates/: Python reference\n\n## Success Criteria\n- [ ] All 12 Leptos pages ported to SvelteKit\n- [ ] Single binary builds successfully with embedded UI\n- [ ] Bundle size \u003c 200KB (gzip)\n- [ ] Lighthouse PWA score ≥ 90\n- [ ] E2E tests passing\n- [ ] Keyboard navigation (j/k/f/Esc/Cmd+K)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-22T05:33:21.47213+05:30","updated_at":"2025-12-23T21:16:59.26356+05:30","closed_at":"2025-12-23T21:16:59.26356+05:30"}
{"id":"mcpmail-399","title":"P1: Increase test coverage to 85%","description":"Current: 12.5%. Target: 85%. Focus: lib-core/model BMC CRUD (90%), lib-core/store git+sqlite (85%), mcp-server/tools handlers (80%), mcp-stdio protocol (80%). Use cargo-llvm-cov for measurement.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:51.33256+05:30","updated_at":"2025-12-23T00:22:43.667177+05:30","dependencies":[{"issue_id":"mcpmail-399","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:51.33304+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-4","title":"SVELTE-005: Implement /mail unified inbox page (P0)","description":"## Summary\nCreate Gmail-style unified inbox with split view, matching Python reference.\n\n## Implementation\n**File**: `src/routes/mail/+page.svelte`\n\n### Layout Structure\n```\n┌─────────────────────────────────────────────────────────┐\n│  SEARCH BAR (sticky)                                    │\n│  [Search input] [Filters] [Split/List] [Fullscreen]    │\n├─────────────────────────────────────────────────────────┤\n│  FILTER BAR (collapsible)                               │\n│  [Project] [Sender] [Recipient] [Importance] [Thread]  │\n├───────────────────────┬─────────────────────────────────┤\n│  MESSAGE LIST (35%)   │  MESSAGE DETAIL (65%)           │\n│  - Checkbox           │  - Subject                      │\n│  - Sender → Recipients│  - Metadata grid                │\n│  - Project badge      │  - Markdown body                │\n│  - Importance badge   │  - Actions (Copy, Open)         │\n│  - Subject, excerpt   │                                 │\n│  - Timestamp          │                                 │\n└───────────────────────┴─────────────────────────────────┘\n```\n\n### Components to Create\n- MessageList.svelte (left pane)\n- MessageItem.svelte (list row)\n- MessageDetail.svelte (right pane)\n- FilterBar.svelte (collapsible)\n- SearchBar.svelte (with Cmd+K hint)\n\n### Keyboard Shortcuts\n- j/k: Navigate messages\n- f: Toggle fullscreen\n- Esc: Deselect / exit fullscreen\n- Cmd+K or /: Focus search\n\n## Reference Files\n- Python: mcp_agent_mail/templates/mail_unified_inbox.html\n- Leptos: crates/services/web-ui-leptos/src/pages/unified_inbox.rs\n- API: GET /mail/api/unified-inbox\n\n## Acceptance Criteria\n- [ ] Split view works on desktop (≥1024px)\n- [ ] Falls back to single column on mobile\n- [ ] Filter bar expands/collapses with animation\n- [ ] Message selection updates detail panel (no reload)\n- [ ] Keyboard navigation j/k works\n- [ ] Cmd+K focuses search\n- [ ] f toggles fullscreen\n- [ ] Auto-refresh every 45s (toggleable)\n- [ ] Empty state with guidance\n- [ ] Bulk actions: Select all, Mark read\n\n## Quality Gates\n- Lighthouse Performance \u003e 90\n- WCAG 2.1 AA keyboard accessible\n- Works on Chrome, Firefox, Safari","notes":"Starting SVELTE-005 unified inbox implementation","status":"closed","issue_type":"feature","created_at":"2025-12-22T05:35:26.986399+05:30","updated_at":"2025-12-23T02:57:22.375351+05:30","closed_at":"2025-12-23T02:57:22.375351+05:30","close_reason":"Done","dependencies":[{"issue_id":"mcpmail-4","depends_on_id":"mcpmail-319","type":"blocks","created_at":"2025-12-22T05:40:16.653046+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-4","depends_on_id":"mcpmail-52","type":"blocks","created_at":"2025-12-22T05:40:21.773521+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-4","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:50.780165+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-40","title":"MCP Tools workflow test (post capability fix)","description":"Test the complete MCP tools workflow using init-tools.md now that register_agent auto-grants capabilities. Verify: register_agent, send_message, file_reservation_paths, check_inbox, release_reservation all work via MCP stdio.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T20:08:32.980407+05:30","updated_at":"2025-12-23T00:22:43.55797+05:30","closed_at":"2025-12-22T20:09:27.920428+05:30"}
{"id":"mcpmail-400","title":"Phase 8: Backend Production Hardening \u0026 Drop-in Replacement","description":"PMAT Score: 83.5/134 (62.3%) B+ → Target: 100/134 (75%). Quality Gate: FAILED (26 violations) → Target: PASSED. Test Coverage: 12.5% → Target: 85%. Critical blockers: no unified CLI, no installer script, 26 quality violations. See docs/PRODUCTION_HARDENING_PLAN.md and docs/GAP_ANALYSIS.md for details.","status":"closed","issue_type":"epic","created_at":"2025-12-11T02:13:03.369494+05:30","updated_at":"2025-12-23T00:22:43.667428+05:30","closed_at":"2025-12-15T16:46:22.645625+05:30"}
{"id":"mcpmail-401","title":"P1: Add end-to-end integration tests","description":"Create tests/integration/ with scenarios: complete messaging flow (create project → register agents → send → inbox → ack), file reservation lifecycle, search/FTS5, contact management. Use test fixtures and spawn_test_server pattern.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:58.84905+05:30","updated_at":"2025-12-23T00:22:43.668162+05:30","closed_at":"2025-12-15T16:46:24.760583+05:30","dependencies":[{"issue_id":"mcpmail-401","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:58.849471+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-402","title":"P1: Refactor complexity hotspots (cyclomatic \u003e10)","description":"Hotspots: commit_file (14), create_agent_identity (13), main in mcp-cli (12), commit_paths (11), file_reservation_paths (11). Extract helper functions, reduce nesting. PMAT estimates 15.2h refactoring time.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:55.670192+05:30","updated_at":"2025-12-23T00:22:43.66848+05:30","closed_at":"2025-12-17T23:41:32.343922+05:30","dependencies":[{"issue_id":"mcpmail-402","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:55.67058+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-403","title":"P2: Add OpenAPI documentation with utoipa","description":"Add utoipa derives to all request/response types. Create OpenAPI spec at /openapi.json. Serve Swagger UI at /docs. Document all 62 endpoints with examples.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T03:11:20.077689+05:30","updated_at":"2025-12-23T00:22:43.668783+05:30","closed_at":"2025-12-15T22:21:00.715622+05:30","dependencies":[{"issue_id":"mcpmail-403","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:11:20.078063+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-404","title":"P1: Add structured logging with tracing","description":"Add #[instrument] to all handlers, use info!/warn!/error! with structured fields, add request_id correlation, configure tracing-subscriber with JSON output for production. Essential for debugging.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:59.304068+05:30","updated_at":"2025-12-23T00:22:43.669081+05:30","closed_at":"2025-12-15T16:46:25.342605+05:30","dependencies":[{"issue_id":"mcpmail-404","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:59.304407+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-405","title":"P1: Add bearer token authentication middleware","description":"Add auth middleware checking HTTP_BEARER_TOKEN env var. Support HTTP_ALLOW_LOCALHOST_UNAUTHENTICATED=true for dev mode. Return 401 Unauthorized for invalid/missing token. Python parity feature.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:59.534526+05:30","updated_at":"2025-12-23T00:22:43.66937+05:30","closed_at":"2025-12-15T20:52:32.57711+05:30","dependencies":[{"issue_id":"mcpmail-405","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:59.534869+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-406","title":"P1: Add CI/CD pipeline (GitHub Actions)","description":"Create .github/workflows/ci.yml with: cargo fmt check, cargo clippy -D warnings, cargo test, cargo audit, pmat quality-gate, cargo-llvm-cov with 85% threshold, build matrix for linux/macos. Add release workflow for binaries.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:11:19.849852+05:30","updated_at":"2025-12-23T00:22:43.669645+05:30","closed_at":"2025-12-15T20:54:22.963536+05:30","dependencies":[{"issue_id":"mcpmail-406","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:11:19.850243+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-407","title":"P2: Complete attachment handlers implementation","description":"Implement /api/attachments/add and /api/attachments/get handlers. Schema exists but handlers are stubs. Support base64 encoding, mime type detection, size limits.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T03:11:19.612752+05:30","updated_at":"2025-12-23T00:22:43.669889+05:30","closed_at":"2025-12-15T21:41:34.870935+05:30","dependencies":[{"issue_id":"mcpmail-407","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:11:19.613132+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-408","title":"P2: Add graceful shutdown handling","description":"Handle SIGTERM and SIGINT signals with tokio::signal. Complete in-flight requests, close database connections cleanly, log shutdown progress. Essential for container deployments.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T03:11:19.152222+05:30","updated_at":"2025-12-23T00:22:43.670137+05:30","closed_at":"2025-12-15T21:41:34.448937+05:30","dependencies":[{"issue_id":"mcpmail-408","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:11:19.152608+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-409","title":"P2: Add rate limiting with tower-governor","description":"Add per-endpoint rate limiting: 10 req/sec with 50 burst for message send, higher limits for reads. Prevents DoS and abuse. Use tower-governor crate.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T03:11:19.382651+05:30","updated_at":"2025-12-23T00:22:43.670378+05:30","closed_at":"2025-12-15T21:41:34.657192+05:30","dependencies":[{"issue_id":"mcpmail-409","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:11:19.38306+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-41","title":"BUG: check() ignores expires_at - expired capabilities still pass","status":"closed","issue_type":"bug","created_at":"2025-12-22T20:41:29.139016+05:30","updated_at":"2025-12-23T00:22:43.558236+05:30","closed_at":"2025-12-22T20:42:40.085246+05:30"}
{"id":"mcpmail-410","title":"P1: Implement pre-commit guard for file reservations","description":"Implement /api/setup/install_guard and /api/setup/uninstall_guard to install git pre-commit hook that checks Agent Mail reservations before allowing commit. Python has this feature.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T03:10:59.077025+05:30","updated_at":"2025-12-23T00:22:43.670601+05:30","closed_at":"2025-12-17T20:31:41.622068+05:30","dependencies":[{"issue_id":"mcpmail-410","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T03:10:59.077414+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-411","title":"P0: Create unified CLI binary (mcp-agent-mail)","description":"Create crates/bins/mcp-agent-mail with subcommands: serve-http (--port), serve-mcp (stdio), health (--url), version. Use clap for argument parsing. This is BLOCKING for drop-in replacement.","status":"closed","issue_type":"task","created_at":"2025-12-11T02:14:16.396855+05:30","updated_at":"2025-12-23T00:22:43.670825+05:30","closed_at":"2025-12-15T16:50:26.241224+05:30","dependencies":[{"issue_id":"mcpmail-411","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T02:14:16.39726+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-412","title":"P0: Create installer script (scripts/install.sh)","description":"Create bash installer that: detects OS/arch, downloads binary from releases, installs to ~/.local/bin, creates launchd plist (macOS) or systemd unit (Linux), starts server, verifies health. One-liner: curl ... | bash","status":"closed","issue_type":"task","created_at":"2025-12-11T02:14:22.623313+05:30","updated_at":"2025-12-23T00:22:43.671056+05:30","closed_at":"2025-12-15T16:55:42.174953+05:30","dependencies":[{"issue_id":"mcpmail-412","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T02:14:22.62373+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-413","title":"P0: Fix dead code warnings (5 unused fields)","description":"Fix cargo warnings: GetMessagePayload unused, InvokeMacroPayload.params unused, AddAttachmentPayload.mime_type unused, CreateAgentIdentityParams.hint unused, ExportMailboxParams.include_attachments unused. Either use them or remove them.","status":"closed","issue_type":"bug","created_at":"2025-12-11T02:14:26.209463+05:30","updated_at":"2025-12-23T00:22:43.671303+05:30","closed_at":"2025-12-15T16:46:24.33833+05:30","dependencies":[{"issue_id":"mcpmail-413","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T02:14:26.209896+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-414","title":"P0: Document beads environment variables","description":"Add to README: BEADS_AGENT_MAIL_URL (default http://127.0.0.1:8765), BEADS_AGENT_NAME, BEADS_PROJECT_ID, PORT (default 8765), HOST (default 127.0.0.1). Also update CLAUDE.md and AGENTS.md.","status":"closed","issue_type":"task","created_at":"2025-12-11T02:14:29.203458+05:30","updated_at":"2025-12-23T00:22:43.671526+05:30","closed_at":"2025-12-15T17:47:43.67251+05:30","dependencies":[{"issue_id":"mcpmail-414","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T02:14:29.203818+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-415","title":"P0: Add Python-compatible route aliases","description":"Add GET aliases: /api/reservations → list_file_reservations, /api/reservations/:id DELETE → release_reservation, /api/inbox/:agent GET → inbox by agent, /api/thread/:id GET → thread by id. Required for beads bd integration.","status":"closed","issue_type":"task","created_at":"2025-12-11T02:34:43.628111+05:30","updated_at":"2025-12-23T00:22:43.671748+05:30","closed_at":"2025-12-15T17:47:43.768994+05:30","dependencies":[{"issue_id":"mcpmail-415","depends_on_id":"mcpmail-400","type":"parent-child","created_at":"2025-12-11T02:34:43.628631+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-416","title":"Verify dark mode works correctly for all components","description":"## Summary\nTest all components in dark mode to ensure CSS variables work correctly.\n\n## Implementation Details\n\n### Test Checklist\n- Card background uses --card variable\n- Text uses --foreground / --card-foreground\n- Borders use --border variable\n- Input backgrounds correct\n- Button variants visible\n- Badge variants visible\n- Alert variants visible\n- Focus rings visible against dark background\n- Skeleton pulse animation visible\n\n### Dev-Browser Test Script\n```typescript\n// Enable dark mode\nawait page.emulateMedia({ colorScheme: 'dark' });\nawait page.goto('http://localhost:8080');\n\n// Screenshot all pages\nconst pages = ['/', '/projects', '/inbox', '/agents'];\nfor (const path of pages) {\n  await page.goto(\\`http://localhost:8080\\${path}\\`);\n  await page.screenshot({ path: \\`dark-mode-\\${path.replace('/', 'home')}.png\\` });\n}\n```\n\n## Acceptance Criteria\n- [ ] All semantic colors apply correctly in dark mode\n- [ ] No white flash on page load\n- [ ] Contrast ratios meet WCAG AA (4.5:1 for text)\n- [ ] Focus rings visible\n- [ ] All component variants visible and distinguishable","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T23:13:06.456175+05:30","updated_at":"2025-12-23T00:22:43.67199+05:30","closed_at":"2025-12-19T01:58:08.748194+05:30","dependencies":[{"issue_id":"mcpmail-416","depends_on_id":"mcpmail-255","type":"blocks","created_at":"2025-12-18T23:13:51.241546+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-417","title":"PORT: Macro Convenience Tools (4 session/workflow helpers)","description":"## Description\nPort the 4 Python macro convenience tools that orchestrate multi-step workflows.\n\n## Missing Tools\n\n### 1. macro_start_session\nBoots a project session in one call:\n- ensure_project\n- register_agent (or get existing)\n- optionally reserve file paths\n- fetch inbox snapshot\n\n### 2. macro_prepare_thread\nAligns an agent with an existing thread:\n- ensure agent registration\n- summarize the thread\n- fetch recent inbox context\n- LLM mode support\n\n### 3. macro_file_reservation_cycle\nReserve files with optional auto-release:\n- reserve file paths\n- optionally auto-release at workflow end\n\n### 4. macro_contact_handshake\nContact permission workflow:\n- request contact\n- optionally auto-approve\n- optionally send welcome message\n\n## Reference\n- Python: mcp_agent_mail/src/mcp_agent_mail/app.py\n- Search for: macro_start_session, macro_prepare_thread, macro_file_reservation_cycle, macro_contact_handshake\n\n## Implementation Notes\n- These are orchestration tools that call other existing tools\n- Rust has similar 'quick_*' workflows but missing these specific macros\n- Should be registered conditionally based on feature flags","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T00:51:39.960316+05:30","updated_at":"2025-12-23T00:22:43.672239+05:30","closed_at":"2025-12-20T16:36:03.906807+05:30"}
{"id":"mcpmail-418","title":"P1: Refactor commit_message_to_git complexity (cyclomatic 12 → \u003c7)","description":"PMAT complexity analysis shows commit_message_to_git has cyclomatic complexity 12 (threshold: 10). Location: crates/libs/lib-core/src/model/message.rs. Extract into 4 smaller functions: 1) validate_git_context() - check repo exists, 2) format_commit_message() - build message string, 3) execute_commit() - run git command, 4) process_commit_result() - handle success/failure. Each function should have cyclomatic \u003c7. Add tests for each extracted function.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T20:51:58.617777+05:30","updated_at":"2025-12-23T00:22:43.672465+05:30","closed_at":"2025-12-17T21:05:15.05718+05:30"}
{"id":"mcpmail-419","title":"GAP: Age Encryption for Exports","description":"## Problem\nPython export supports age encryption for confidential distribution. Rust export has no encryption.\n\n## Python Features\n- `--age-recipient` (repeatable) encrypts final ZIP\n- `share decrypt` decrypts with identity or passphrase\n\n## Implementation\n- Add age crate\n- Add age_recipients field to ExportBmc\n- Encrypt final ZIP if recipients specified\n- Create share_decrypt CLI subcommand","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T17:59:30.720772+05:30","updated_at":"2025-12-23T00:22:43.672724+05:30","closed_at":"2025-12-20T04:47:34.623976+05:30"}
{"id":"mcpmail-42","title":"GAP: Ed25519 Signing for Exports","description":"## Problem\nPython export supports Ed25519 signing for manifest integrity verification. Rust export has no signing.\n\n## Python Features\n- `--signing-key` generates Ed25519 signature of manifest.json\n- `--signing-public-out` exports public key\n- `share verify` validates signatures\n\n## Implementation\n- Add ed25519-dalek crate\n- Add signing_key, signing_public_out fields to ExportBmc\n- Add signature field to manifest.json\n- Create share_verify CLI subcommand","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T17:59:30.479541+05:30","updated_at":"2025-12-23T00:22:43.558487+05:30","closed_at":"2025-12-20T04:30:10.243605+05:30"}
{"id":"mcpmail-420","title":"Component: Comprehensive Filter Bar","description":"## Task\nCreate unified filter bar component for inbox views matching Python reference.\n\n## Design (from screenshots)\nSingle horizontal bar containing:\n1. **Search Input** (flex-grow)\n   - Placeholder: \"Search all messages across all projects and agents...\"\n   - Search icon prefix\n   - Keyboard shortcut hint (⌘K)\n   \n2. **Filter Dropdowns** (grouped)\n   - Project: \"All Projects\" + dynamic list\n   - Sender: \"All Senders\" + unique sender names\n   - Recipient: \"All Recipients\" + unique recipients\n   - Importance: \"All\" / \"High\" / \"Normal\"\n   \n3. **Toggles**\n   - Threads: Toggle to show threaded view\n   \n4. **View Controls**\n   - List view icon (active state)\n   - Grid view icon\n   \n5. **Message Count Badge**\n   - Right-aligned\n   - Shows \"X messages\"\n\n## Layout\n```\n[🔍 Search................................] [Filters ▼] [≡ ▦] [5 messages]\n```\n\nOn mobile (\u003c 768px):\n- Search takes full width\n- Filters collapse to \"Filters\" button opening bottom sheet\n\n## Implementation\n```rust\n#[component]\npub fn FilterBar(\n    #[prop(into)] on_search: Callback\u003cString\u003e,\n    #[prop(into)] on_filter_change: Callback\u003cFilterState\u003e,\n    #[prop(into)] message_count: Signal\u003cusize\u003e,\n    #[prop(default = vec![])] projects: Vec\u003cString\u003e,\n    #[prop(default = vec![])] senders: Vec\u003cString\u003e,\n) -\u003e impl IntoView\n```\n\n## Files\n- `components/filter_bar.rs` (new)\n- Update existing Select component for multi-select support\n\n## Acceptance Criteria\n- [ ] Filters apply in real-time (debounced search)\n- [ ] Filter state persisted in URL params\n- [ ] Mobile: bottom sheet for filters\n- [ ] Keyboard accessible (tab navigation)","notes":"Claimed by worker-4980","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T06:07:34.519488+05:30","updated_at":"2025-12-23T00:22:43.672952+05:30","closed_at":"2025-12-18T18:06:11.735832+05:30"}
{"id":"mcpmail-421","title":"Upgrade Avatar with Avatar/AvatarImage/AvatarFallback compound pattern","description":"## Summary\nRefactor Avatar component to shadcn compound pattern with size variants and proper ARIA.\n\n## Implementation Details\n\n### Refactor avatar.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::*;\n\nconst AVATAR_BASE: \u0026str = \"relative flex shrink-0 overflow-hidden rounded-full\";\nconst IMAGE_CLASS: \u0026str = \"aspect-square h-full w-full\";\nconst FALLBACK_CLASS: \u0026str = \"flex h-full w-full items-center justify-center rounded-full bg-muted\";\n\n#[derive(TwVariant, Clone, Copy, Default)]\npub enum AvatarSize {\n    #[tw(default, class = \"h-10 w-10\")]\n    Default,\n    #[tw(class = \"h-8 w-8\")]\n    Sm,\n    #[tw(class = \"h-12 w-12\")]\n    Lg,\n    #[tw(class = \"h-16 w-16\")]\n    Xl,\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/avatar.rs\n\n## Acceptance Criteria\n- [ ] Avatar, AvatarImage, AvatarFallback compound components\n- [ ] 4 size variants (sm: 32px, default: 40px, lg: 48px, xl: 64px)\n- [ ] AvatarFallback has role=\"img\"\n- [ ] Uses bg-muted for fallback background\n- [ ] Preserves existing deterministic color generation\n- [ ] All components support class override","notes":"Claimed by worker-5333","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T23:11:53.145555+05:30","updated_at":"2025-12-23T00:22:43.673199+05:30","closed_at":"2025-12-19T00:55:59.119687+05:30","dependencies":[{"issue_id":"mcpmail-421","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:41.114428+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-43","title":"Create Card, CardHeader, CardTitle, CardContent, CardFooter components","description":"## Summary\nCreate Card compound components following shadcn pattern for composable card layouts.\n\n## Implementation Details\n\n### Create components/card.rs\n```rust\nuse leptos::*;\nuse tailwind_fuse::tw_merge;\n\nconst CARD_CLASS: \u0026str = \"rounded-lg border bg-card text-card-foreground shadow-sm\";\nconst HEADER_CLASS: \u0026str = \"flex flex-col space-y-1.5 p-6\";\nconst TITLE_CLASS: \u0026str = \"text-2xl font-semibold leading-none tracking-tight\";\nconst DESCRIPTION_CLASS: \u0026str = \"text-sm text-muted-foreground\";\nconst CONTENT_CLASS: \u0026str = \"p-6 pt-0\";\nconst FOOTER_CLASS: \u0026str = \"flex items-center p-6 pt-0\";\n\n#[component]\npub fn Card(\n    #[prop(optional, into)] class: MaybeProp\u003cString\u003e,\n    children: Children,\n) -\u003e impl IntoView {\n    view! {\n        \u003cdiv class=tw_merge!(CARD_CLASS, class.get())\u003e\n            {children()}\n        \u003c/div\u003e\n    }\n}\n```\n\n## Files Changed\n- crates/services/web-ui-leptos/src/components/card.rs (NEW)\n- crates/services/web-ui-leptos/src/components/mod.rs\n\n## Acceptance Criteria\n- [ ] Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter created\n- [ ] All components support class override via MaybeProp\n- [ ] Uses semantic bg-card and text-card-foreground colors\n- [ ] CardTitle uses h3 for proper heading hierarchy\n- [ ] All components exported from mod.rs\n- [ ] Dark mode compatible via CSS variables","notes":"Claimed by worker-nkcp","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T23:11:52.464582+05:30","updated_at":"2025-12-23T00:22:43.558779+05:30","closed_at":"2025-12-19T00:37:41.926747+05:30","dependencies":[{"issue_id":"mcpmail-43","depends_on_id":"mcpmail-299","type":"blocks","created_at":"2025-12-18T23:13:40.966672+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-44","title":"PORT-2.2-INT: Integrate ArchiveLock into git_archive.rs operations","description":"## Context\nScaffolding exists in lib-core/src/store/archive_lock.rs with:\n- ArchiveLock, LockOwner struct (pid, timestamp, agent, hostname)\n- LockGuard RAII with automatic release\n- is_stale(), is_process_alive() with cross-platform support\n- All with unit tests\n\n## Remaining Work\nIntegrate ArchiveLock into git archive operations:\n1. Wrap archive write operations with ArchiveLock::acquire()\n2. Use LockGuard for automatic release on success/failure\n3. Add stale lock cleanup on GitStore initialization\n4. Add test simulating crash recovery\n\n## Acceptance Criteria\n- [ ] All git archive writes protected by ArchiveLock\n- [ ] LockGuard ensures release on panic/error\n- [ ] Stale locks from dead processes cleaned on init\n- [ ] Test simulates crash with orphaned lock\n- [ ] No data corruption on forced cleanup\n\n## Files to Modify\n- crates/libs/lib-core/src/store/git_archive.rs\n- crates/libs/lib-core/src/store/git_store.rs (init cleanup)\n\n## Complexity: 5/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T05:16:12.452828+05:30","updated_at":"2025-12-23T00:22:43.559167+05:30","closed_at":"2025-12-19T21:19:47.657131+05:30","dependencies":[{"issue_id":"mcpmail-44","depends_on_id":"mcpmail-227","type":"blocks","created_at":"2025-12-19T05:16:12.453466+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-45","title":"ORCH-3: Add get_review_state MCP tool","description":"## Summary\nNew MCP tool to check review state of a task thread.\n\n## Tool Signature\n```rust\n#[tool(description = \"Get the current review state of a task thread\")]\nasync fn get_review_state(\n    project_slug: String,\n    thread_id: String,  // e.g., TASK-abc123\n) -\u003e Result\u003cReviewStateResponse\u003e\n\npub struct ReviewStateResponse {\n    pub thread_id: String,\n    pub state: String,  // e.g., \"COMPLETED\", \"APPROVED\"\n    pub is_reviewed: bool,\n    pub reviewer: Option\u003cString\u003e,\n    pub last_update: DateTime\u003cUtc\u003e,\n}\n```\n\n## Acceptance Criteria\n- [ ] get_review_state tool registered in MCP\n- [ ] Returns current state from thread parsing\n- [ ] is_reviewed true for APPROVED/FIXED states\n- [ ] Includes reviewer name if claimed","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:33:29.669098+05:30","updated_at":"2025-12-23T00:22:43.559484+05:30","closed_at":"2025-12-20T00:50:51.967863+05:30","dependencies":[{"issue_id":"mcpmail-45","depends_on_id":"mcpmail-112","type":"blocks","created_at":"2025-12-19T18:36:25.176085+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-46","title":"ORCH-7: Add claim_review MCP tool for atomic review claiming","description":"## Summary\nMCP tool that atomically claims a review to prevent duplicate reviews.\n\n## Tool Signature\n```rust\n#[tool(description = \"Claim a pending review (sends [REVIEWING] message)\")]\nasync fn claim_review(\n    project_slug: String,\n    message_id: i64,  // The [COMPLETION] message to review\n    reviewer_name: String,\n) -\u003e Result\u003cClaimResult\u003e\n\npub struct ClaimResult {\n    pub success: bool,\n    pub thread_id: String,\n    pub claimed_by: Option\u003cString\u003e,  // If already claimed\n}\n```\n\n## Logic\n1. Get thread for message\n2. Check if already claimed ([REVIEWING] exists)\n3. If not claimed, send [REVIEWING] reply\n4. Return success/failure with claimer info\n\n## Acceptance Criteria\n- [ ] Atomic claim prevents race conditions\n- [ ] Returns claimed_by if already taken\n- [ ] Sends [REVIEWING] message on success","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T18:35:24.954576+05:30","updated_at":"2025-12-23T00:22:43.559885+05:30","closed_at":"2025-12-20T00:50:52.208279+05:30","dependencies":[{"issue_id":"mcpmail-46","depends_on_id":"mcpmail-112","type":"blocks","created_at":"2025-12-19T18:36:25.234792+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-47","title":"P1: Add Referrer-Policy security header","description":"## Summary\nAdd Referrer-Policy header to lib-server security middleware.\n\n## Implementation\n```rust\n.layer(SetResponseHeaderLayer::overriding(\n    HeaderName::from_static(\"referrer-policy\"),\n    HeaderValue::from_static(\"strict-origin-when-cross-origin\"),\n))\n```\n\n## Location\ncrates/libs/lib-server/src/lib.rs lines 125-139 (existing security headers)\n\n## Acceptance Criteria\n- [ ] Referrer-Policy header added\n- [ ] Value: strict-origin-when-cross-origin (recommended)\n- [ ] cargo test passes\n- [ ] Verify header with curl -I\n\n## Reference\nproduction-hardening-backend skill: OWASP Security Headers","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T19:03:38.992723+05:30","updated_at":"2025-12-23T00:22:43.560241+05:30","closed_at":"2025-12-20T04:21:23.927976+05:30"}
{"id":"mcpmail-48","title":"LEPTOS-004: Attachments Page","description":"## Summary\nCreate dedicated attachments browser page. APIs exist: `/api/attachments`, `/api/attachment/{id}`, `/api/attachment/download/{id}`.\n\n## Implementation\nCreate: `pages/attachments.rs`\n\nRoute: `/attachments`\n\n## Acceptance Criteria\n- [ ] Route /attachments accessible from nav\n- [ ] Grid layout with file type icons\n- [ ] Filter by project/agent\n- [ ] Sort by date/size/name\n- [ ] Download button per item (\u003e= 44x44px)\n- [ ] Preview modal for images/PDFs\n- [ ] Empty state component\n- [ ] Skeleton loading (3x3 grid)\n- [ ] Responsive: 1 col mobile, 2 tablet, 3 desktop\n- [ ] All buttons \u003e= 44x44px\n\n## Quality Gates\n- LCP \u003c= 2.5s with 10 attachments\n- CLS = 0 during image load (reserved height)\n- Screen reader announces file type, name, size\n\n## Reference Skills\n- shadcn-ui: Card, Skeleton components\n- mobile-frontend-design: Responsive grid, touch targets\n- production-hardening-frontend: Performance budgets","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T22:03:37.056818+05:30","updated_at":"2025-12-23T00:22:43.560586+05:30","closed_at":"2025-12-20T02:36:47.189984+05:30","dependencies":[{"issue_id":"mcpmail-48","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:10.762322+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-48","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:10.81689+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-48","depends_on_id":"mcpmail-49","type":"blocks","created_at":"2025-12-19T22:07:17.085788+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-49","title":"LEPTOS-007: Cursor-Based Pagination Component","description":"## Summary\nCreate reusable pagination component using cursor-based approach (not offset).\n\n## Implementation\nCreate: `components/pagination.rs`\n\n```rust\n#[component]\npub fn Pagination(\n    #[prop(into)] cursor: MaybeProp\u003cString\u003e,\n    #[prop(into)] has_more: Signal\u003cbool\u003e,\n    #[prop(into)] total: MaybeProp\u003ci64\u003e,\n    #[prop(into)] on_load_more: Callback\u003cString\u003e,\n) -\u003e impl IntoView\n```\n\n## Acceptance Criteria\n- [ ] Pagination component with cursor: Option\u003cString\u003e prop\n- [ ] \"Load More\" button (infinite scroll optional)\n- [ ] Shows count: \"Showing X of Y\"\n- [ ] Preserves URL state (?cursor=xxx)\n- [ ] Loading indicator during fetch\n- [ ] End-of-list detection\n- [ ] Button \u003e= 44x44px\n\n## Quality Gates\n- Works with MessageList, AttachmentGrid, ThreadList\n- No duplicate items on cursor change\n- aria-live=\"polite\" announces new items\n\n## Reference Skills\n- shadcn-ui: Button component\n- rust-skills: Generic component props","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T22:03:55.336352+05:30","updated_at":"2025-12-23T00:22:43.56095+05:30","closed_at":"2025-12-20T03:10:50.820612+05:30","dependencies":[{"issue_id":"mcpmail-49","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:11.084341+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-49","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:11.137494+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-5","title":"GAP: GitHub Pages Deployment Wizard","description":"## Problem\nPython has automated GitHub Pages deployment. Rust has no equivalent.\n\n## Python Features\n- Automated repo creation\n- Branch setup (gh-pages)\n- Pages enablement via GitHub API\n- Cloudflare Pages alternative\n\n## Implementation\n- Add share deploy github-pages subcommand\n- Use octocrab crate for GitHub API\n- Create repo, push bundle, enable Pages","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T18:00:35.751436+05:30","updated_at":"2025-12-23T00:22:43.546412+05:30","closed_at":"2025-12-22T04:45:42.090279+05:30"}
{"id":"mcpmail-50","title":"Refactor lib-mcp/src/tools.rs (Grade C -\u003e B+)","description":"Phase 1 complete: Extracted params.rs (770 lines). Remaining: Phase 2 (helpers), Phase 3 (domain modules), Phase 4 (tests). mod.rs reduced from 6376 to 5618 lines.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T16:44:44.178133+05:30","updated_at":"2025-12-23T00:22:43.561318+05:30","closed_at":"2025-12-20T19:51:46.199806+05:30"}
{"id":"mcpmail-51","title":"SVELTE-006: Implement /thread/[id] page","description":"## Summary\nCreate thread conversation view matching Python reference.\n\n## Implementation\n**File**: `src/routes/thread/[id]/+page.svelte`\n\n### Features\n- Fetch thread via POST /api/thread with thread_id\n- Display messages in chronological order\n- Show thread participants\n- Reply functionality\n- Back navigation preserving inbox state\n\n### Components\n- ThreadHeader.svelte (subject, participants, count)\n- ThreadMessage.svelte (individual message in thread)\n- ThreadReply.svelte (reply composer)\n\n## Reference Files\n- Python: mcp_agent_mail/templates/ (thread view patterns)\n- Leptos: crates/services/web-ui-leptos/src/pages/thread.rs\n- API: POST /api/thread\n\n## Acceptance Criteria\n- [ ] Route: /thread/[id] with dynamic segment\n- [ ] Messages displayed chronologically\n- [ ] Thread depth visualization\n- [ ] Reply button opens composer\n- [ ] Back button returns to inbox\n- [ ] Keyboard: Esc to go back\n- [ ] Mobile responsive\n\n## Quality Gates\n- Handles 50+ message threads without jank\n- VoiceOver announces thread structure","notes":"Claimed by agent CrimsonFalcon","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-22T05:35:57.574617+05:30","updated_at":"2025-12-23T03:06:22.871966+05:30","closed_at":"2025-12-23T03:06:22.871966+05:30","dependencies":[{"issue_id":"mcpmail-51","depends_on_id":"mcpmail-4","type":"blocks","created_at":"2025-12-22T05:40:26.946932+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-51","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:55.902928+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-52","title":"SVELTE-008: Expand API client with all endpoints","description":"## Summary\nExpand TypeScript API client to cover all backend endpoints.\n\n## Implementation\n**File**: `src/lib/api/client.ts`\n\n### New Endpoints\n```typescript\n// Unified Inbox\nexport async function fetchUnifiedInbox(limit = 1000): Promise\u003cUnifiedInboxResponse\u003e\n\n// Threads\nexport async function getThread(projectSlug: string, threadId: string): Promise\u003cThread\u003e\n\n// Search\nexport async function searchMessages(query: string, projectSlug?: string): Promise\u003cMessage[]\u003e\n\n// File Reservations\nexport async function listFileReservations(projectSlug: string): Promise\u003cFileReservation[]\u003e\n\n// Attachments\nexport async function listAttachments(projectSlug: string): Promise\u003cAttachment[]\u003e\n\n// Mark read\nexport async function markMessagesRead(messageIds: number[], agentName: string): Promise\u003cvoid\u003e\n```\n\n**File**: `src/lib/api/types.ts`\n```typescript\nexport interface Message { id, project_slug, sender, recipients, thread_id, subject, body_md, importance, created_ts, created_relative, excerpt }\nexport interface Thread { id, subject, messages, participants }\nexport interface FileReservation { id, agent_name, path_pattern, exclusive, expires_ts }\nexport interface Attachment { id, filename, mime_type, size_bytes }\n```\n\n## Reference Files\n- Existing: src/lib/api/client.ts\n- OpenAPI: /api-docs/openapi.json\n- Python: mcp_agent_mail/http.py\n\n## Acceptance Criteria\n- [ ] All 10+ endpoints implemented\n- [ ] TypeScript types match API responses\n- [ ] Error handling with typed errors\n- [ ] Request timeout handling\n- [ ] No any types\n\n## Quality Gates\n- bun run check passes\n- Integration tests with mock server","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T05:36:08.279682+05:30","updated_at":"2025-12-23T01:00:49.728544+05:30","closed_at":"2025-12-23T01:00:49.728544+05:30","dependencies":[{"issue_id":"mcpmail-52","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:06.153451+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-53","title":"Messaging: reply_message tool","description":"Reply to existing thread with proper threading","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:13:48.268566+05:30","updated_at":"2025-12-23T00:22:43.562349+05:30","closed_at":"2025-12-09T03:59:26.196773+05:30","labels":["mcp-tool","messaging"],"dependencies":[{"issue_id":"mcpmail-53","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:13:48.268922+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-54","title":"Add skip link for keyboard accessibility","description":"Add skip-to-content link in +layout.svelte for keyboard users to bypass navigation. Uses sr-only class with focus:not-sr-only pattern.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T02:45:32.040488+05:30","updated_at":"2025-12-23T00:22:43.562674+05:30","closed_at":"2025-12-15T18:44:40.073502+05:30","dependencies":[{"issue_id":"mcpmail-54","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:32.040971+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-55","title":"P2: Monitor RSA CVE-2023-0071 and evaluate ed25519 migration","description":"cargo audit shows RUSTSEC-2023-0071: RSA timing sidechannel (severity 5.9 Medium). No fix available upstream. Dependency path: rsa 0.9.9 → lib-server → mcp-agent-mail. Options: 1) Monitor for upstream fix, 2) Evaluate replacing RSA with ed25519 for JWT signing, 3) Add deny.toml entry to acknowledge. Action: Create tracking issue, add cargo-deny ignore with justification, evaluate ed25519-dalek as replacement.","notes":"2025-12-22: Reviewed - No upstream fix available. Not directly exploitable in our context (JWT signing only). Demoted to P4 backlog. Will monitor for upstream resolution.","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-17T20:52:46.882116+05:30","updated_at":"2025-12-23T00:22:43.564936+05:30"}
{"id":"mcpmail-56","title":"P0: Implement proper MCP JSON-RPC endpoint in lib-server","description":"The /mcp endpoint in lib-server is a stub returning 'not yet implemented'. lib-mcp has a full MCP implementation using rmcp (StreamableHttpService). Need to integrate lib-mcp's AgentMailService into lib-server to provide proper JSON-RPC 2.0 MCP protocol support for tools/list and tools/call methods.","status":"closed","issue_type":"feature","created_at":"2025-12-16T15:55:16.02409+05:30","updated_at":"2025-12-23T00:22:43.565419+05:30","closed_at":"2025-12-17T00:29:38.322475+05:30"}
{"id":"mcpmail-57","title":"Improve rustdoc coverage to 50%","description":"## Objective\nImprove rustdoc coverage from ~25% to 50% across lib-core.\n\n## Efficiency Guide\n1. **Read file** → Add module-level `//!` docs + struct/field `///` docs\n2. **Batch by theme**: Do all model/*.rs together, all store/*.rs together\n3. **Copy patterns**: Use existing documented files as templates\n\n## Completed (Session 2)\n- [x] agent.rs - module docs, Agent/AgentForCreate/AgentProfileUpdate structs\n- [x] project.rs - module docs, Project struct, Git archive docs\n- [x] activity.rs - module docs, ActivityItem struct\n- [x] attachment.rs - module docs, Attachment/AttachmentForCreate structs\n- [x] tool_metric.rs - module docs with example, ToolMetric/ToolMetricForCreate/ToolStat\n- [x] build_slot.rs - module docs with coordination pattern, BuildSlot/BuildSlotForCreate\n- [x] message.rs - module docs added (partial - structs pending)\n\n## Remaining Model Files\n- [ ] message.rs - Message/MessageForCreate/ThreadSummary struct docs\n- [ ] macro_def.rs - module + MacroDef/MacroDefForCreate docs\n- [ ] file_reservation.rs - module + FileReservation/FileReservationForCreate docs\n- [ ] message_recipient.rs - module + MessageRecipient docs\n- [ ] agent_capabilities.rs\n- [ ] agent_link.rs\n- [ ] export.rs\n- [ ] product.rs\n- [ ] project_sibling_suggestion.rs\n- [ ] precommit_guard.rs\n- [ ] overseer_message.rs\n\n## Other Modules to Document\n- store/*.rs (git_store, etc.)\n- utils/*.rs\n- ctx.rs\n\n## Doc Template\n```rust\n//! Brief one-line description.\n//!\n//! Longer explanation of what this module does.\n//!\n//! # Example\n//! // usage example\n\n/// Struct description.\n/// # Fields\n/// - \\`field\\` - What it does\npub struct Foo { ... }\n```","notes":"Session 2: Documented model submodules - agent.rs, project.rs, activity.rs, attachment.rs, tool_metric.rs, build_slot.rs. Now at ~100 documented public items.","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-18T03:25:13.397666+05:30","updated_at":"2025-12-23T00:22:43.565757+05:30"}
{"id":"mcpmail-58","title":"P0: Complete MCP STDIO mode with full tool parity","description":"mcp-stdio crate exists but needs full tool implementation matching HTTP API. Must support same 47 tool signatures. Required for direct Claude Desktop integration without HTTP proxy.","status":"closed","issue_type":"task","created_at":"2025-12-12T10:23:21.360544+05:30","updated_at":"2025-12-23T00:22:43.566011+05:30","closed_at":"2025-12-15T17:47:43.815561+05:30","dependencies":[{"issue_id":"mcpmail-58","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:23:21.361294+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-59","title":"P0: Create integration scripts for coding agents (8 scripts)","description":"Port 8 integration scripts from Python: integrate_claude_code.sh (11KB), integrate_codex_cli.sh (6KB), integrate_cursor.sh (6KB), integrate_cline.sh (6KB), integrate_windsurf.sh (6KB), integrate_gemini_cli.sh (7KB), integrate_github_copilot.sh (9KB), integrate_opencode.sh (8KB). Also create auto-detect script. Update config paths for Rust binary.","status":"closed","issue_type":"task","created_at":"2025-12-12T10:23:21.073158+05:30","updated_at":"2025-12-23T00:22:43.566283+05:30","closed_at":"2025-12-15T17:47:43.860792+05:30","dependencies":[{"issue_id":"mcpmail-59","depends_on_id":"mcpmail-400","type":"blocks","created_at":"2025-12-12T10:23:21.074876+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-5vxz","title":"Migrate BMC structs to newtypes (ProjectId, AgentId, MessageId)","description":"Migrate BMC layer to use newtypes (ProjectId, AgentId, MessageId, ThreadId) instead of raw i64/String. This affects 31 files, ~400 lines changed. Newtypes already defined in lib-core/src/types.rs. Key structs: MessageForCreate, AgentForCreate. Benefits: Compile-time type safety preventing ID mix-ups.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-24T02:09:19.769096+05:30","updated_at":"2025-12-24T02:09:27.493124+05:30"}
{"id":"mcpmail-6","title":"Create visual regression baseline screenshots with dev-browser","description":"## Summary\nCreate baseline screenshots at key viewports for visual regression testing.\n\n## Implementation Details\n\n### Test Script (dev-browser)\n```typescript\nconst viewports = [\n  { name: \"mobile\", width: 375, height: 667 },\n  { name: \"tablet\", width: 768, height: 1024 },\n  { name: \"desktop\", width: 1440, height: 900 },\n];\n\nconst pages = [\"/\", \"/projects\", \"/inbox\", \"/agents\"];\n\nfor (const vp of viewports) {\n  await page.setViewportSize({ width: vp.width, height: vp.height });\n  for (const path of pages) {\n    await page.goto(\\`http://localhost:8080\\${path}\\`);\n    await waitForPageLoad(page);\n    await page.screenshot({\n      path: \\`baselines/\\${vp.name}-\\${path.replace('/', 'home')}.png\\`\n    });\n  }\n}\n```\n\n## Files Created\n- baselines/mobile-home.png\n- baselines/mobile-projects.png\n- baselines/mobile-inbox.png\n- baselines/mobile-agents.png\n- baselines/tablet-*.png\n- baselines/desktop-*.png\n\n## Acceptance Criteria\n- [ ] Baselines created for 4 pages × 3 viewports = 12 screenshots\n- [ ] Screenshots stored in baselines/ directory\n- [ ] Script documented for CI integration\n- [ ] No visual regressions from current state","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T23:13:03.636251+05:30","updated_at":"2025-12-23T00:22:43.546682+05:30","closed_at":"2025-12-19T01:58:08.746686+05:30","dependencies":[{"issue_id":"mcpmail-6","depends_on_id":"mcpmail-255","type":"blocks","created_at":"2025-12-18T23:13:51.093748+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-60","title":"P0: Port MessageDetail page with reply flow","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:39.578672+05:30","updated_at":"2025-12-23T00:22:43.566584+05:30","closed_at":"2025-12-12T00:53:32.65988+05:30","dependencies":[{"issue_id":"mcpmail-60","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.489736+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-60","depends_on_id":"mcpmail-311","type":"blocks","created_at":"2025-12-11T23:40:25.686291+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-61","title":"Report pmat CHANGELOG.md detection bug","description":"pmat rust-project-score does not detect existing CHANGELOG.md file. Recommends 'Add CHANGELOG.md' despite file existing at project root in Keep a Changelog format. Documentation category gets 7/15 points (should be 10/15 with changelog). Low priority - external tool bug.","notes":"Verified: CHANGELOG.md format matches Keep a Changelog 1.1.0 exactly. Compared against pmcp SDK changelog (1.0.0 format). Both have identical structure - header, SemVer reference, version sections. This is a confirmed pmat detection bug, not a format issue.","status":"open","priority":4,"issue_type":"bug","created_at":"2025-12-18T03:52:16.661174+05:30","updated_at":"2025-12-23T00:22:43.566861+05:30"}
{"id":"mcpmail-62","title":"P0: Port Inbox page with cascading selects","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:39.445973+05:30","updated_at":"2025-12-23T00:22:43.567075+05:30","closed_at":"2025-12-12T00:45:26.506572+05:30","dependencies":[{"issue_id":"mcpmail-62","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.401797+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-62","depends_on_id":"mcpmail-64","type":"blocks","created_at":"2025-12-11T23:40:25.594382+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-63","title":"P0: Port ProjectDetail page with agent registration","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:39.378418+05:30","updated_at":"2025-12-23T00:22:43.567352+05:30","closed_at":"2025-12-12T00:41:29.861973+05:30","dependencies":[{"issue_id":"mcpmail-63","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.357447+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-63","depends_on_id":"mcpmail-64","type":"blocks","created_at":"2025-12-11T23:40:25.549884+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-64","title":"P0: Port Projects page with create form (ActionForm)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:39.311672+05:30","updated_at":"2025-12-23T00:22:43.567601+05:30","closed_at":"2025-12-12T00:28:29.238238+05:30","dependencies":[{"issue_id":"mcpmail-64","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.31207+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-64","depends_on_id":"mcpmail-65","type":"blocks","created_at":"2025-12-11T23:40:25.507765+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-65","title":"P0: Port Dashboard page with health/project cards","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:34.33921+05:30","updated_at":"2025-12-23T00:22:43.567878+05:30","closed_at":"2025-12-12T00:26:23.483175+05:30","dependencies":[{"issue_id":"mcpmail-65","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.265713+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-65","depends_on_id":"mcpmail-312","type":"blocks","created_at":"2025-12-11T23:40:25.41698+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-65","depends_on_id":"mcpmail-66","type":"blocks","created_at":"2025-12-11T23:40:25.463584+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-66","title":"P0: Implement Layout component (nav, dark mode)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:34.278005+05:30","updated_at":"2025-12-23T00:22:43.568171+05:30","closed_at":"2025-12-12T00:22:41.870638+05:30","dependencies":[{"issue_id":"mcpmail-66","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.2185+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-66","depends_on_id":"mcpmail-68","type":"blocks","created_at":"2025-12-11T23:40:25.371747+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-67","title":"Phase 5: Production Hardening","description":"JWT/bearer token authentication. Rate limiting. Structured logging with tracing. Prometheus metrics. Docker multi-stage build. CI/CD pipeline. Load testing.","status":"closed","priority":3,"issue_type":"epic","created_at":"2025-12-09T01:40:02.951173+05:30","updated_at":"2025-12-23T00:22:43.568441+05:30","closed_at":"2025-12-09T05:40:39.395188+05:30"}
{"id":"mcpmail-68","title":"P0: Setup Tailwind CSS build pipeline for Leptos","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:34.140615+05:30","updated_at":"2025-12-23T00:22:43.568712+05:30","closed_at":"2025-12-12T00:22:13.035835+05:30","dependencies":[{"issue_id":"mcpmail-68","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.123895+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-68","depends_on_id":"mcpmail-69","type":"blocks","created_at":"2025-12-11T23:40:25.276295+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-69","title":"P0: Create web-ui-leptos crate scaffold with Trunk","status":"closed","issue_type":"task","created_at":"2025-12-11T23:39:34.072032+05:30","updated_at":"2025-12-23T00:22:43.568993+05:30","closed_at":"2025-12-12T00:13:22.889596+05:30","dependencies":[{"issue_id":"mcpmail-69","depends_on_id":"mcpmail-177","type":"blocks","created_at":"2025-12-11T23:40:04.072724+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-6fub","title":"[P2] Add readiness probe with database connectivity check","description":"## Problem\nCurrent `/api/health` only returns `{ \"status\": \"ok\" }` without verifying \nactual service readiness (database connectivity, required services).\n\n## Current Endpoint\n```rust\n// lib-server/src/tools.rs\npub async fn health_check() -\u003e impl IntoResponse {\n    Json(json!({ \"status\": \"ok\" }))\n}\n```\n\n## Kubernetes Probe Model\n- **Liveness**: Is the process running? (current `/api/health`)\n- **Readiness**: Can the service handle requests? (NEW `/api/ready`)\n\n## TDD Acceptance Criteria\n\n### RED Phase - Readiness Tests\n```rust\n// lib-server/tests/health_tests.rs\n\n#[tokio::test]\nasync fn test_ready_endpoint_checks_database() {\n    let app = test_app().await;\n    \n    let resp = app.get(\"/api/ready\").send().await;\n    assert_eq!(resp.status(), StatusCode::OK);\n    \n    let body: serde_json::Value = resp.json().await;\n    assert_eq!(body[\"status\"], \"ready\");\n    assert!(body[\"checks\"][\"database\"][\"ok\"].as_bool().unwrap());\n    assert!(body[\"checks\"][\"database\"][\"latency_ms\"].as_u64().is_some());\n}\n\n#[tokio::test]\nasync fn test_ready_returns_503_when_db_unavailable() {\n    let app = test_app_with_broken_db().await;\n    \n    let resp = app.get(\"/api/ready\").send().await;\n    assert_eq!(resp.status(), StatusCode::SERVICE_UNAVAILABLE);\n    \n    let body: serde_json::Value = resp.json().await;\n    assert_eq!(body[\"status\"], \"not_ready\");\n    assert!(!body[\"checks\"][\"database\"][\"ok\"].as_bool().unwrap());\n    assert!(body[\"checks\"][\"database\"][\"error\"].is_string());\n}\n\n#[tokio::test]\nasync fn test_health_always_returns_200() {\n    // Liveness probe should always succeed if process is running\n    let app = test_app_with_broken_db().await;\n    \n    let resp = app.get(\"/api/health\").send().await;\n    assert_eq!(resp.status(), StatusCode::OK);\n}\n\n#[tokio::test]\nasync fn test_ready_includes_version_info() {\n    let app = test_app().await;\n    \n    let resp = app.get(\"/api/ready\").send().await;\n    let body: serde_json::Value = resp.json().await;\n    \n    assert!(body[\"version\"].is_string());\n    assert!(body[\"uptime_seconds\"].as_u64().is_some());\n}\n```\n\n### GREEN Phase - Implementation\n```rust\n// lib-server/src/tools/health.rs\n\nuse std::time::{Duration, Instant};\nuse lazy_static::lazy_static;\n\nlazy_static! {\n    static ref START_TIME: Instant = Instant::now();\n}\n\n#[derive(Serialize)]\nstruct ReadinessResponse {\n    status: \u0026'static str,\n    version: \u0026'static str,\n    uptime_seconds: u64,\n    checks: ReadinessChecks,\n}\n\n#[derive(Serialize)]\nstruct ReadinessChecks {\n    database: CheckResult,\n}\n\n#[derive(Serialize)]\nstruct CheckResult {\n    ok: bool,\n    latency_ms: Option\u003cu64\u003e,\n    error: Option\u003cString\u003e,\n}\n\npub async fn readiness_check(\n    State(state): State\u003cAppState\u003e,\n) -\u003e impl IntoResponse {\n    let db_check = check_database(\u0026state.mm).await;\n    \n    let all_ok = db_check.ok;\n    let status = if all_ok { \"ready\" } else { \"not_ready\" };\n    let http_status = if all_ok { \n        StatusCode::OK \n    } else { \n        StatusCode::SERVICE_UNAVAILABLE \n    };\n    \n    let response = ReadinessResponse {\n        status,\n        version: env!(\"CARGO_PKG_VERSION\"),\n        uptime_seconds: START_TIME.elapsed().as_secs(),\n        checks: ReadinessChecks {\n            database: db_check,\n        },\n    };\n    \n    (http_status, Json(response))\n}\n\nasync fn check_database(mm: \u0026ModelManager) -\u003e CheckResult {\n    let start = Instant::now();\n    \n    match mm.db().execute(\"SELECT 1\", []).await {\n        Ok(_) =\u003e CheckResult {\n            ok: true,\n            latency_ms: Some(start.elapsed().as_millis() as u64),\n            error: None,\n        },\n        Err(e) =\u003e CheckResult {\n            ok: false,\n            latency_ms: None,\n            error: Some(e.to_string()),\n        },\n    }\n}\n\n// Keep existing liveness probe simple\npub async fn liveness_check() -\u003e impl IntoResponse {\n    Json(json!({ \"status\": \"ok\" }))\n}\n```\n\n### REFACTOR Phase - Route Setup\n```rust\n// lib-server/src/api.rs\n.route(\"/api/health\", get(tools::liveness_check))\n.route(\"/api/ready\", get(tools::readiness_check))\n.route(\"/api/readiness\", get(tools::readiness_check)) // Alias\n```\n\n## Expected Response Format\n```json\n{\n  \"status\": \"ready\",\n  \"version\": \"0.1.0\",\n  \"uptime_seconds\": 3600,\n  \"checks\": {\n    \"database\": {\n      \"ok\": true,\n      \"latency_ms\": 2\n    }\n  }\n}\n```\n\n## Checklist\n- [ ] Write failing test for /api/ready returns DB status\n- [ ] Write failing test for /api/ready returns 503 when DB down\n- [ ] Write failing test for /api/health always returns 200\n- [ ] Write failing test for version/uptime in response\n- [ ] Implement check_database() function\n- [ ] Implement readiness_check() handler\n- [ ] Add routes to api.rs\n- [ ] Update Kubernetes manifests (if applicable)\n- [ ] Document in API docs\n- [ ] All tests pass\n\n## Files to Create\n- `lib-server/src/tools/health.rs`\n- `lib-server/tests/health_tests.rs`\n\n## Files to Modify\n- `lib-server/src/api.rs`\n- `lib-server/src/tools/mod.rs`","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-24T04:58:32.380373+05:30","updated_at":"2025-12-24T04:58:32.380373+05:30"}
{"id":"mcpmail-7","title":"Run accessibility audit on all pages using dev-browser","description":"## Summary\nRun comprehensive accessibility audit on all pages and fix any issues found.\n\n## Implementation Details\n\n### Audit Script (dev-browser)\nTest for:\n- Images without alt text\n- Buttons without accessible names\n- Inputs without labels\n- Touch targets \u003c 44×44px\n\n### Pages to Audit\n- /\n- /projects\n- /inbox\n- /agents\n\n## Acceptance Criteria\n- [ ] All images have alt text (0 violations)\n- [ ] All buttons have accessible names (0 violations)\n- [ ] All inputs have labels (0 violations)\n- [ ] All touch targets ≥ 44×44px (0 violations)\n- [ ] Audit results documented\n- [ ] Any issues found are fixed","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T23:13:03.87641+05:30","updated_at":"2025-12-23T00:22:43.547009+05:30","closed_at":"2025-12-19T01:58:08.74757+05:30","dependencies":[{"issue_id":"mcpmail-7","depends_on_id":"mcpmail-255","type":"blocks","created_at":"2025-12-18T23:13:51.143854+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-70","title":"P0: Implement core user flow tests (UF-001 to UF-004)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:27.160308+05:30","updated_at":"2025-12-23T00:22:43.569256+05:30","closed_at":"2025-12-15T18:44:26.996283+05:30","dependencies":[{"issue_id":"mcpmail-70","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:01.048336+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-70","depends_on_id":"mcpmail-75","type":"blocks","created_at":"2025-12-11T23:34:24.145891+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-71","title":"P0: Implement ComposeMessage modal tests (C-001 to C-012)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:27.10016+05:30","updated_at":"2025-12-23T00:22:43.569497+05:30","closed_at":"2025-12-15T18:44:26.758533+05:30","dependencies":[{"issue_id":"mcpmail-71","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:01.003711+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-71","depends_on_id":"mcpmail-75","type":"blocks","created_at":"2025-12-11T23:34:24.102925+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-72","title":"P0: Implement Inbox E2E tests (I-001 to I-012)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:27.032694+05:30","updated_at":"2025-12-23T00:22:43.569746+05:30","closed_at":"2025-12-15T18:44:26.799322+05:30","dependencies":[{"issue_id":"mcpmail-72","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:00.959945+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-72","depends_on_id":"mcpmail-75","type":"blocks","created_at":"2025-12-11T23:34:24.058409+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-73","title":"P0: Implement Projects E2E tests (P-001 to P-008)","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:20.341452+05:30","updated_at":"2025-12-23T00:22:43.569984+05:30","closed_at":"2025-12-15T18:44:26.838252+05:30","dependencies":[{"issue_id":"mcpmail-73","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:00.915687+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-73","depends_on_id":"mcpmail-75","type":"blocks","created_at":"2025-12-11T23:34:24.015142+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-74","title":"Product: ensure_product","description":"Create or get product for multi-repo coordination","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:10.939493+05:30","updated_at":"2025-12-23T00:22:43.570218+05:30","closed_at":"2025-12-09T05:29:33.698717+05:30","labels":["mcp-tool","product"],"dependencies":[{"issue_id":"mcpmail-74","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:10.940366+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-75","title":"P0: Create Page Object Models for all 6 routes","status":"closed","issue_type":"task","created_at":"2025-12-11T23:33:19.911387+05:30","updated_at":"2025-12-23T00:22:43.570489+05:30","closed_at":"2025-12-15T18:44:26.917338+05:30","dependencies":[{"issue_id":"mcpmail-75","depends_on_id":"mcpmail-393","type":"blocks","created_at":"2025-12-11T23:34:00.822889+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-75","depends_on_id":"mcpmail-373","type":"blocks","created_at":"2025-12-11T23:34:23.917731+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-76","title":"Product: link_project_to_product","description":"Link project to product for unified messaging","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:11.164596+05:30","updated_at":"2025-12-23T00:22:43.570779+05:30","closed_at":"2025-12-09T05:29:33.856502+05:30","labels":["mcp-tool","product"],"dependencies":[{"issue_id":"mcpmail-76","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:11.165142+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-77","title":"Product: unlink_project_from_product","description":"Unlink project from product","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:11.394038+05:30","updated_at":"2025-12-23T00:22:43.571038+05:30","closed_at":"2025-12-09T05:29:34.016477+05:30","labels":["mcp-tool","product"],"dependencies":[{"issue_id":"mcpmail-77","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:11.395012+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-78","title":"Product: list_products","description":"List all products and their linked projects","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:22.067003+05:30","updated_at":"2025-12-23T00:22:43.571318+05:30","closed_at":"2025-12-09T05:29:34.17349+05:30","labels":["mcp-tool","product"],"dependencies":[{"issue_id":"mcpmail-78","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:22.067713+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-79","title":"Product: product_inbox","description":"Product-wide inbox aggregation across repos","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:22.283001+05:30","updated_at":"2025-12-23T00:22:43.571558+05:30","closed_at":"2025-12-09T05:29:34.332013+05:30","labels":["mcp-tool","product"],"dependencies":[{"issue_id":"mcpmail-79","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:22.284681+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-7c5x","title":"P1: Fix 28 async lock guards held across await points","description":"**Issue**: UBS detected 28 instances of async lock guards (MutexGuard, RwLockGuard) held across .await points.\n\n**Risk**: Holding lock guards across await is a common async Rust anti-pattern causing:\n- Deadlocks when other tasks need the same lock\n- Reduced concurrency (lock held during IO waits)\n- Non-Send futures if guards aren't Send\n- Tokio scheduler issues\n\n**Pattern to Fix**:\n```rust\n// BAD: Lock held across await\nlet guard = mutex.lock().await;\ndo_io().await;  // guard still held!\ndrop(guard);\n\n// GOOD: Minimize critical section\n{\n    let guard = mutex.lock().await;\n    let data = guard.clone();\n}  // guard dropped\ndo_io().await;  // lock free\n```\n\n**Fix Strategy**:\n1. Audit all 28 locations identified by UBS\n2. Minimize critical sections - clone data and drop guard before await\n3. Consider restructuring to avoid locks (channels, Arc\u003cRwLock\u003e with read preference)\n4. For legitimate cases, document why lock must be held\n\n**Affected Modules** (likely):\n- Server handlers with database access\n- BMC operations with shared state\n- File system operations with locks\n\n**Test Strategy**:\n- Run tokio-console to detect lock contention\n- Stress test with concurrent requests\n- Add #[tokio::test(flavor = \"multi_thread\")] for deadlock detection\n\n**Severity**: High - concurrency bugs are hard to debug in production","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-24T02:58:49.625539+05:30","updated_at":"2025-12-24T03:50:46.265664+05:30","closed_at":"2025-12-24T03:50:46.265664+05:30","close_reason":"False positive: All 28 lock usages are tokio::sync (async locks), not std::sync. Tokio locks are designed to be held across await points. No std::sync::Mutex or std::sync::RwLock found in codebase."}
{"id":"mcpmail-7sc1","title":"SVELTE-022e: Dashboard Overhaul","description":"shadcn Card, NumberTicker stats, BlurFade entrance, GridPattern background, ShimmerButton CTAs.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T16:57:08.164475+05:30","updated_at":"2025-12-24T03:31:03.058384+05:30","closed_at":"2025-12-24T03:31:03.058384+05:30","close_reason":"Dashboard overhauled with GridPattern background, NumberTicker stats, BlurFade animations, StatusIndicator, and ShimmerButton CTAs","dependencies":[{"issue_id":"mcpmail-7sc1","depends_on_id":"mcpmail-xkde","type":"blocks","created_at":"2025-12-23T16:57:31.31353+05:30","created_by":"amrit"}]}
{"id":"mcpmail-7zb1","title":"[P1] Add search and filter within project/agent lists","description":"## Problem\nWith 275 projects:\n- No search within projects page\n- No filtering by status, date, or agent count\n- Dropdown for project selection has no search\n- Performance issues likely with large unfiltered list\n\n## TDD Acceptance Criteria\n\n### RED Phase - Search/Filter Tests\n```typescript\n// web-ui/tests/list-search.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Project List Search', () =\u003e {\n  test('has search input on projects page', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const search = page.locator('input[placeholder*=\"Search\"]');\n    await expect(search).toBeVisible();\n  });\n\n  test('filters projects by name', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const search = page.locator('input[placeholder*=\"Search\"]');\n    await search.fill('Summary');\n    \n    const cards = page.locator('[data-testid=\"project-card\"]');\n    \n    // All visible cards should contain \"Summary\"\n    for (const card of await cards.all()) {\n      const text = await card.textContent();\n      expect(text?.toLowerCase()).toContain('summary');\n    }\n  });\n\n  test('shows \"no results\" when search has no matches', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const search = page.locator('input[placeholder*=\"Search\"]');\n    await search.fill('xyznonexistent123');\n    \n    await expect(page.getByText(/no projects found/i)).toBeVisible();\n  });\n\n  test('clears search with X button', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const search = page.locator('input[placeholder*=\"Search\"]');\n    await search.fill('test');\n    \n    await page.click('[data-testid=\"clear-search\"]');\n    \n    await expect(search).toHaveValue('');\n  });\n});\n\ntest.describe('Project Dropdown Search', () =\u003e {\n  test('dropdown has search input', async ({ page }) =\u003e {\n    await page.goto('/inbox');\n    \n    await page.click('[data-testid=\"project-select\"]');\n    \n    const dropdownSearch = page.locator('[data-testid=\"dropdown-search\"]');\n    await expect(dropdownSearch).toBeVisible();\n  });\n\n  test('filters dropdown options', async ({ page }) =\u003e {\n    await page.goto('/inbox');\n    \n    await page.click('[data-testid=\"project-select\"]');\n    await page.fill('[data-testid=\"dropdown-search\"]', 'Summary');\n    \n    const options = page.locator('[role=\"option\"]');\n    const count = await options.count();\n    \n    for (let i = 0; i \u003c count; i++) {\n      const text = await options.nth(i).textContent();\n      expect(text?.toLowerCase()).toContain('summary');\n    }\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n**1. Search Input Component**\n```svelte\n\u003c!-- components/ui/search-input.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import Search from 'lucide-svelte/icons/search';\n  import X from 'lucide-svelte/icons/x';\n  \n  export let value = '';\n  export let placeholder = 'Search...';\n  \n  function clear() {\n    value = '';\n  }\n\u003c/script\u003e\n\n\u003cdiv class=\"relative\"\u003e\n  \u003cSearch class=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" /\u003e\n  \u003cinput\n    type=\"text\"\n    bind:value\n    {placeholder}\n    class=\"w-full pl-10 pr-10 py-2 border rounded-lg\"\n  /\u003e\n  {#if value}\n    \u003cbutton \n      class=\"absolute right-3 top-1/2 -translate-y-1/2\"\n      onclick={clear}\n      data-testid=\"clear-search\"\n    \u003e\n      \u003cX class=\"h-4 w-4 text-muted-foreground hover:text-foreground\" /\u003e\n    \u003c/button\u003e\n  {/if}\n\u003c/div\u003e\n```\n\n**2. Projects Page with Search**\n```svelte\n\u003c!-- routes/projects/+page.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { SearchInput } from '$lib/components/ui/search-input';\n  \n  let searchQuery = $state('');\n  \n  // Filter projects client-side\n  let filteredProjects = $derived(\n    projects.filter(p =\u003e \n      p.human_key.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      p.slug.toLowerCase().includes(searchQuery.toLowerCase())\n    )\n  );\n\u003c/script\u003e\n\n\u003cdiv class=\"space-y-4\"\u003e\n  \u003c!-- Header with Search --\u003e\n  \u003cdiv class=\"flex items-center gap-4\"\u003e\n    \u003ch1\u003eProjects\u003c/h1\u003e\n    \u003cSearchInput \n      bind:value={searchQuery}\n      placeholder=\"Search projects...\"\n      class=\"max-w-xs\"\n    /\u003e\n  \u003c/div\u003e\n  \n  \u003c!-- Results --\u003e\n  {#if filteredProjects.length === 0}\n    \u003cdiv class=\"text-center py-12 text-muted-foreground\"\u003e\n      \u003cp\u003eNo projects found matching \"{searchQuery}\"\u003c/p\u003e\n      \u003cbutton onclick={() =\u003e searchQuery = ''} class=\"text-primary\"\u003e\n        Clear search\n      \u003c/button\u003e\n    \u003c/div\u003e\n  {:else}\n    \u003cdiv class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\"\u003e\n      {#each filteredProjects as project}\n        \u003c!-- project card --\u003e\n      {/each}\n    \u003c/div\u003e\n  {/if}\n\u003c/div\u003e\n```\n\n**3. Searchable Select Component**\n```svelte\n\u003c!-- components/ui/searchable-select.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import * as Command from '$lib/components/ui/command';\n  import * as Popover from '$lib/components/ui/popover';\n  \n  export let options: Array\u003c{ value: string; label: string }\u003e = [];\n  export let value = '';\n  export let placeholder = 'Select...';\n  \n  let open = false;\n  let searchQuery = '';\n  \n  $: filteredOptions = options.filter(opt =\u003e\n    opt.label.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\u003c/script\u003e\n\n\u003cPopover.Root bind:open\u003e\n  \u003cPopover.Trigger asChild\u003e\n    \u003cbutton data-testid=\"project-select\"\u003e\n      {options.find(o =\u003e o.value === value)?.label ?? placeholder}\n    \u003c/button\u003e\n  \u003c/Popover.Trigger\u003e\n  \u003cPopover.Content class=\"p-0\"\u003e\n    \u003cCommand.Root\u003e\n      \u003cCommand.Input \n        bind:value={searchQuery}\n        placeholder=\"Search...\"\n        data-testid=\"dropdown-search\"\n      /\u003e\n      \u003cCommand.Empty\u003eNo results found\u003c/Command.Empty\u003e\n      \u003cCommand.Group\u003e\n        {#each filteredOptions as option}\n          \u003cCommand.Item \n            value={option.value}\n            onSelect={() =\u003e { value = option.value; open = false; }}\n          \u003e\n            {option.label}\n          \u003c/Command.Item\u003e\n        {/each}\n      \u003c/Command.Group\u003e\n    \u003c/Command.Root\u003e\n  \u003c/Popover.Content\u003e\n\u003c/Popover.Root\u003e\n```\n\n## Checklist\n- [ ] Write Playwright tests for search functionality\n- [ ] Create SearchInput component\n- [ ] Add search to projects page\n- [ ] Add search to agents page\n- [ ] Create SearchableSelect component\n- [ ] Replace project dropdown in Inbox with SearchableSelect\n- [ ] Add \"no results\" empty state\n- [ ] Add clear search button\n- [ ] Add keyboard navigation (Escape to clear)\n- [ ] All tests pass\n\n## Files to Create\n- `web-ui/src/lib/components/ui/search-input.svelte`\n- `web-ui/src/lib/components/ui/searchable-select.svelte`\n- `web-ui/tests/list-search.spec.ts`\n\n## Files to Modify\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/agents/+page.svelte`\n- `web-ui/src/routes/inbox/+page.svelte`","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T05:06:48.869094+05:30","updated_at":"2025-12-24T05:06:48.869094+05:30"}
{"id":"mcpmail-8","title":"BUG: macro_convenience_tests.rs doesn't compile - missing reqwest dependency","status":"closed","issue_type":"bug","created_at":"2025-12-22T03:05:41.543071+05:30","updated_at":"2025-12-23T00:22:43.547345+05:30","closed_at":"2025-12-22T03:08:52.332335+05:30"}
{"id":"mcpmail-80","title":"Static Export: export_mailbox","description":"Export mailbox to static HTML bundle","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:18:35.358956+05:30","updated_at":"2025-12-23T00:22:43.5718+05:30","closed_at":"2025-12-09T05:36:29.458791+05:30","labels":["export","mcp-tool"],"dependencies":[{"issue_id":"mcpmail-80","depends_on_id":"mcpmail-118","type":"parent-child","created_at":"2025-12-09T03:18:35.359588+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-81","title":"Add product bus tests (multi-repo messaging)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T16:20:42.987707+05:30","updated_at":"2025-12-23T00:22:43.572039+05:30","closed_at":"2025-12-09T16:47:02.454635+05:30","dependencies":[{"issue_id":"mcpmail-81","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:42.988642+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-82","title":"Add export_mailbox tests (HTML, JSON, Markdown output)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T16:20:48.06343+05:30","updated_at":"2025-12-23T00:22:43.572266+05:30","closed_at":"2025-12-09T16:56:02.276048+05:30","dependencies":[{"issue_id":"mcpmail-82","depends_on_id":"mcpmail-229","type":"parent-child","created_at":"2025-12-09T16:20:48.064239+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-83","title":"register_agent should auto-grant default capabilities","description":"MCP tools require capabilities (send_message, fetch_inbox, file_reservation_paths, acknowledge_message) but register_agent doesn't grant them. REST API bypasses checks (RBAC_ENABLED=false), but MCP stdio has hardcoded checks. Fix: auto-grant default capabilities on agent registration.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-22T19:56:48.514978+05:30","updated_at":"2025-12-23T00:22:43.572495+05:30","closed_at":"2025-12-22T20:05:40.280162+05:30"}
{"id":"mcpmail-84","title":"Add Zod schema validation for API responses","description":"Install zod and create src/lib/api/schemas.ts with typed schemas for Project, Agent, Message. Add runtime validation in API client.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-10T02:45:44.212306+05:30","updated_at":"2025-12-23T00:22:43.572704+05:30","closed_at":"2025-12-15T18:44:54.622414+05:30","dependencies":[{"issue_id":"mcpmail-84","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:44.21309+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-85","title":"NTM-003: Implement create_agent_identity tool","description":"Add create_agent_identity to MCP tools (HTTP API exists at lib-server/tools.rs:701).\n\n**Current state:**\n- HTTP API implementation EXISTS at lib-server/tools.rs:701-734\n- Name generation with ADJECTIVES/NOUNS lists exists\n- Hint matching logic exists\n- NOT exposed as MCP tool - needs to be added to lib-mcp\n\n**Difference from register_agent:**\n- register_agent: Upserts (creates or updates existing)\n- create_agent_identity: ALWAYS creates NEW unique agent\n\n**HTTP API (lib-server/tools.rs):**\n```rust\n// Already implemented:\n- generate_random_names() - adjective+noun generation\n- find_hint_match() - validates hint against wordlist  \n- CreateAgentIdentityPayload { project_slug, hint }\n- Returns { suggested_name, alternatives: Vec\u003cString\u003e }\n```\n\n**MCP Tool needed:**\nWrap existing logic from lib-server/tools.rs and add agent creation:\n```rust\n#[tool(description = \"Create a new unique agent identity with auto-generated name.\")]\nasync fn create_agent_identity(\n    \u0026self,\n    params: Parameters\u003cCreateAgentIdentityParams\u003e,\n) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    // 1. Generate unique name using existing logic\n    // 2. Create agent with AgentBmc::create (NOT upsert)\n    // 3. Return agent profile\n}\n```\n\n**Acceptance Criteria:**\n- [ ] Move name generation to lib-core (shared between HTTP and MCP)\n- [ ] Add create_agent_identity to lib-mcp tools\n- [ ] Schema added to get_all_tool_schemas()\n- [ ] Tests added\n\n**Reference Files:**\n- lib-server/src/tools.rs:624-734 (existing HTTP impl)\n- lib-mcp/src/tools/agent.rs (add MCP impl)\n- lib-mcp/src/tools/mod.rs:82 (add schema)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T06:39:41.935397+05:30","updated_at":"2025-12-23T00:22:43.572958+05:30","closed_at":"2025-12-22T22:24:22.180049+05:30","dependencies":[{"issue_id":"mcpmail-85","depends_on_id":"mcpmail-387","type":"blocks","created_at":"2025-12-22T06:58:19.407103+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-86","title":"Add lucide-svelte icons to replace emoji icons","description":"Install lucide-svelte and replace emoji icons in sidebar navigation with proper SVG icons for better rendering and accessibility.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-10T02:45:44.618069+05:30","updated_at":"2025-12-23T00:22:43.573255+05:30","closed_at":"2025-12-15T18:44:27.726075+05:30","dependencies":[{"issue_id":"mcpmail-86","depends_on_id":"mcpmail-297","type":"blocks","created_at":"2025-12-10T02:45:44.618592+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-87","title":"Create .clippy.toml configuration","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:41:39.816586+05:30","updated_at":"2025-12-23T00:22:43.573484+05:30","closed_at":"2025-12-17T16:52:41.618304+05:30"}
{"id":"mcpmail-88","title":"P3: Improve rustdoc coverage from 33% to 70%","description":"PMAT rust-project-score shows Documentation at 5/15 (33.3%). Target: 70%. Focus areas: 1) lib-core BMC methods (public API), 2) lib-mcp tool functions (50+ tools), 3) lib-server endpoints (REST handlers). Add /// doc comments with examples. Run: cargo doc --document-private-items, check coverage. Include code examples that serve as additional test coverage.","notes":"Session total: ~750 lines of rustdoc added across 6 BMC files + crate docs. Current PMAT: still 46.7%. May need more files or different approach to move score.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T20:53:08.265279+05:30","updated_at":"2025-12-23T00:22:43.573725+05:30","closed_at":"2025-12-17T22:58:38.183501+05:30"}
{"id":"mcpmail-89","title":"SVELTE-007: Implement /search page","description":"## Summary\nCreate global search page with filters.\n\n## Implementation\n**File**: `src/routes/search/+page.svelte`\n\n### Features\n- Search input with debounce (300ms)\n- Filter by project, sender, importance\n- Results with highlighted matches\n- Click to navigate to message\n\n### API\nPOST /api/message/search with query, project_slug\n\n## Reference Files\n- Leptos: crates/services/web-ui-leptos/src/pages/search.rs\n- API: POST /api/message/search\n\n## Acceptance Criteria\n- [ ] Search input with debounce\n- [ ] Results show highlighted matches\n- [ ] Filter dropdowns work\n- [ ] Click navigates to message\n- [ ] Empty state with suggestions\n- [ ] Loading state with skeleton","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-22T05:36:02.890347+05:30","updated_at":"2025-12-23T02:42:04.343096+05:30","closed_at":"2025-12-23T02:42:04.343096+05:30","dependencies":[{"issue_id":"mcpmail-89","depends_on_id":"mcpmail-52","type":"blocks","created_at":"2025-12-22T05:40:32.122706+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-89","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:42:01.02719+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-8dqi","title":"SVELTE-022a: Design System Foundation","description":"Unified tokens: app.css spacing/animations/status colors/shadows, tailwind.config.js keyframes, prefers-reduced-motion.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T16:56:37.34244+05:30","updated_at":"2025-12-23T17:11:41.525773+05:30","closed_at":"2025-12-23T17:11:41.525773+05:30"}
{"id":"mcpmail-8yc8","title":"P2: Replace 24 serde_json::from_str().unwrap() calls with error handling","description":"**Issue**: UBS found 24 instances of `serde_json::from_str(...).unwrap()` which panic on invalid JSON.\n\n**Risk**:\n- Panics in production on malformed input\n- Denial of service via crafted payloads\n- Poor user experience with cryptic error messages\n- Violates Rust best practices for library code\n\n**Pattern to Fix**:\n```rust\n// BAD: Panics on invalid JSON\nlet data: MyStruct = serde_json::from_str(input).unwrap();\n\n// GOOD: Proper error handling\nlet data: MyStruct = serde_json::from_str(input)\n    .map_err(|e| Error::InvalidJson { \n        source: e,\n        context: \"parsing user config\"\n    })?;\n\n// ALTERNATIVE: With default fallback\nlet data = serde_json::from_str(input).unwrap_or_default();\n```\n\n**Fix Strategy**:\n1. Identify all 24 locations via: `rg 'from_str.*unwrap' --type rust`\n2. Categorize by context:\n   - **External input**: Must use `?` with proper error type\n   - **Internal/trusted**: Can use `.expect(\"invariant: ...\")\"\n   - **Tests**: `.unwrap()` acceptable with good test names\n3. Create custom error variants for JSON parsing failures\n4. Add context to errors for debugging\n\n**Priority Order**:\n1. HTTP handlers (external input) - Critical\n2. File loading (semi-trusted) - High\n3. Internal serialization (trusted) - Medium\n\n**Test Strategy**:\n- Add tests with malformed JSON inputs\n- Fuzz test JSON parsing endpoints\n- Verify error messages are user-friendly\n\n**Severity**: Medium - crash risk from malformed data","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:58:56.445097+05:30","updated_at":"2025-12-24T03:59:34.876131+05:30","closed_at":"2025-12-24T03:59:34.876131+05:30","close_reason":"Verified: All serde_json::from_str().unwrap() calls are in test code only. Production code uses proper error handling with '?' operator. No action needed."}
{"id":"mcpmail-9","title":"Verify responsive design at mobile/tablet/desktop breakpoints","description":"## Summary\nTest all pages at 375px, 768px, and 1440px to verify responsive layouts.\n\n## Implementation Details\n\n### Test Checklist per Breakpoint\n\n**Mobile (375px)**\n- No horizontal scrolling\n- Navigation collapses appropriately\n- Text readable without zooming\n- Touch targets ≥ 44×44px\n- Forms usable on small screen\n\n**Tablet (768px)**\n- Layout adapts (no mobile layout on tablet)\n- SplitView shows single column or adapts\n- Navigation works (hamburger or full)\n- Cards don't overflow\n\n**Desktop (1440px)**\n- Full multi-column layout visible\n- SplitView shows both panels\n- Hover states work\n- No elements too small\n\n## Acceptance Criteria\n- [ ] No horizontal scrolling at any breakpoint\n- [ ] All text readable at all sizes\n- [ ] Navigation works at all sizes\n- [ ] SplitView adapts correctly\n- [ ] Screenshots captured for documentation","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T23:13:04.112709+05:30","updated_at":"2025-12-23T00:22:43.547596+05:30","closed_at":"2025-12-19T01:58:08.748652+05:30","dependencies":[{"issue_id":"mcpmail-9","depends_on_id":"mcpmail-255","type":"blocks","created_at":"2025-12-18T23:13:51.193224+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-90","title":"P3: Add CHANGELOG.md for release tracking","description":"PMAT recommendation: Add CHANGELOG.md to document version history and changes between releases. Follow Keep a Changelog format (keepachangelog.com). Sections: Added, Changed, Deprecated, Removed, Fixed, Security. Link to GitHub releases. Include v0.1.0 release notes from recent GitHub Binary Release epic (bead 6et).","notes":"Starting work - will create CHANGELOG.md following Keep a Changelog format","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T20:53:11.408145+05:30","updated_at":"2025-12-23T00:22:43.574252+05:30","closed_at":"2025-12-17T22:58:38.180265+05:30"}
{"id":"mcpmail-91","title":"P3: Reduce 14 code entropy violations","description":"PMAT quality-gate found 14 code entropy violations indicating inconsistent patterns. Areas: 1) Error handling (some use ?, some match, some map_err), 2) Logging (mix of tracing::info\\!, println\\!, eprintln\\!), 3) Result propagation styles. Standardize on: tracing for logging, ? with map_err for errors, consistent import ordering. Create team style guide section in AGENTS.md.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T20:53:15.752972+05:30","updated_at":"2025-12-23T21:22:08.261472+05:30","closed_at":"2025-12-23T21:22:08.261472+05:30"}
{"id":"mcpmail-92","title":"GAP: Config CLI Commands (set-port/show-port)","description":"## Problem\nPython has config CLI for port management. Rust uses env vars only.\n\n## Python Commands\n- `config set-port 8888` - Update HTTP binding port\n- `config show-port` - Display current port\n\n## Implementation\n- Add config subcommand with set-port/show-port\n- Store in ~/.mcp-agent-mail/config.toml\n- Load config file on server start","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T18:00:11.150819+05:30","updated_at":"2025-12-23T00:22:43.574747+05:30","closed_at":"2025-12-21T08:20:13.36167+05:30"}
{"id":"mcpmail-93","title":"SVELTE-003: Initialize shadcn-svelte with Indigo theme","description":"## Summary\nSet up shadcn-svelte with the Indigo color theme matching Python reference.\n\n## Implementation\n\n### Step 1: Initialize shadcn-svelte\n```bash\ncd crates/services/web-ui\nbunx shadcn-svelte@latest init\n```\n\n### Step 2: Install dependencies\n```bash\nbun add bits-ui clsx tailwind-merge tailwind-variants\nbun add lucide-svelte mode-watcher cmdk-sv\nbun add marked dompurify prismjs dayjs fuse.js\n```\n\n### Step 3: Configure Tailwind theme\n**File**: `tailwind.config.js`\nMatch Python base.html color palette:\n```javascript\ncolors: {\n    primary: {\n        50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe',\n        300: '#a5b4fc', 400: '#818cf8', 500: '#6366f1',\n        600: '#4f46e5', 700: '#4338ca', 800: '#3730a3',\n        900: '#312e81', 950: '#1e1b4b',\n    },\n    success: { 50: '#f0fdf4', 500: '#10b981', 600: '#059669' },\n    warning: { 50: '#fffbeb', 500: '#f59e0b', 600: '#d97706' },\n    danger: { 50: '#fef2f2', 500: '#ef4444', 600: '#dc2626' },\n}\n```\n\n### Step 4: Add shadcn components\n```bash\nbunx shadcn-svelte@latest add button card input textarea label\nbunx shadcn-svelte@latest add checkbox switch select dialog alert\nbunx shadcn-svelte@latest add badge avatar tabs tooltip progress\nbunx shadcn-svelte@latest add skeleton separator breadcrumb pagination\nbunx shadcn-svelte@latest add sonner command popover dropdown-menu\nbunx shadcn-svelte@latest add toggle-group resizable scroll-area\n```\n\n## Reference Files\n- Python: mcp_agent_mail/templates/base.html (Tailwind config)\n- Leptos: crates/services/web-ui-leptos/src/components/mod.rs\n- MCP: @shadcn registry\n\n## Acceptance Criteria\n- [ ] shadcn-svelte initialized with components.json\n- [ ] All 20+ components installed in src/lib/components/ui/\n- [ ] Tailwind config matches Python Indigo-500 theme\n- [ ] Dark mode works via mode-watcher\n- [ ] Lucide icons render correctly\n- [ ] `bun run check` passes\n\n## Quality Gates\n- No TypeScript errors\n- Components render in Storybook or test page","notes":"CrimsonSail starting: Initialize shadcn-svelte","status":"closed","issue_type":"task","created_at":"2025-12-22T05:34:33.181486+05:30","updated_at":"2025-12-23T00:22:43.574993+05:30","closed_at":"2025-12-22T17:37:06.431095+05:30","dependencies":[{"issue_id":"mcpmail-93","depends_on_id":"mcpmail-99","type":"blocks","created_at":"2025-12-22T05:40:06.401954+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-93","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:40.535526+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-94","title":"EPIC: Python-Rust Feature Parity for Agent Workflow","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T22:31:03.987508+05:30","updated_at":"2025-12-23T00:22:43.575361+05:30","closed_at":"2025-12-22T04:43:14.646548+05:30","dependencies":[{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-117","type":"blocks","created_at":"2025-12-21T22:33:00.597788+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-313","type":"blocks","created_at":"2025-12-21T22:33:00.657027+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-333","type":"blocks","created_at":"2025-12-21T22:33:00.714659+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-240","type":"blocks","created_at":"2025-12-21T22:33:00.781738+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-30","type":"blocks","created_at":"2025-12-21T22:33:00.848118+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-109","type":"blocks","created_at":"2025-12-21T22:33:00.913407+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-94","depends_on_id":"mcpmail-108","type":"blocks","created_at":"2025-12-21T22:33:00.972168+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-95","title":"P0: Fix wasmtime security vulnerabilities (RUSTSEC-2025-0118, RUSTSEC-2025-0046)","description":"wasmtime 29.0.1 pulled in by jugar-probar 0.1 (test dependency). Fix: Update jugar-probar to 0.4.0 in crates/tests/e2e/Cargo.toml. This is test-only, doesn't affect production binary.","status":"closed","issue_type":"bug","created_at":"2025-12-17T17:57:18.922092+05:30","updated_at":"2025-12-23T00:22:43.575666+05:30","closed_at":"2025-12-17T18:19:35.871843+05:30"}
{"id":"mcpmail-96","title":"P0: Fix static_files.rs panic-prone error handling","description":"Lines 56-60 and 65-66 use .expect() for Response building which can panic in production. PMAT flagged 144 unwrap() calls - reference Cloudflare 2025-11-18 outage where unwrap() panic caused 3+ hour network outage. Replace with proper fallback responses that return HTTP 500 without crashing. File: crates/libs/lib-server/src/static_files.rs","status":"closed","issue_type":"bug","created_at":"2025-12-17T20:51:34.442789+05:30","updated_at":"2025-12-23T00:22:43.575879+05:30","closed_at":"2025-12-17T20:58:22.027169+05:30"}
{"id":"mcpmail-97","title":"LEPTOS-006: FTS5 Search Results Page","description":"## Summary\nCreate search results page with FTS5 highlighting. API `/api/messages/search` exists.\n\n## Implementation\nCreate: `pages/search.rs`\nRoute: `/search?q={query}`\n\n## Acceptance Criteria\n- [ ] Route: /search?q={query}\n- [ ] Search input in header (persistent)\n- [ ] Results list with highlight spans\n- [ ] Query term highlighting in snippets\n- [ ] Filter chips (project, sender, date range)\n- [ ] Cursor-based pagination\n- [ ] \"No results\" state with suggestions\n- [ ] Search as you type (debounced 300ms)\n- [ ] Recent searches dropdown\n\n## Quality Gates\n- Search completes \u003c= 200ms for 1000 messages\n- Highlight spans use \u003cmark\u003e for a11y\n- Screen reader announces result count\n\n## Reference Skills\n- shadcn-ui: Input, Badge for chips\n- mobile-frontend-design: Debounced input\n- production-hardening-frontend: Performance targets","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T22:03:54.988695+05:30","updated_at":"2025-12-23T00:22:43.576162+05:30","closed_at":"2025-12-20T03:24:48.994372+05:30","dependencies":[{"issue_id":"mcpmail-97","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:10.979242+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-97","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:11.031102+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-97","depends_on_id":"mcpmail-49","type":"blocks","created_at":"2025-12-19T22:07:17.142197+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-98","title":"LEPTOS-005: Thread View Page","description":"## Summary\nCreate dedicated thread view with message threading. API `/api/thread/{id}` exists.\n\n## Implementation\nCreate: `pages/thread.rs`\nRoute: `/thread/{id}`\n\n## Acceptance Criteria\n- [ ] Route: /thread/{id}\n- [ ] Tree visualization of message thread\n- [ ] Expand/collapse thread branches\n- [ ] Reply button per message\n- [ ] Back button returns to inbox (preserve scroll)\n- [ ] Keyboard: Up/Down navigate, Enter expand, Esc back\n- [ ] Thread depth indicator (indentation)\n- [ ] Mobile: Linear view with depth badges\n\n## Quality Gates\n- Handles 50+ message threads without scroll jank\n- Focus trap on reply modal\n- aria-expanded on collapsible nodes\n\n## Reference Skills\n- shadcn-ui: Collapsible pattern\n- mobile-frontend-design: Responsive hierarchy\n- kaizen-solaris-review: Performance under load","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T22:03:37.390252+05:30","updated_at":"2025-12-23T00:22:43.576481+05:30","closed_at":"2025-12-20T03:15:46.891193+05:30","dependencies":[{"issue_id":"mcpmail-98","depends_on_id":"mcpmail-298","type":"blocks","created_at":"2025-12-19T22:07:10.870951+05:30","created_by":"daemon","metadata":"{}"},{"issue_id":"mcpmail-98","depends_on_id":"mcpmail-276","type":"blocks","created_at":"2025-12-19T22:07:10.925968+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"mcpmail-99","title":"SVELTE-002: Configure SvelteKit static adapter for embedding","description":"## Summary\nConfigure SvelteKit with static adapter for Rust binary embedding.\n\n## Implementation\n**File**: `crates/services/web-ui/svelte.config.js`\n\n```javascript\nimport adapter from '@sveltejs/adapter-static';\nimport { vitePreprocess } from '@sveltejs/vite-plugin-svelte';\n\nconst config = {\n    preprocess: vitePreprocess(),\n    kit: {\n        adapter: adapter({\n            pages: 'build',\n            assets: 'build',\n            fallback: 'index.html',  // SPA mode\n            precompress: true,       // gzip/brotli\n            strict: true\n        }),\n        paths: { base: '' },\n        alias: {\n            '$components': 'src/lib/components',\n            '$api': 'src/lib/api',\n            '$stores': 'src/lib/stores'\n        }\n    }\n};\n```\n\n**File**: `crates/services/web-ui/vite.config.ts`\n```typescript\nimport { sveltekit } from '@sveltejs/kit/vite';\nimport { defineConfig } from 'vite';\n\nexport default defineConfig({\n    plugins: [sveltekit()],\n    server: {\n        proxy: {\n            '/api': 'http://127.0.0.1:8080',\n            '/mail/api': 'http://127.0.0.1:8080'\n        }\n    }\n});\n```\n\n## Reference Files\n- crates/services/web-ui/svelte.config.js\n- crates/services/web-ui/vite.config.ts\n- crates/services/web-ui/package.json\n\n## Acceptance Criteria\n- [ ] `bun run build` produces build/ directory\n- [ ] build/index.html exists (SPA fallback)\n- [ ] precompress generates .gz/.br files\n- [ ] Dev proxy works: /api → localhost:8080\n- [ ] Aliases resolve: $components, $api, $stores\n\n## Quality Gates\n- bun run check (svelte-check)\n- Build output \u003c 500KB uncompressed","status":"closed","issue_type":"task","created_at":"2025-12-22T05:34:08.169567+05:30","updated_at":"2025-12-23T00:22:43.576831+05:30","closed_at":"2025-12-22T07:56:03.54519+05:30","dependencies":[{"issue_id":"mcpmail-99","depends_on_id":"mcpmail-100","type":"blocks","created_at":"2025-12-22T05:40:01.270684+05:30","created_by":"amrit","metadata":"{}"},{"issue_id":"mcpmail-99","depends_on_id":"mcpmail-398","type":"parent-child","created_at":"2025-12-22T05:41:35.407012+05:30","created_by":"amrit","metadata":"{}"}]}
{"id":"mcpmail-998n","title":"[P1] Add 'Don't show again' option to Install App modal","description":"## Problem\nInstall App (PWA) modal:\n- Appears too frequently\n- Covers important content  \n- Has no \"Don't show again\" option\n- Competes for attention with primary app functions\n\n## Current Behavior\nModal appears on every page load for non-installed users. No way to dismiss permanently.\n\n## Target Behavior\n- Show modal once per session (or per week)\n- \"Don't show again\" checkbox that persists to localStorage\n- Less intrusive positioning\n- Auto-dismiss after 10 seconds if ignored\n\n## TDD Acceptance Criteria\n\n### RED Phase - Modal Behavior Tests\n```typescript\n// web-ui/tests/pwa-modal.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('PWA Install Modal', () =\u003e {\n  test.beforeEach(async ({ page }) =\u003e {\n    await page.evaluate(() =\u003e localStorage.clear());\n  });\n\n  test('shows modal on first visit', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    const modal = page.locator('[data-testid=\"pwa-install-modal\"]');\n    await expect(modal).toBeVisible();\n  });\n\n  test('has \"Don\\'t show again\" checkbox', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    const modal = page.locator('[data-testid=\"pwa-install-modal\"]');\n    const checkbox = modal.locator('input[type=\"checkbox\"]');\n    \n    await expect(checkbox).toBeVisible();\n    await expect(modal.getByText(/don't show again/i)).toBeVisible();\n  });\n\n  test('remembers \"Don\\'t show again\" preference', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    const modal = page.locator('[data-testid=\"pwa-install-modal\"]');\n    await modal.locator('input[type=\"checkbox\"]').check();\n    await modal.getByRole('button', { name: /dismiss|close|later/i }).click();\n    \n    // Reload page\n    await page.reload();\n    \n    // Modal should NOT appear\n    await expect(modal).not.toBeVisible();\n  });\n\n  test('can dismiss without \"Don\\'t show again\"', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    const modal = page.locator('[data-testid=\"pwa-install-modal\"]');\n    await modal.getByRole('button', { name: /dismiss|close|later/i }).click();\n    \n    await expect(modal).not.toBeVisible();\n    \n    // After page reload, it SHOULD appear again (didn't check \"don't show\")\n    await page.reload();\n    await expect(modal).toBeVisible();\n  });\n\n  test('auto-dismisses after timeout', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    const modal = page.locator('[data-testid=\"pwa-install-modal\"]');\n    await expect(modal).toBeVisible();\n    \n    // Wait for auto-dismiss (10 seconds in prod, shorter in test)\n    await page.waitForTimeout(11000);\n    \n    await expect(modal).not.toBeVisible();\n  });\n\n  test('does not block main content interaction', async ({ page }) =\u003e {\n    await page.goto('/');\n    \n    // Modal visible but sidebar should be clickable\n    const navLink = page.getByRole('link', { name: /projects/i });\n    await navLink.click();\n    \n    await expect(page).toHaveURL('/projects');\n  });\n});\n```\n\n### GREEN Phase - Implementation\n```svelte\n\u003c!-- components/pwa/InstallPrompt.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { onMount } from 'svelte';\n  import { browser } from '$app/environment';\n  import { Button } from '$lib/components/ui/button';\n  import { Checkbox } from '$lib/components/ui/checkbox';\n  import Download from 'lucide-svelte/icons/download';\n  import X from 'lucide-svelte/icons/x';\n\n  const STORAGE_KEY = 'pwa-install-dismissed';\n  const AUTO_DISMISS_MS = 10000;\n\n  let visible = $state(false);\n  let dontShowAgain = $state(false);\n  let deferredPrompt: BeforeInstallPromptEvent | null = null;\n  let timeoutId: number;\n\n  onMount(() =\u003e {\n    if (!browser) return;\n    \n    // Check if already dismissed permanently\n    const dismissed = localStorage.getItem(STORAGE_KEY);\n    if (dismissed === 'true') return;\n    \n    // Check if already installed\n    if (window.matchMedia('(display-mode: standalone)').matches) return;\n    \n    // Listen for install prompt\n    window.addEventListener('beforeinstallprompt', (e) =\u003e {\n      e.preventDefault();\n      deferredPrompt = e as BeforeInstallPromptEvent;\n      visible = true;\n      \n      // Auto-dismiss after timeout\n      timeoutId = setTimeout(() =\u003e {\n        if (visible) dismiss();\n      }, AUTO_DISMISS_MS);\n    });\n\n    return () =\u003e {\n      if (timeoutId) clearTimeout(timeoutId);\n    };\n  });\n\n  function dismiss() {\n    visible = false;\n    if (dontShowAgain) {\n      localStorage.setItem(STORAGE_KEY, 'true');\n    }\n    if (timeoutId) clearTimeout(timeoutId);\n  }\n\n  async function install() {\n    if (!deferredPrompt) return;\n    \n    deferredPrompt.prompt();\n    const { outcome } = await deferredPrompt.userChoice;\n    \n    if (outcome === 'accepted') {\n      localStorage.setItem(STORAGE_KEY, 'true');\n    }\n    \n    deferredPrompt = null;\n    visible = false;\n  }\n\u003c/script\u003e\n\n{#if visible}\n  \u003cdiv \n    class=\"fixed bottom-4 right-4 z-40 max-w-sm bg-card border rounded-lg shadow-lg p-4 animate-in slide-in-from-bottom-4\"\n    data-testid=\"pwa-install-modal\"\n    role=\"dialog\"\n    aria-label=\"Install application\"\n  \u003e\n    \u003cbutton \n      class=\"absolute top-2 right-2 p-1 hover:bg-muted rounded\"\n      onclick={dismiss}\n      aria-label=\"Close\"\n    \u003e\n      \u003cX class=\"h-4 w-4\" /\u003e\n    \u003c/button\u003e\n    \n    \u003cdiv class=\"flex gap-3\"\u003e\n      \u003cdiv class=\"flex-shrink-0\"\u003e\n        \u003cDownload class=\"h-8 w-8 text-primary\" /\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"space-y-2\"\u003e\n        \u003ch3 class=\"font-semibold\"\u003eInstall Agent Mail\u003c/h3\u003e\n        \u003cp class=\"text-sm text-muted-foreground\"\u003e\n          Install for faster access and offline support.\n        \u003c/p\u003e\n        \n        \u003cdiv class=\"flex items-center gap-2 pt-2\"\u003e\n          \u003cCheckbox \n            id=\"dontShow\" \n            bind:checked={dontShowAgain}\n          /\u003e\n          \u003clabel for=\"dontShow\" class=\"text-sm text-muted-foreground\"\u003e\n            Don't show again\n          \u003c/label\u003e\n        \u003c/div\u003e\n        \n        \u003cdiv class=\"flex gap-2 pt-2\"\u003e\n          \u003cButton variant=\"outline\" size=\"sm\" onclick={dismiss}\u003e\n            Later\n          \u003c/Button\u003e\n          \u003cButton size=\"sm\" onclick={install}\u003e\n            Install\n          \u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n{/if}\n```\n\n### REFACTOR Phase - Type Definitions\n```typescript\n// types/pwa.d.ts\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise\u003cvoid\u003e;\n  userChoice: Promise\u003c{ outcome: 'accepted' | 'dismissed' }\u003e;\n}\n\ndeclare global {\n  interface WindowEventMap {\n    beforeinstallprompt: BeforeInstallPromptEvent;\n  }\n}\n```\n\n## Checklist\n- [ ] Write Playwright tests for modal behavior\n- [ ] Add \"Don't show again\" checkbox\n- [ ] Implement localStorage persistence\n- [ ] Add auto-dismiss after 10 seconds\n- [ ] Add close (X) button\n- [ ] Ensure modal doesn't block content\n- [ ] Add slide-in animation\n- [ ] Add data-testid attributes\n- [ ] All tests pass\n\n## Files to Modify\n- `web-ui/src/lib/components/pwa/InstallPrompt.svelte` (or similar)\n- `web-ui/src/app.d.ts` (PWA types)\n- `web-ui/tests/pwa-modal.spec.ts` (new)","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T05:06:48.342575+05:30","updated_at":"2025-12-24T05:06:48.342575+05:30"}
{"id":"mcpmail-ewlo","title":"SVELTE-022: Beautiful UI Overhaul","description":"Transform web-ui with design tokens, mobile-first layout, MagicUI effects. Full overhaul with eye-catching effects and WCAG AA compliance.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T16:55:43.022376+05:30","updated_at":"2025-12-24T03:45:18.464484+05:30","closed_at":"2025-12-24T03:45:18.464484+05:30","close_reason":"All sub-tasks completed: MagicUI components, Inbox mobile-first, Dashboard overhaul, Message detail, Projects \u0026 Agents","dependencies":[{"issue_id":"mcpmail-ewlo","depends_on_id":"mcpmail-398","type":"blocks","created_at":"2025-12-23T16:57:30.34538+05:30","created_by":"amrit"}]}
{"id":"mcpmail-gu0r","title":"SVELTE-022h: Message Detail","description":"Markdown rendering, Tabs view, thread timeline, responsive reply modal.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T16:57:16.474377+05:30","updated_at":"2025-12-24T03:36:31.634767+05:30","closed_at":"2025-12-24T03:36:31.634767+05:30","close_reason":"Message detail with markdown rendering, Tabs view, thread timeline, and responsive reply modal","dependencies":[{"issue_id":"mcpmail-gu0r","depends_on_id":"mcpmail-xvnd","type":"blocks","created_at":"2025-12-23T16:57:32.297913+05:30","created_by":"amrit"}]}
{"id":"mcpmail-hzry","title":"Add bulk selection and actions for list items","description":"## Overview\nAdd checkbox selection to list items with bulk action bar for operations like delete, archive, or export on multiple items at once.\n\n## TDD Acceptance Criteria\n\n### RED Phase - Failing Tests First\n\n```typescript\n// tests/e2e/bulk-actions.spec.ts\nimport { test, expect } from \"@playwright/test\";\n\ntest.describe(\"Bulk Selection\", () =\u003e {\n  test(\"list items have selection checkboxes\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    const checkboxes = page.getByRole(\"checkbox\", { name: /select/i });\n    await expect(checkboxes.first()).toBeVisible();\n  });\n\n  test(\"select all checkbox toggles all items\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    const selectAll = page.getByRole(\"checkbox\", { name: /select all/i });\n    await selectAll.check();\n    \n    const itemCheckboxes = page.getByRole(\"checkbox\", { name: /select project/i });\n    const count = await itemCheckboxes.count();\n    \n    for (let i = 0; i \u003c count; i++) {\n      await expect(itemCheckboxes.nth(i)).toBeChecked();\n    }\n  });\n\n  test(\"selecting items shows bulk action bar\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    const firstCheckbox = page.getByRole(\"checkbox\", { name: /select/i }).first();\n    await firstCheckbox.check();\n    \n    const actionBar = page.getByRole(\"toolbar\", { name: /bulk actions/i });\n    await expect(actionBar).toBeVisible();\n    \n    // Should show selection count\n    await expect(actionBar).toContainText(\"1 selected\");\n  });\n\n  test(\"bulk action bar has delete and export buttons\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    await page.getByRole(\"checkbox\", { name: /select/i }).first().check();\n    \n    const actionBar = page.getByRole(\"toolbar\", { name: /bulk actions/i });\n    await expect(actionBar.getByRole(\"button\", { name: /delete/i })).toBeVisible();\n    await expect(actionBar.getByRole(\"button\", { name: /export/i })).toBeVisible();\n  });\n\n  test(\"clear selection button deselects all\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    await page.getByRole(\"checkbox\", { name: /select all/i }).check();\n    await page.getByRole(\"button\", { name: /clear selection/i }).click();\n    \n    const checkboxes = page.getByRole(\"checkbox\", { name: /select/i });\n    const count = await checkboxes.count();\n    \n    for (let i = 0; i \u003c count; i++) {\n      await expect(checkboxes.nth(i)).not.toBeChecked();\n    }\n  });\n\n  test(\"escape key clears selection\", async ({ page }) =\u003e {\n    await page.goto(\"/projects\");\n    \n    await page.getByRole(\"checkbox\", { name: /select/i }).first().check();\n    await page.keyboard.press(\"Escape\");\n    \n    const actionBar = page.getByRole(\"toolbar\", { name: /bulk actions/i });\n    await expect(actionBar).not.toBeVisible();\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n```svelte\n\u003c!-- lib/components/BulkActionBar.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { fly } from \"svelte/transition\";\n  import X from \"lucide-svelte/icons/x\";\n  import Trash2 from \"lucide-svelte/icons/trash-2\";\n  import Download from \"lucide-svelte/icons/download\";\n  import { Button } from \"$lib/components/ui/button\";\n\n  interface Props {\n    selectedCount: number;\n    onClear: () =\u003e void;\n    onDelete: () =\u003e void;\n    onExport: () =\u003e void;\n  }\n\n  let { selectedCount, onClear, onDelete, onExport }: Props = $props();\n\u003c/script\u003e\n\n\u003csvelte:window on:keydown={(e) =\u003e e.key === \"Escape\" \u0026\u0026 onClear()} /\u003e\n\n{#if selectedCount \u003e 0}\n  \u003cdiv\n    role=\"toolbar\"\n    aria-label=\"Bulk actions\"\n    transition:fly={{ y: 20, duration: 200 }}\n    class=\"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center gap-4\"\n  \u003e\n    \u003cspan class=\"text-sm font-medium text-gray-700 dark:text-gray-300\"\u003e\n      {selectedCount} selected\n    \u003c/span\u003e\n    \n    \u003cdiv class=\"h-4 w-px bg-gray-300 dark:bg-gray-600\" /\u003e\n    \n    \u003cdiv class=\"flex items-center gap-2\"\u003e\n      \u003cButton variant=\"ghost\" size=\"sm\" onclick={onExport}\u003e\n        \u003cDownload class=\"h-4 w-4 mr-1\" /\u003e\n        Export\n      \u003c/Button\u003e\n      \u003cButton variant=\"ghost\" size=\"sm\" class=\"text-red-600 hover:text-red-700\" onclick={onDelete}\u003e\n        \u003cTrash2 class=\"h-4 w-4 mr-1\" /\u003e\n        Delete\n      \u003c/Button\u003e\n    \u003c/div\u003e\n    \n    \u003cButton variant=\"ghost\" size=\"icon\" onclick={onClear} aria-label=\"Clear selection\"\u003e\n      \u003cX class=\"h-4 w-4\" /\u003e\n    \u003c/Button\u003e\n  \u003c/div\u003e\n{/if}\n```\n\n### REFACTOR Phase\n- Add keyboard shortcuts (Ctrl+A to select all)\n- Add shift+click for range selection\n- Animate selection state changes\n- Add confirmation dialog for destructive actions\n\n## Files to Modify\n- `web-ui/src/lib/components/BulkActionBar.svelte` (new)\n- `web-ui/src/lib/components/SelectableCard.svelte` (new)\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/projects/[slug]/+page.svelte`\n\n## Definition of Done\n- [ ] All Playwright tests pass\n- [ ] Bulk action bar appears when items selected\n- [ ] Select all/clear selection work correctly\n- [ ] Escape key clears selection\n- [ ] Touch-friendly checkbox targets (44x44px minimum)\n- [ ] Works with keyboard navigation","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T05:12:55.040498+05:30","updated_at":"2025-12-24T05:12:55.040498+05:30"}
{"id":"mcpmail-jc4v","title":"Add content-aware loading skeleton screens","description":"## Overview\nReplace generic spinners with content-aware skeleton screens that match the layout of the content being loaded, reducing perceived loading time.\n\n## TDD Acceptance Criteria\n\n### RED Phase - Failing Tests First\n\n```typescript\n// tests/e2e/loading-states.spec.ts\nimport { test, expect } from \"@playwright/test\";\n\ntest.describe(\"Loading Skeletons\", () =\u003e {\n  test(\"projects list shows skeleton cards while loading\", async ({ page }) =\u003e {\n    // Slow down the API response\n    await page.route(\"**/api/projects\", async (route) =\u003e {\n      await new Promise(r =\u003e setTimeout(r, 1000));\n      await route.fulfill({ json: [{ slug: \"test\", human_key: \"Test\", created_at: new Date().toISOString() }] });\n    });\n    \n    await page.goto(\"/projects\");\n    \n    // Should show skeleton cards\n    const skeletons = page.locator(\"[data-testid=\\\"project-skeleton\\\"]\");\n    await expect(skeletons.first()).toBeVisible();\n    \n    // Skeleton should have correct structure\n    await expect(skeletons.first().locator(\".animate-pulse\")).toBeVisible();\n  });\n\n  test(\"agent cards show skeleton while loading\", async ({ page }) =\u003e {\n    await page.route(\"**/api/projects/*/agents\", async (route) =\u003e {\n      await new Promise(r =\u003e setTimeout(r, 1000));\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/projects/test-project\");\n    \n    const skeletons = page.locator(\"[data-testid=\\\"agent-skeleton\\\"]\");\n    await expect(skeletons.first()).toBeVisible();\n  });\n\n  test(\"message list shows skeleton rows while loading\", async ({ page }) =\u003e {\n    await page.route(\"**/api/inbox\", async (route) =\u003e {\n      await new Promise(r =\u003e setTimeout(r, 1000));\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/inbox?project=test\u0026agent=test-agent\");\n    \n    const skeletons = page.locator(\"[data-testid=\\\"message-skeleton\\\"]\");\n    await expect(skeletons.first()).toBeVisible();\n  });\n\n  test(\"skeleton has reduced motion support\", async ({ page }) =\u003e {\n    await page.emulateMedia({ reducedMotion: \"reduce\" });\n    \n    await page.route(\"**/api/projects\", async (route) =\u003e {\n      await new Promise(r =\u003e setTimeout(r, 1000));\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/projects\");\n    \n    const skeleton = page.locator(\"[data-testid=\\\"project-skeleton\\\"]\").first();\n    \n    // Animation should be disabled\n    const animationStyle = await skeleton.evaluate((el) =\u003e {\n      return window.getComputedStyle(el.querySelector(\".animate-pulse\") || el).animation;\n    });\n    \n    expect(animationStyle).toMatch(/none|0s/);\n  });\n\n  test(\"skeleton disappears when content loads\", async ({ page }) =\u003e {\n    let resolveRoute: () =\u003e void;\n    const routePromise = new Promise\u003cvoid\u003e(r =\u003e { resolveRoute = r; });\n    \n    await page.route(\"**/api/projects\", async (route) =\u003e {\n      await routePromise;\n      await route.fulfill({ json: [{ slug: \"test\", human_key: \"Test Project\", created_at: new Date().toISOString() }] });\n    });\n    \n    await page.goto(\"/projects\");\n    \n    // Skeleton visible\n    const skeleton = page.locator(\"[data-testid=\\\"project-skeleton\\\"]\");\n    await expect(skeleton.first()).toBeVisible();\n    \n    // Resolve the route\n    resolveRoute!();\n    \n    // Skeleton should disappear, content should appear\n    await expect(skeleton.first()).not.toBeVisible();\n    await expect(page.getByText(\"Test Project\")).toBeVisible();\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n```svelte\n\u003c!-- lib/components/skeletons/ProjectCardSkeleton.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  // Content-aware skeleton matching ProjectCard layout\n\u003c/script\u003e\n\n\u003cdiv\n  data-testid=\"project-skeleton\"\n  class=\"bg-white dark:bg-gray-800 rounded-xl p-5 md:p-6 shadow-sm border border-gray-200 dark:border-gray-700\"\n\u003e\n  \u003cdiv class=\"flex items-start justify-between mb-4\"\u003e\n    \u003cdiv class=\"flex items-center gap-3\"\u003e\n      \u003c!-- Icon placeholder --\u003e\n      \u003cdiv class=\"w-10 h-10 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse\" /\u003e\n      \n      \u003cdiv class=\"space-y-2\"\u003e\n        \u003c!-- Title placeholder --\u003e\n        \u003cdiv class=\"h-5 w-32 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\" /\u003e\n        \u003c!-- Subtitle placeholder --\u003e\n        \u003cdiv class=\"h-3 w-24 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\" /\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \u003c!-- Date placeholder --\u003e\n  \u003cdiv class=\"flex items-center gap-2\"\u003e\n    \u003cdiv class=\"h-4 w-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\" /\u003e\n    \u003cdiv class=\"h-4 w-28 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\" /\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cstyle\u003e\n  @media (prefers-reduced-motion: reduce) {\n    :global(.animate-pulse) {\n      animation: none !important;\n    }\n  }\n\u003c/style\u003e\n```\n\n```svelte\n\u003c!-- lib/components/skeletons/index.ts --\u003e\nexport { default as ProjectCardSkeleton } from \"./ProjectCardSkeleton.svelte\";\nexport { default as AgentCardSkeleton } from \"./AgentCardSkeleton.svelte\";\nexport { default as MessageRowSkeleton } from \"./MessageRowSkeleton.svelte\";\nexport { default as ProjectTableSkeleton } from \"./ProjectTableSkeleton.svelte\";\n```\n\n### REFACTOR Phase\n- Add staggered animation delays for multiple skeletons\n- Create skeleton variants for different card sizes\n- Add shimmer effect option\n- Ensure color contrast in skeleton placeholders\n\n## Files to Modify\n- `web-ui/src/lib/components/skeletons/ProjectCardSkeleton.svelte`\n- `web-ui/src/lib/components/skeletons/AgentCardSkeleton.svelte`\n- `web-ui/src/lib/components/skeletons/MessageRowSkeleton.svelte`\n- `web-ui/src/lib/components/skeletons/index.ts`\n- Update route pages to use content-aware skeletons\n\n## Definition of Done\n- [ ] All Playwright tests pass\n- [ ] Skeleton layout matches actual content layout\n- [ ] Reduced motion supported\n- [ ] Smooth transition from skeleton to content\n- [ ] Works in both light and dark modes\n- [ ] Staggered animation for multiple items","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T05:12:55.913931+05:30","updated_at":"2025-12-24T05:12:55.913931+05:30"}
{"id":"mcpmail-jegz","title":"P1: Refactor handle_archive_command - cyclomatic complexity 56","description":"**Issue**: PMAT identified `handle_archive_command` as top complexity hotspot with cyclomatic complexity of 56 (threshold: 10).\n\n**Impact**:\n- Extremely difficult to test comprehensively (2^56 potential paths)\n- High bug introduction risk on modifications\n- Cognitive overload for maintainers\n- Likely contains hidden edge cases\n\n**Location**: crates/mcp-agent-mail/src/commands/archive.rs (or similar)\n\n**Refactoring Strategy**:\n1. **Extract Command Handlers**: Split into separate functions per archive subcommand\n   - `handle_archive_save()`\n   - `handle_archive_restore()`\n   - `handle_archive_list()`\n   - etc.\n\n2. **Use Command Pattern**: Create enum with variants per operation\n   ```rust\n   enum ArchiveCommand {\n       Save { path: PathBuf, options: SaveOptions },\n       Restore { id: String },\n       List { filter: Option\u003cFilter\u003e },\n   }\n   ```\n\n3. **Table-Driven Dispatch**: Replace nested match/if with lookup table\n\n4. **Extract Validation**: Move input validation to separate functions\n\n**Target**: Reduce each function to complexity \u003c10\n\n**Test Strategy**:\n- Add unit tests for each extracted function\n- Integration test for command dispatch\n- Property-based testing for option combinations\n- Measure coverage increase after refactor\n\n**Metrics After Fix**:\n- Each handler function: complexity \u003c10\n- Total code coverage: increase by ~5%\n- PMAT violations: reduce by 1\n\n**Severity**: High - maintenance burden, bug magnet","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T02:58:52.410676+05:30","updated_at":"2025-12-24T03:55:15.500533+05:30","closed_at":"2025-12-24T03:55:15.500533+05:30","close_reason":"Refactored handle_archive_command from CC=56 to 5 focused functions: handle_archive_save, handle_archive_list, handle_archive_restore, handle_archive_clear_and_reset. Main function now ~CC=5. Applied to both mcp-agent-mail and mcp-cli."}
{"id":"mcpmail-jzsx","title":"Auto-generate MCP tool schemas from JsonSchema derive","description":"Currently tool schemas are manually defined in get_all_tool_schemas(). Params already derive JsonSchema. Need to: 1) Use schemars::schema_for!() to generate JSON schema, 2) Convert to ToolSchema format, 3) Remove manual schema definitions. Benefits: Single source of truth, automatic sync with params.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-24T02:10:30.442798+05:30","updated_at":"2025-12-24T02:10:30.442798+05:30"}
{"id":"mcpmail-lz6s","title":"[P1] Improve Create Project form with name and description fields","description":"## Problem\nCreate Project modal has only ONE field:\n- \"Project Path (human_key)\" with placeholder \"/path/to/your/project\"\n\nIssues:\n- Single field is anemic for such an important action\n- \"human_key\" exposes internal terminology\n- \"/path/to/your/project\" placeholder suggests file paths\n- No project name field\n- No description field\n\n## Current Form\n```\nProject Path (human_key) *\n[ /path/to/your/project        ]\n\n[Cancel] [Create Project]\n```\n\n## Target Form\n```\nProject Name *\n[ My New Project               ]\n\nDescription (optional)\n[ Brief description of this project... ]\n\nIdentifier (auto-generated)\n[ my-new-project               ] 🔒\n\n[Cancel] [Create Project]\n```\n\n## TDD Acceptance Criteria\n\n### RED Phase - Form Tests\n```typescript\n// web-ui/tests/create-project.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Create Project Form', () =\u003e {\n  test('has project name as primary field', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    const nameField = dialog.locator('input[name=\"name\"]');\n    \n    await expect(nameField).toBeVisible();\n    await expect(nameField).toBeFocused();\n  });\n\n  test('has optional description field', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    const descField = dialog.locator('textarea[name=\"description\"]');\n    \n    await expect(descField).toBeVisible();\n  });\n\n  test('auto-generates slug from name', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    await dialog.locator('input[name=\"name\"]').fill('My Amazing Project');\n    \n    const slugField = dialog.locator('input[name=\"slug\"]');\n    await expect(slugField).toHaveValue('my-amazing-project');\n  });\n\n  test('validates required name field', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    await dialog.getByRole('button', { name: 'Create Project' }).click();\n    \n    // Should show validation error\n    await expect(dialog.getByText(/name is required/i)).toBeVisible();\n  });\n\n  test('does NOT expose \"human_key\" terminology', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    const text = await dialog.textContent();\n    \n    expect(text).not.toContain('human_key');\n    expect(text).not.toContain('path/to/your');\n  });\n\n  test('creates project successfully', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.click('text=New Project');\n    \n    const dialog = page.locator('[data-testid=\"create-project-dialog\"]');\n    await dialog.locator('input[name=\"name\"]').fill('Test Project');\n    await dialog.locator('textarea[name=\"description\"]').fill('A test project');\n    await dialog.getByRole('button', { name: 'Create Project' }).click();\n    \n    // Dialog closes, success toast appears\n    await expect(dialog).not.toBeVisible();\n    await expect(page.getByText(/created/i)).toBeVisible();\n  });\n});\n```\n\n### GREEN Phase - Implementation\n```svelte\n\u003c!-- routes/projects/+page.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { slugify } from '$lib/utils/slugify';\n  \n  let showNewForm = $state(false);\n  let newProject = $state({\n    name: '',\n    description: '',\n    slug: ''\n  });\n  let errors = $state\u003cRecord\u003cstring, string\u003e\u003e({});\n  let creating = $state(false);\n\n  // Auto-generate slug from name\n  $effect(() =\u003e {\n    if (newProject.name \u0026\u0026 !newProject.slugEdited) {\n      newProject.slug = slugify(newProject.name);\n    }\n  });\n\n  function validateForm(): boolean {\n    errors = {};\n    if (!newProject.name.trim()) {\n      errors.name = 'Project name is required';\n    }\n    if (newProject.name.length \u003e 100) {\n      errors.name = 'Name must be under 100 characters';\n    }\n    return Object.keys(errors).length === 0;\n  }\n\n  async function createProject() {\n    if (!validateForm()) return;\n    \n    creating = true;\n    try {\n      await ensureProject(newProject.slug, newProject.name, newProject.description);\n      toast.success('Project created');\n      await loadProjects();\n      showNewForm = false;\n      newProject = { name: '', description: '', slug: '' };\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : 'Failed to create project');\n    } finally {\n      creating = false;\n    }\n  }\n\u003c/script\u003e\n\n\u003cDialog.Root bind:open={showNewForm}\u003e\n  \u003cDialog.Content class=\"sm:max-w-lg\" data-testid=\"create-project-dialog\"\u003e\n    \u003cDialog.Header\u003e\n      \u003cDialog.Title\u003eCreate New Project\u003c/Dialog.Title\u003e\n      \u003cDialog.Description\u003e\n        Set up a new project for agent communication.\n      \u003c/Dialog.Description\u003e\n    \u003c/Dialog.Header\u003e\n    \n    \u003cform onsubmit={(e) =\u003e { e.preventDefault(); createProject(); }} class=\"space-y-4\"\u003e\n      \u003c!-- Project Name (Primary) --\u003e\n      \u003cdiv\u003e\n        \u003clabel for=\"projectName\" class=\"block text-sm font-medium mb-1\"\u003e\n          Project Name \u003cspan class=\"text-destructive\"\u003e*\u003c/span\u003e\n        \u003c/label\u003e\n        \u003cinput\n          id=\"projectName\"\n          name=\"name\"\n          type=\"text\"\n          bind:value={newProject.name}\n          placeholder=\"My Project\"\n          class=\"w-full min-h-[44px] px-4 py-2 border rounded-lg\"\n          class:border-destructive={errors.name}\n        /\u003e\n        {#if errors.name}\n          \u003cp class=\"text-sm text-destructive mt-1\"\u003e{errors.name}\u003c/p\u003e\n        {/if}\n      \u003c/div\u003e\n      \n      \u003c!-- Description (Optional) --\u003e\n      \u003cdiv\u003e\n        \u003clabel for=\"projectDesc\" class=\"block text-sm font-medium mb-1\"\u003e\n          Description \u003cspan class=\"text-muted-foreground\"\u003e(optional)\u003c/span\u003e\n        \u003c/label\u003e\n        \u003ctextarea\n          id=\"projectDesc\"\n          name=\"description\"\n          bind:value={newProject.description}\n          placeholder=\"Brief description of this project...\"\n          rows=\"2\"\n          class=\"w-full px-4 py-2 border rounded-lg resize-none\"\n        /\u003e\n      \u003c/div\u003e\n      \n      \u003c!-- Auto-generated Identifier --\u003e\n      \u003cdiv\u003e\n        \u003clabel for=\"projectSlug\" class=\"block text-sm font-medium mb-1\"\u003e\n          Identifier \u003cspan class=\"text-muted-foreground\"\u003e(auto-generated)\u003c/span\u003e\n        \u003c/label\u003e\n        \u003cdiv class=\"relative\"\u003e\n          \u003cinput\n            id=\"projectSlug\"\n            name=\"slug\"\n            type=\"text\"\n            bind:value={newProject.slug}\n            onfocus={() =\u003e newProject.slugEdited = true}\n            class=\"w-full min-h-[44px] px-4 py-2 border rounded-lg font-mono text-sm bg-muted\"\n          /\u003e\n          \u003cLock class=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" /\u003e\n        \u003c/div\u003e\n        \u003cp class=\"text-xs text-muted-foreground mt-1\"\u003e\n          Used in URLs and API calls\n        \u003c/p\u003e\n      \u003c/div\u003e\n      \n      \u003cDialog.Footer\u003e\n        \u003cButton variant=\"outline\" type=\"button\" onclick={() =\u003e showNewForm = false}\u003e\n          Cancel\n        \u003c/Button\u003e\n        \u003cButton type=\"submit\" disabled={creating}\u003e\n          {creating ? 'Creating...' : 'Create Project'}\n        \u003c/Button\u003e\n      \u003c/Dialog.Footer\u003e\n    \u003c/form\u003e\n  \u003c/Dialog.Content\u003e\n\u003c/Dialog.Root\u003e\n```\n\n### REFACTOR Phase - Slugify Utility\n```typescript\n// lib/utils/slugify.ts\nexport function slugify(text: string): string {\n  return text\n    .toLowerCase()\n    .trim()\n    .replace(/[^\\w\\s-]/g, '')     // Remove special chars\n    .replace(/[\\s_-]+/g, '-')      // Replace spaces with -\n    .replace(/^-+|-+$/g, '');      // Remove leading/trailing -\n}\n```\n\n## Backend API Update\n```typescript\n// Current: ensureProject(humanKey: string)\n// New: ensureProject(slug: string, name: string, description?: string)\n\nexport async function ensureProject(\n  slug: string, \n  name: string, \n  description?: string\n): Promise\u003cProject\u003e {\n  return request\u003cProject\u003e('/project/ensure', {\n    method: 'POST',\n    body: JSON.stringify({ \n      slug,\n      human_key: name, \n      description \n    })\n  });\n}\n```\n\n## Checklist\n- [ ] Write Playwright tests for new form\n- [ ] Add project name field (primary)\n- [ ] Add description field (optional)\n- [ ] Add auto-slug generation\n- [ ] Add form validation\n- [ ] Create slugify utility\n- [ ] Remove \"human_key\" and file path terminology\n- [ ] Update API client\n- [ ] Add data-testid attributes\n- [ ] All tests pass\n\n## Files to Create\n- `web-ui/src/lib/utils/slugify.ts`\n- `web-ui/tests/create-project.spec.ts`\n\n## Files to Modify\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/lib/api/client.ts`","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T05:06:47.050187+05:30","updated_at":"2025-12-24T05:06:47.050187+05:30"}
{"id":"mcpmail-m19t","title":"SVELTE-022g: Projects \u0026 Agents","description":"shadcn Table, Dialog forms, MagicCard hover, staggered animations, design tokens.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T16:57:13.225897+05:30","updated_at":"2025-12-24T03:40:36.134427+05:30","closed_at":"2025-12-24T03:40:36.134427+05:30","close_reason":"Projects \u0026 Agents pages with Dialog forms, BlurFade animations, ShimmerButton CTAs, staggered card animations, and mobile-responsive design","dependencies":[{"issue_id":"mcpmail-m19t","depends_on_id":"mcpmail-7sc1","type":"blocks","created_at":"2025-12-23T16:57:32.056623+05:30","created_by":"amrit"}]}
{"id":"mcpmail-m5me","title":"[P0] Add input validation guards to all MCP tool handlers","description":"## Problem\nMultiple MCP tools accept user-provided identifiers (agent_name, project_slug) without \nvalidation before database lookups. The `validate_agent_name()` and `validate_project_key()` \nfunctions exist in lib-core but aren't consistently called.\n\n## Security Impact\n- Malformed input reaches database layer\n- Potential for injection or DoS via crafted inputs\n- NIST SC-5 violation (incomplete input validation)\n\n## Affected Tools (audit identified)\n- `send_message` - sender_name not validated\n- `list_inbox` - agent_name not validated  \n- `whois` - agent_name not validated\n- `reply_message` - sender_name not validated\n- `register_agent` - partial (project_slug validated, name validated)\n- ~30 other tools with agent_name/project_slug params\n\n## TDD Acceptance Criteria\n\n### RED Phase - Write Failing Tests First\n```rust\n// tests/input_validation_tests.rs\n#[tokio::test]\nasync fn test_send_message_rejects_invalid_agent_name() {\n    let service = test_service().await;\n    let result = service.send_message(SendMessageParams {\n        project_slug: \"valid-project\".into(),\n        sender_name: \"invalid-agent!@#$\".into(), // Invalid chars\n        to: \"recipient\".into(),\n        subject: \"test\".into(),\n        body_md: \"test\".into(),\n        ..Default::default()\n    }).await;\n    \n    assert!(matches!(result, Err(e) if e.code == -32602)); // invalid_params\n    assert!(result.unwrap_err().message.contains(\"agent name\"));\n}\n\n#[tokio::test]\nasync fn test_list_inbox_rejects_sql_injection_attempt() {\n    let service = test_service().await;\n    let result = service.list_inbox(ListInboxParams {\n        project_slug: \"test\".into(),\n        agent_name: \"'; DROP TABLE agents; --\".into(),\n        limit: None,\n    }).await;\n    \n    assert!(result.is_err());\n    // Should fail at validation, never reach DB\n}\n\n#[tokio::test]\nasync fn test_validation_error_includes_suggestion() {\n    let service = test_service().await;\n    let result = service.whois(WhoisParams {\n        project_slug: \"test\".into(),\n        agent_name: \"my agent\".into(), // Space not allowed\n    }).await;\n    \n    let err = result.unwrap_err();\n    let details = err.data.as_ref().unwrap();\n    assert!(details.get(\"suggestion\").is_some());\n    assert_eq!(details.get(\"suggestion\").unwrap(), \"myagent\");\n}\n```\n\n### GREEN Phase - Implementation Pattern\n```rust\n// In each tool handler, add validation at entry:\nasync fn send_message(\u0026self, params: Parameters\u003cSendMessageParams\u003e) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    let p = params.inner;\n    \n    // Validation guards (TDD: tests exist first)\n    validate_project_key(\u0026p.project_slug).map_err(|e| {\n        McpError::invalid_params(\n            format!(\"{}\", e),\n            Some(serde_json::json!({ \"details\": e.context() }))\n        )\n    })?;\n    \n    validate_agent_name(\u0026p.sender_name).map_err(|e| {\n        McpError::invalid_params(\n            format!(\"{}\", e),\n            Some(serde_json::json!({ \"details\": e.context() }))\n        )\n    })?;\n    \n    // ... rest of implementation\n}\n```\n\n### REFACTOR Phase - Extract Helper\n```rust\n// tools/helpers/validation.rs\npub fn guard_agent_name(name: \u0026str) -\u003e Result\u003c(), McpError\u003e {\n    validate_agent_name(name).map_err(|e| {\n        McpError::invalid_params(format!(\"{}\", e), Some(e.context()))\n    })\n}\n\npub fn guard_project_key(key: \u0026str) -\u003e Result\u003c(), McpError\u003e {\n    validate_project_key(key).map_err(|e| {\n        McpError::invalid_params(format!(\"{}\", e), Some(e.context()))\n    })\n}\n```\n\n## Checklist\n- [ ] Write failing tests for invalid agent_name in 5 core tools\n- [ ] Write failing tests for invalid project_slug in 5 core tools  \n- [ ] Write test for actionable error messages with suggestions\n- [ ] Implement guard_agent_name() helper\n- [ ] Implement guard_project_key() helper\n- [ ] Add validation to send_message\n- [ ] Add validation to list_inbox\n- [ ] Add validation to whois\n- [ ] Add validation to reply_message\n- [ ] Audit remaining 30+ tools and add guards\n- [ ] Verify all tests pass\n- [ ] Run cargo clippy -D warnings\n- [ ] Run cargo test with coverage\n\n## Files to Modify\n- `lib-mcp/src/tools/mod.rs` (main handlers)\n- `lib-mcp/src/tools/helpers/validation.rs` (new file)\n- `lib-mcp/tests/input_validation_tests.rs` (new test file)\n- `lib-core/src/utils/validation.rs` (may need enhancements)","status":"closed","issue_type":"bug","created_at":"2025-12-24T04:56:30.519323+05:30","updated_at":"2025-12-24T05:40:06.480111+05:30","closed_at":"2025-12-24T05:40:06.480111+05:30","close_reason":"Implemented input validation guards for all 12 MCP tools that call AgentBmc::get_by_name(). All tools now use helpers::resolve_project_and_agent() or helpers::resolve_agent() which validate inputs before database lookup. Tests pass (42 tests), clippy clean."}
{"id":"mcpmail-muyn","title":"[P0] Remove internal database IDs from Message Details","description":"## Problem\nMessage Detail page exposes internal database IDs to users:\n- Message ID: 188\n- Project ID: 236\n- Sender ID: 226\n- Thread ID: BLOG-KICKOFF\n\nUsers don't need numeric IDs. This is developer debugging info.\n\n## Current Display\n```\nMessage Details\nMessage ID: 188\nProject ID: 236\nSender ID: 226\nThread ID: BLOG-KICKOFF\n```\n\n## Target Display\n```\nMessage Details\nThread: BLOG-KICKOFF\nFrom: AgentName\nProject: Summary Project 1\nSent: Dec 23, 2025 at 2:30 PM\n```\n\n## TDD Acceptance Criteria\n\n### RED Phase - Message Detail Tests\n```typescript\n// web-ui/tests/message-details.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Message Details Panel', () =\u003e {\n  test('does NOT show numeric database IDs', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await page.click('[data-testid=\"mail-item\"]');\n    \n    const details = page.locator('[data-testid=\"message-details\"]');\n    const text = await details.textContent();\n    \n    // Should NOT contain \"ID: \u003cnumber\u003e\" patterns\n    expect(text).not.toMatch(/Message ID:\\s*\\d+/);\n    expect(text).not.toMatch(/Project ID:\\s*\\d+/);\n    expect(text).not.toMatch(/Sender ID:\\s*\\d+/);\n  });\n\n  test('shows human-readable sender name', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await page.click('[data-testid=\"mail-item\"]');\n    \n    const sender = page.locator('[data-testid=\"message-sender\"]');\n    const text = await sender.textContent();\n    \n    // Should be a name, not a number\n    expect(text).toMatch(/^[A-Za-z]/);\n    expect(text).not.toMatch(/^\\d+$/);\n  });\n\n  test('shows human-readable project name', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await page.click('[data-testid=\"mail-item\"]');\n    \n    const project = page.locator('[data-testid=\"message-project\"]');\n    const text = await project.textContent();\n    \n    // Should be a name, not a UUID or number\n    expect(text).not.toMatch(/^\\d+$/);\n    expect(text).not.toMatch(/[a-f0-9]{8}-/i);\n  });\n\n  test('shows formatted timestamp', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    await page.click('[data-testid=\"mail-item\"]');\n    \n    const timestamp = page.locator('[data-testid=\"message-timestamp\"]');\n    const text = await timestamp.textContent();\n    \n    // Should be human-readable date format\n    expect(text).toMatch(/\\w+ \\d+, \\d{4}/); // \"Dec 23, 2025\"\n  });\n});\n```\n\n### GREEN Phase - Implementation\n```svelte\n\u003c!-- components/mail/MessageDetails.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import type { Message } from '$lib/api/types';\n  import Calendar from 'lucide-svelte/icons/calendar';\n  import User from 'lucide-svelte/icons/user';\n  import Folder from 'lucide-svelte/icons/folder';\n  import MessageSquare from 'lucide-svelte/icons/message-square';\n\n  export let message: Message;\n  export let senderName: string;\n  export let projectName: string;\n  \n  function formatDate(dateStr: string): string {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }\n\u003c/script\u003e\n\n\u003cdiv class=\"space-y-3 text-sm\" data-testid=\"message-details\"\u003e\n  \u003ch3 class=\"font-semibold text-muted-foreground\"\u003eMessage Details\u003c/h3\u003e\n  \n  \u003c!-- Thread ID (if meaningful) --\u003e\n  {#if message.thread_id \u0026\u0026 !message.thread_id.match(/[a-f0-9]{8}-/i)}\n    \u003cdiv class=\"flex items-center gap-2\"\u003e\n      \u003cMessageSquare class=\"h-4 w-4 text-muted-foreground\" /\u003e\n      \u003cspan class=\"text-muted-foreground\"\u003eThread:\u003c/span\u003e\n      \u003cspan data-testid=\"message-thread\"\u003e{message.thread_id}\u003c/span\u003e\n    \u003c/div\u003e\n  {/if}\n  \n  \u003c!-- Sender Name --\u003e\n  \u003cdiv class=\"flex items-center gap-2\"\u003e\n    \u003cUser class=\"h-4 w-4 text-muted-foreground\" /\u003e\n    \u003cspan class=\"text-muted-foreground\"\u003eFrom:\u003c/span\u003e\n    \u003cspan data-testid=\"message-sender\"\u003e{senderName}\u003c/span\u003e\n  \u003c/div\u003e\n  \n  \u003c!-- Project Name --\u003e\n  \u003cdiv class=\"flex items-center gap-2\"\u003e\n    \u003cFolder class=\"h-4 w-4 text-muted-foreground\" /\u003e\n    \u003cspan class=\"text-muted-foreground\"\u003eProject:\u003c/span\u003e\n    \u003cspan data-testid=\"message-project\"\u003e{projectName}\u003c/span\u003e\n  \u003c/div\u003e\n  \n  \u003c!-- Timestamp --\u003e\n  \u003cdiv class=\"flex items-center gap-2\"\u003e\n    \u003cCalendar class=\"h-4 w-4 text-muted-foreground\" /\u003e\n    \u003cspan class=\"text-muted-foreground\"\u003eSent:\u003c/span\u003e\n    \u003cspan data-testid=\"message-timestamp\"\u003e{formatDate(message.created_at)}\u003c/span\u003e\n  \u003c/div\u003e\n  \n  \u003c!-- REMOVED: Internal IDs\n  \u003cdiv\u003eMessage ID: {message.id}\u003c/div\u003e\n  \u003cdiv\u003eProject ID: {message.project_id}\u003c/div\u003e\n  \u003cdiv\u003eSender ID: {message.sender_id}\u003c/div\u003e\n  --\u003e\n\u003c/div\u003e\n```\n\n### REFACTOR Phase - API Enrichment\nIf sender/project names aren't available, update API to return them:\n```typescript\n// lib/api/client.ts\nexport async function getMessageWithDetails(id: number): Promise\u003cMessageWithDetails\u003e {\n  const message = await getMessage(id);\n  \n  // Enrich with human-readable names\n  const [sender, project] = await Promise.all([\n    getAgentById(message.sender_id),\n    getProjectById(message.project_id),\n  ]);\n  \n  return {\n    ...message,\n    sender_name: sender.name,\n    project_name: project.human_key,\n  };\n}\n```\n\n## Checklist\n- [ ] Write Playwright tests for message details\n- [ ] Remove numeric ID displays from MessageDetails component\n- [ ] Add sender name resolution\n- [ ] Add project name resolution\n- [ ] Format timestamps human-readably\n- [ ] Add data-testid attributes\n- [ ] Update API if needed for name resolution\n- [ ] All tests pass\n\n## Files to Modify\n- `web-ui/src/routes/mail/+page.svelte`\n- `web-ui/src/lib/components/mail/MessageDetails.svelte` (or equivalent)\n- `web-ui/src/lib/api/client.ts` (if API enrichment needed)\n- `web-ui/tests/message-details.spec.ts` (new)","status":"closed","issue_type":"bug","created_at":"2025-12-24T05:03:48.869244+05:30","updated_at":"2025-12-24T06:10:01.584273+05:30","closed_at":"2025-12-24T06:10:01.584273+05:30","close_reason":"Replaced internal database IDs (Message ID, Project ID, Sender ID) with human-readable fields: From, To, Thread, Importance, Sent"}
{"id":"mcpmail-nfyq","title":"Improve empty states with helpful CTAs and illustrations","description":"## Overview\nEnhance empty states across the application with clear messaging, helpful illustrations, and actionable CTAs that guide users on what to do next.\n\n## TDD Acceptance Criteria\n\n### RED Phase - Failing Tests First\n\n```typescript\n// tests/e2e/empty-states.spec.ts\nimport { test, expect } from \"@playwright/test\";\n\ntest.describe(\"Empty States\", () =\u003e {\n  test(\"empty projects list shows helpful empty state\", async ({ page }) =\u003e {\n    // Mock empty projects response\n    await page.route(\"**/api/projects\", async (route) =\u003e {\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/projects\");\n    \n    // Should have illustration\n    const illustration = page.getByRole(\"img\", { name: /no projects/i });\n    await expect(illustration).toBeVisible();\n    \n    // Should have descriptive text\n    await expect(page.getByText(/get started by creating/i)).toBeVisible();\n    \n    // Should have primary CTA\n    const createButton = page.getByRole(\"button\", { name: /create.*project/i });\n    await expect(createButton).toBeVisible();\n  });\n\n  test(\"empty agents list shows context-aware message\", async ({ page }) =\u003e {\n    await page.route(\"**/api/projects/*/agents\", async (route) =\u003e {\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/projects/test-project\");\n    \n    await expect(page.getByText(/no agents registered/i)).toBeVisible();\n    await expect(page.getByText(/register your first agent/i)).toBeVisible();\n    \n    const registerButton = page.getByRole(\"button\", { name: /register agent/i });\n    await expect(registerButton).toBeVisible();\n  });\n\n  test(\"empty inbox shows friendly message\", async ({ page }) =\u003e {\n    await page.route(\"**/api/inbox\", async (route) =\u003e {\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/inbox?project=test\u0026agent=test-agent\");\n    \n    await expect(page.getByText(/inbox is empty/i)).toBeVisible();\n    await expect(page.getByText(/no messages yet/i)).toBeVisible();\n  });\n\n  test(\"empty search results shows suggestions\", async ({ page }) =\u003e {\n    await page.route(\"**/api/messages/search\", async (route) =\u003e {\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/inbox?project=test\u0026agent=test-agent\");\n    await page.getByPlaceholder(/search/i).fill(\"nonexistent\");\n    await page.keyboard.press(\"Enter\");\n    \n    await expect(page.getByText(/no results found/i)).toBeVisible();\n    await expect(page.getByText(/try different keywords/i)).toBeVisible();\n  });\n\n  test(\"empty state CTA is keyboard accessible\", async ({ page }) =\u003e {\n    await page.route(\"**/api/projects\", async (route) =\u003e {\n      await route.fulfill({ json: [] });\n    });\n    \n    await page.goto(\"/projects\");\n    \n    await page.keyboard.press(\"Tab\");\n    const createButton = page.getByRole(\"button\", { name: /create.*project/i });\n    await expect(createButton).toBeFocused();\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n```svelte\n\u003c!-- lib/components/EmptyState.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { BlurFade } from \"$lib/components/magic\";\n  import { Button } from \"$lib/components/ui/button\";\n  import type { Snippet } from \"svelte\";\n  import type { ComponentType } from \"svelte\";\n\n  interface Props {\n    icon: ComponentType;\n    title: string;\n    description: string;\n    actionLabel?: string;\n    onAction?: () =\u003e void;\n    children?: Snippet;\n  }\n\n  let { icon: Icon, title, description, actionLabel, onAction, children }: Props = $props();\n\u003c/script\u003e\n\n\u003cBlurFade delay={100}\u003e\n  \u003cdiv class=\"flex flex-col items-center justify-center py-12 px-4 text-center\"\u003e\n    \u003cdiv class=\"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4\"\u003e\n      \u003cIcon class=\"w-8 h-8 text-gray-400 dark:text-gray-500\" /\u003e\n    \u003c/div\u003e\n    \n    \u003ch3 class=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\"\u003e\n      {title}\n    \u003c/h3\u003e\n    \n    \u003cp class=\"text-gray-600 dark:text-gray-400 max-w-sm mb-6\"\u003e\n      {description}\n    \u003c/p\u003e\n    \n    {#if actionLabel \u0026\u0026 onAction}\n      \u003cButton onclick={onAction} class=\"min-h-[44px]\"\u003e\n        {actionLabel}\n      \u003c/Button\u003e\n    {/if}\n    \n    {#if children}\n      {@render children()}\n    {/if}\n  \u003c/div\u003e\n\u003c/BlurFade\u003e\n```\n\n### REFACTOR Phase\n- Add subtle animations to illustrations\n- Create context-specific empty states for each view\n- Add \"learn more\" links to documentation\n- Consider dark mode illustrations\n\n## Files to Modify\n- `web-ui/src/lib/components/EmptyState.svelte` (new)\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/projects/[slug]/+page.svelte`\n- `web-ui/src/routes/inbox/+page.svelte`\n\n## Definition of Done\n- [ ] All Playwright tests pass\n- [ ] Every empty state has icon, title, description\n- [ ] Primary CTA is visible and accessible\n- [ ] Empty states are context-aware\n- [ ] Keyboard accessible (Tab to CTA)\n- [ ] Works well in both light and dark modes","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T05:12:55.527039+05:30","updated_at":"2025-12-24T05:12:55.527039+05:30"}
{"id":"mcpmail-o65p","title":"Dashboard Overhaul: Stats Cards, Animations, Enhanced UX","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-24T08:01:28.770653+05:30","updated_at":"2025-12-24T08:09:53.543621+05:30","closed_at":"2025-12-24T08:09:53.543621+05:30","close_reason":"Dashboard overhaul complete: commit f5403b8"}
{"id":"mcpmail-pnbk","title":"P0: Address security SATD in time_travel.rs:146","description":"**Issue**: PMAT detected Critical SATD (Self-Admitted Technical Debt) with security implications at time_travel.rs line 146.\n\n**Risk**: Security-related technical debt in production code can lead to:\n- Exploitable vulnerabilities\n- Data integrity issues\n- Authentication/authorization bypasses\n- Time-based attack vectors in time_travel module\n\n**Location**: crates/lib-bmc/src/time_travel.rs:146\n\n**Investigation Required**:\n1. Review the specific code and comment at line 146\n2. Identify what security concern is noted\n3. Determine if it's a TODO, FIXME, HACK, or explicit security warning\n4. Assess actual vulnerability surface\n\n**Fix Strategy**:\n1. Address the security concern directly\n2. If deferred fix, add tracking issue with timeline\n3. Document risk assessment if accepting temporarily\n4. Add regression test for security behavior\n\n**Test Strategy**:\n- Security-focused unit tests\n- Fuzz testing for time manipulation inputs\n- Review for time-of-check-time-of-use (TOCTOU) issues\n\n**Severity**: Critical - security debt in production","status":"closed","issue_type":"bug","created_at":"2025-12-24T02:58:44.682727+05:30","updated_at":"2025-12-24T03:06:04.928837+05:30","closed_at":"2025-12-24T03:06:04.928837+05:30","close_reason":"False positive: Line 146 in time_travel.rs is XSS prevention validation code (security-positive), not security debt. The comment 'Validate inputs for XSS prevention' was likely misidentified as SATD. Validation includes: empty check, XSS character filtering (\u003c\u003e\"\\'\u0026\\0), and path traversal prevention (.. / \\). No action required."}
{"id":"mcpmail-qb7f","title":"[P2] Add delete UI for projects and agents (ConfirmDialog, dropdown menus)","description":"## Summary\nAdd dropdown menus with delete option to project cards and agent cards, with confirmation dialogs before deletion.\n\n## Prerequisites\n- Backend delete endpoints already implemented (DELETE /api/projects/{slug}, DELETE /api/projects/{slug}/agents/{name})\n- API client functions already added (deleteProject, deleteAgent in $lib/api/client.ts)\n\n## Acceptance Criteria\n- [ ] Project cards show \"...\" menu button (visible on hover)\n- [ ] Agent cards show \"...\" menu button (visible on hover)\n- [ ] Clicking Delete opens AlertDialog confirmation\n- [ ] Confirmation warns about permanent deletion\n- [ ] After confirmation, delete API is called and list refreshes\n- [ ] Success/error toasts are shown\n\n## Implementation Guide\n\n### File 1: `crates/services/web-ui/src/routes/projects/+page.svelte`\n\n1. Add imports:\n```svelte\nimport * as DropdownMenu from '$lib/components/ui/dropdown-menu';\nimport * as AlertDialog from '$lib/components/ui/alert-dialog';\nimport MoreVertical from 'lucide-svelte/icons/more-vertical';\nimport Trash from 'lucide-svelte/icons/trash-2';\nimport { deleteProject } from '$lib/api/client';\n```\n\n2. Add state variables:\n```svelte\nlet showDeleteDialog = $state(false);\nlet projectToDelete = $state\u003cProject | null\u003e(null);\nlet deleting = $state(false);\n```\n\n3. Add delete functions:\n```svelte\nfunction handleDeleteClick(e: Event, project: Project) {\n    e.preventDefault();\n    e.stopPropagation();\n    projectToDelete = project;\n    showDeleteDialog = true;\n}\n\nasync function confirmDelete() {\n    if (!projectToDelete) return;\n    deleting = true;\n    try {\n        await deleteProject(projectToDelete.slug);\n        toast.success(`Project \"${projectToDelete.human_key}\" deleted`);\n        await loadProjects();\n    } catch (e) {\n        toast.error(e instanceof Error ? e.message : 'Failed to delete project');\n    } finally {\n        deleting = false;\n        showDeleteDialog = false;\n        projectToDelete = null;\n    }\n}\n```\n\n4. Add DropdownMenu.Root inside project card before ArrowRight icon\n\n5. Add AlertDialog.Root at bottom before \u003c/div\u003e and \u003cstyle\u003e\n\n### File 2: `crates/services/web-ui/src/routes/projects/[slug]/+page.svelte`\n\nSimilar pattern for agent cards with deleteAgent function.\n\n## Technical Notes\n- Use Svelte 5 runes ($state, $effect)\n- Use onclick not on:click\n- Use svelte-sonner for toasts\n- Follow existing shadcn-svelte patterns\n- Existing components: alert-dialog, dropdown-menu already available","notes":"Worker: CrimsonFalcon implementing delete UI","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-24T17:59:48.121529+05:30","updated_at":"2025-12-24T18:01:27.482483+05:30"}
{"id":"mcpmail-qxol","title":"[P0] Style 404 error page with navigation help","description":"## Problem\nSettings page (and other 404s) shows completely unstyled error:\n```\n404\nNot Found\n```\n\nNo styling, no navigation, no way back. Exposes broken features via Command Palette.\n\n## Impact\n- Users who click \"Settings\" from Command Palette hit dead end\n- No guidance on how to recover\n- Unprofessional appearance\n- Broken feature advertised in main UI\n\n## TDD Acceptance Criteria\n\n### RED Phase - 404 Page Tests\n```typescript\n// web-ui/tests/error-pages.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('404 Error Page', () =\u003e {\n  test('displays styled error page', async ({ page }) =\u003e {\n    await page.goto('/nonexistent-page');\n    \n    // Should have proper styling\n    const errorContainer = page.locator('[data-testid=\"error-page\"]');\n    await expect(errorContainer).toBeVisible();\n    \n    // Should show error code and message\n    await expect(page.getByText('404')).toBeVisible();\n    await expect(page.getByText(/page.*not found/i)).toBeVisible();\n  });\n\n  test('provides navigation back to home', async ({ page }) =\u003e {\n    await page.goto('/nonexistent-page');\n    \n    const homeLink = page.getByRole('link', { name: /home|dashboard/i });\n    await expect(homeLink).toBeVisible();\n    \n    await homeLink.click();\n    await expect(page).toHaveURL('/');\n  });\n\n  test('provides navigation back (browser history)', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    await page.goto('/nonexistent-page');\n    \n    const backButton = page.getByRole('button', { name: /back/i });\n    await expect(backButton).toBeVisible();\n  });\n\n  test('shows helpful suggestions', async ({ page }) =\u003e {\n    await page.goto('/setings'); // Typo\n    \n    // Should suggest similar pages\n    await expect(page.getByText(/looking for/i)).toBeVisible();\n  });\n\n  test('maintains dark mode styling', async ({ page }) =\u003e {\n    await page.goto('/nonexistent-page');\n    \n    // Check dark mode is applied\n    const html = page.locator('html');\n    await expect(html).toHaveClass(/dark/);\n    \n    // Error page should have dark background\n    const container = page.locator('[data-testid=\"error-page\"]');\n    const bg = await container.evaluate(el =\u003e \n      getComputedStyle(el).backgroundColor\n    );\n    expect(bg).not.toBe('rgb(255, 255, 255)'); // Not white\n  });\n});\n```\n\n### GREEN Phase - Implementation\n```svelte\n\u003c!-- web-ui/src/routes/+error.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { page } from '$app/stores';\n  import { goto } from '$app/navigation';\n  import Home from 'lucide-svelte/icons/home';\n  import ArrowLeft from 'lucide-svelte/icons/arrow-left';\n  import Search from 'lucide-svelte/icons/search';\n  import { Button } from '$lib/components/ui/button';\n  import { BlurFade } from '$lib/components/magic';\n\n  $: status = $page.status;\n  $: message = $page.error?.message ?? 'Page not found';\n\n  function goBack() {\n    history.back();\n  }\n\n  const suggestions = [\n    { href: '/', label: 'Dashboard', icon: Home },\n    { href: '/projects', label: 'Projects', icon: Search },\n    { href: '/mail', label: 'Mail', icon: Search },\n  ];\n\u003c/script\u003e\n\n\u003cdiv \n  class=\"min-h-screen flex items-center justify-center bg-background\"\n  data-testid=\"error-page\"\n\u003e\n  \u003cBlurFade delay={0}\u003e\n    \u003cdiv class=\"text-center space-y-6 p-8 max-w-md\"\u003e\n      \u003c!-- Error Code --\u003e\n      \u003cdiv class=\"text-8xl font-bold text-muted-foreground/30\"\u003e\n        {status}\n      \u003c/div\u003e\n      \n      \u003c!-- Error Message --\u003e\n      \u003cdiv class=\"space-y-2\"\u003e\n        \u003ch1 class=\"text-2xl font-semibold text-foreground\"\u003e\n          {#if status === 404}\n            Page Not Found\n          {:else if status === 500}\n            Server Error\n          {:else}\n            Something Went Wrong\n          {/if}\n        \u003c/h1\u003e\n        \u003cp class=\"text-muted-foreground\"\u003e\n          {message}\n        \u003c/p\u003e\n      \u003c/div\u003e\n      \n      \u003c!-- Actions --\u003e\n      \u003cdiv class=\"flex flex-col sm:flex-row gap-3 justify-center\"\u003e\n        \u003cButton variant=\"outline\" on:click={goBack}\u003e\n          \u003cArrowLeft class=\"h-4 w-4 mr-2\" /\u003e\n          Go Back\n        \u003c/Button\u003e\n        \u003cButton on:click={() =\u003e goto('/')}\u003e\n          \u003cHome class=\"h-4 w-4 mr-2\" /\u003e\n          Dashboard\n        \u003c/Button\u003e\n      \u003c/div\u003e\n      \n      \u003c!-- Suggestions --\u003e\n      {#if status === 404}\n        \u003cdiv class=\"pt-6 border-t border-border\"\u003e\n          \u003cp class=\"text-sm text-muted-foreground mb-3\"\u003e\n            Looking for one of these?\n          \u003c/p\u003e\n          \u003cdiv class=\"flex flex-wrap gap-2 justify-center\"\u003e\n            {#each suggestions as { href, label }}\n              \u003cButton variant=\"ghost\" size=\"sm\" href={href}\u003e\n                {label}\n              \u003c/Button\u003e\n            {/each}\n          \u003c/div\u003e\n        \u003c/div\u003e\n      {/if}\n    \u003c/div\u003e\n  \u003c/BlurFade\u003e\n\u003c/div\u003e\n```\n\n### REFACTOR Phase - Remove Settings from Command Palette\n```svelte\n\u003c!-- Until Settings page is implemented, remove from palette --\u003e\n\u003c!-- components/command-palette/CommandPalette.svelte --\u003e\nconst commands = [\n  { name: 'Dashboard', href: '/', shortcut: 'G D' },\n  { name: 'Projects', href: '/projects', shortcut: 'G P' },\n  { name: 'Mail', href: '/mail', shortcut: 'G M' },\n  { name: 'Toggle Theme', action: toggleTheme, shortcut: 'T T' },\n  // REMOVED: { name: 'Settings', href: '/settings', shortcut: 'G S' },\n  { name: 'Show Tutorial', action: showTutorial, shortcut: '?' },\n];\n```\n\n## Checklist\n- [ ] Write Playwright tests for 404 page\n- [ ] Create +error.svelte with styled layout\n- [ ] Add \"Go Back\" button with history.back()\n- [ ] Add \"Dashboard\" link\n- [ ] Add page suggestions\n- [ ] Ensure dark mode works\n- [ ] Remove Settings from Command Palette (until implemented)\n- [ ] Add data-testid attributes\n- [ ] All tests pass\n\n## Files to Create\n- `web-ui/src/routes/+error.svelte`\n- `web-ui/tests/error-pages.spec.ts`\n\n## Files to Modify\n- `web-ui/src/lib/components/command-palette/CommandPalette.svelte`","status":"closed","issue_type":"bug","created_at":"2025-12-24T05:03:37.794005+05:30","updated_at":"2025-12-24T06:07:39.608694+05:30","closed_at":"2025-12-24T06:07:39.608694+05:30","close_reason":"Created styled +error.svelte with: error icon, 404 code, helpful message, Go Back/Dashboard buttons, page suggestions. Removed Settings from CommandPalette."}
{"id":"mcpmail-snc8","title":"[P0] Hide UUIDs from all user-facing UI components","description":"## Problem\nUUIDs (like `sum-proj1-939d8ea4-944a-4ff3-b037-a039fa44da56`) are still visible \nthroughout the UI, creating a developer-debugging experience rather than user-friendly design.\n\n## Screenshot Evidence\n- Project cards show full UUID as secondary text (overflows card width)\n- Mail list items display project UUIDs as primary context\n- Dashboard \"Recent Projects\" shows UUIDs\n- Breadcrumbs contain full UUIDs\n- Browser tab titles contain UUIDs\n\n## Affected Components\n1. `routes/projects/+page.svelte` - Project cards\n2. `routes/mail/+page.svelte` - Mail list items  \n3. `routes/+page.svelte` - Dashboard recent projects\n4. `routes/projects/[slug]/+page.svelte` - Breadcrumb, header badges\n5. `+layout.svelte` - Page titles\n\n## Design Principle\n\u003e Internal identifiers (UUIDs, database IDs) are implementation details.\n\u003e Users should NEVER see them unless explicitly requested via \"advanced\" UI.\n\n## TDD Acceptance Criteria\n\n### RED Phase - Visual Regression Tests\n```typescript\n// web-ui/tests/uuid-hiding.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('UUID Visibility', () =\u003e {\n  test('project cards do NOT show UUIDs', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const cards = page.locator('[data-testid=\"project-card\"]');\n    const firstCard = cards.first();\n    \n    // UUID pattern: 8-4-4-4-12 hex chars\n    const uuidPattern = /[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/i;\n    \n    const cardText = await firstCard.textContent();\n    expect(cardText).not.toMatch(uuidPattern);\n  });\n\n  test('mail list items show project NAME not UUID', async ({ page }) =\u003e {\n    await page.goto('/mail');\n    \n    const mailItem = page.locator('[data-testid=\"mail-item\"]').first();\n    const projectContext = mailItem.locator('[data-testid=\"project-context\"]');\n    \n    const text = await projectContext.textContent();\n    expect(text).not.toMatch(/[a-f0-9]{8}-/i); // No UUID prefix\n    expect(text).toMatch(/^[A-Z]/); // Starts with capital (human name)\n  });\n\n  test('breadcrumbs show human-readable names', async ({ page }) =\u003e {\n    await page.goto('/projects/some-project-slug');\n    \n    const breadcrumb = page.locator('nav[aria-label=\"breadcrumb\"]');\n    const text = await breadcrumb.textContent();\n    \n    expect(text).not.toMatch(/[a-f0-9]{8}-[a-f0-9]{4}/i);\n  });\n\n  test('page titles do NOT contain UUIDs', async ({ page }) =\u003e {\n    await page.goto('/projects/some-project-slug');\n    \n    const title = await page.title();\n    expect(title).not.toMatch(/[a-f0-9]{8}-/i);\n  });\n});\n```\n\n### GREEN Phase - Implementation\n\n**1. Project Card - Hide UUID completely**\n```svelte\n\u003c!-- routes/projects/+page.svelte --\u003e\n\u003cdiv class=\"project-card\" data-testid=\"project-card\"\u003e\n  \u003cdiv class=\"flex items-center gap-3\"\u003e\n    \u003cFolderKanban class=\"h-5 w-5 text-primary-600\" /\u003e\n    \u003cdiv\u003e\n      \u003ch3 class=\"font-semibold\"\u003e{project.human_key}\u003c/h3\u003e\n      \u003cp class=\"text-xs text-muted-foreground\"\u003e\n        Created {formatDate(project.created_at)}\n      \u003c/p\u003e\n      \u003c!-- REMOVED: \u003ccode class=\"text-xs\"\u003e{project.slug}\u003c/code\u003e --\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n**2. Mail List - Show project name instead of UUID**\n```svelte\n\u003c!-- components/mail/MailListItem.svelte --\u003e\n\u003cdiv data-testid=\"project-context\"\u003e\n  \u003c!-- BEFORE: {message.thread_id} which contained UUID --\u003e\n  \u003c!-- AFTER: Show resolved project name --\u003e\n  {projectName}\n\u003c/div\u003e\n```\n\n**3. Breadcrumb - Use human_key**\n```svelte\n\u003c!-- routes/projects/[slug]/+page.svelte --\u003e\n\u003cnav aria-label=\"breadcrumb\"\u003e\n  \u003ca href=\"/projects\"\u003eProjects\u003c/a\u003e / \n  \u003cspan\u003e{project?.human_key ?? 'Loading...'}\u003c/span\u003e\n  \u003c!-- REMOVED: project.slug display --\u003e\n\u003c/nav\u003e\n```\n\n**4. Badge component - Show short ID or hide**\n```svelte\n\u003c!-- If we MUST show an ID, truncate it --\u003e\n{#if showAdvanced}\n  \u003ccode class=\"text-xs truncate max-w-[8ch]\" title={project.slug}\u003e\n    {project.slug.slice(0, 8)}…\n  \u003c/code\u003e\n{/if}\n```\n\n### REFACTOR Phase - Create UUID Utility\n```typescript\n// lib/utils/display.ts\n\n/**\n * Format a slug/UUID for display.\n * Returns truncated form or empty string based on context.\n */\nexport function formatSlugForDisplay(\n  slug: string, \n  options: { showShort?: boolean; maxLength?: number } = {}\n): string {\n  const { showShort = false, maxLength = 8 } = options;\n  \n  if (!showShort) return '';\n  \n  // If it looks like a UUID, truncate\n  if (slug.includes('-') \u0026\u0026 slug.length \u003e 20) {\n    return slug.slice(0, maxLength) + '…';\n  }\n  \n  return slug;\n}\n\n/**\n * Check if string is a UUID pattern\n */\nexport function isUUID(str: string): boolean {\n  return /^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i.test(str);\n}\n```\n\n## Visual Fix for Overflow\nThe screenshot shows UUID overflowing card boundaries:\n```css\n/* Add to project card styles */\n.project-card .slug-display {\n  max-width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n```\n\n## Checklist\n- [ ] Write Playwright tests for UUID visibility\n- [ ] Remove UUID from project cards on /projects\n- [ ] Remove UUID from dashboard recent projects\n- [ ] Replace UUID with project name in mail list\n- [ ] Update breadcrumbs to use human_key only\n- [ ] Update page titles to exclude UUIDs\n- [ ] Add formatSlugForDisplay utility\n- [ ] Add data-testid attributes to affected components\n- [ ] Run visual regression tests\n- [ ] All tests pass\n\n## Files to Modify\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/+page.svelte` (dashboard)\n- `web-ui/src/routes/projects/[slug]/+page.svelte`\n- `web-ui/src/routes/mail/+page.svelte`\n- `web-ui/src/lib/utils/display.ts` (new)\n- `web-ui/tests/uuid-hiding.spec.ts` (new)","status":"closed","issue_type":"bug","created_at":"2025-12-24T05:03:37.350294+05:30","updated_at":"2025-12-24T05:54:09.091674+05:30","closed_at":"2025-12-24T05:54:09.091674+05:30","close_reason":"Fixed UUID visibility: removed from project cards, breadcrumbs. Also fixed thread API mismatch causing infinite loading."}
{"id":"mcpmail-ud0i","title":"[P1] Add delete/archive functionality for projects and agents","description":"## Problem\nNo way to delete or archive projects/agents. Users cannot:\n- Remove test projects\n- Clean up unused agents\n- Archive completed work\n\n## Missing CRUD Operations\n| Entity | Create | Read | Update | Delete |\n|--------|--------|------|--------|--------|\n| Project | ✅ | ✅ | ❌ | ❌ |\n| Agent | ✅ | ✅ | ❌ | ❌ |\n\n## TDD Acceptance Criteria\n\n### RED Phase - Delete/Archive Tests\n```typescript\n// web-ui/tests/crud-operations.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Project Management', () =\u003e {\n  test('can delete project via context menu', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    // Right-click or click menu on project card\n    const card = page.locator('[data-testid=\"project-card\"]').first();\n    await card.locator('[data-testid=\"project-menu\"]').click();\n    \n    await page.click('text=Delete');\n    \n    // Confirmation dialog\n    const dialog = page.locator('[data-testid=\"confirm-dialog\"]');\n    await expect(dialog).toBeVisible();\n    await expect(dialog.getByText(/permanently delete/i)).toBeVisible();\n    \n    await dialog.getByRole('button', { name: 'Delete' }).click();\n    \n    // Success toast\n    await expect(page.getByText(/deleted/i)).toBeVisible();\n  });\n\n  test('can archive project', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const card = page.locator('[data-testid=\"project-card\"]').first();\n    await card.locator('[data-testid=\"project-menu\"]').click();\n    \n    await page.click('text=Archive');\n    \n    // Project should disappear from main list\n    await expect(page.getByText(/archived/i)).toBeVisible();\n  });\n\n  test('delete requires confirmation', async ({ page }) =\u003e {\n    await page.goto('/projects');\n    \n    const card = page.locator('[data-testid=\"project-card\"]').first();\n    await card.locator('[data-testid=\"project-menu\"]').click();\n    await page.click('text=Delete');\n    \n    const dialog = page.locator('[data-testid=\"confirm-dialog\"]');\n    await dialog.getByRole('button', { name: 'Cancel' }).click();\n    \n    // Card should still exist\n    await expect(card).toBeVisible();\n  });\n});\n\ntest.describe('Agent Management', () =\u003e {\n  test('can delete agent from project detail', async ({ page }) =\u003e {\n    await page.goto('/projects/test-project');\n    \n    const agentCard = page.locator('[data-testid=\"agent-card\"]').first();\n    await agentCard.locator('[data-testid=\"agent-menu\"]').click();\n    \n    await page.click('text=Delete');\n    \n    const dialog = page.locator('[data-testid=\"confirm-dialog\"]');\n    await dialog.getByRole('button', { name: 'Delete' }).click();\n    \n    await expect(page.getByText(/agent deleted/i)).toBeVisible();\n  });\n});\n```\n\n### GREEN Phase - UI Implementation\n\n**1. Add Menu to Project Card**\n```svelte\n\u003c!-- routes/projects/+page.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import * as DropdownMenu from '$lib/components/ui/dropdown-menu';\n  import MoreVertical from 'lucide-svelte/icons/more-vertical';\n  import Trash from 'lucide-svelte/icons/trash-2';\n  import Archive from 'lucide-svelte/icons/archive';\n  \n  let showDeleteDialog = false;\n  let projectToDelete: Project | null = null;\n  \n  async function handleDelete(project: Project) {\n    projectToDelete = project;\n    showDeleteDialog = true;\n  }\n  \n  async function confirmDelete() {\n    if (!projectToDelete) return;\n    try {\n      await deleteProject(projectToDelete.slug);\n      toast.success('Project deleted');\n      await loadProjects();\n    } catch (e) {\n      toast.error('Failed to delete project');\n    }\n    showDeleteDialog = false;\n  }\n\u003c/script\u003e\n\n{#each projects as project}\n  \u003cdiv class=\"project-card\" data-testid=\"project-card\"\u003e\n    \u003c!-- ... card content ... --\u003e\n    \n    \u003cDropdownMenu.Root\u003e\n      \u003cDropdownMenu.Trigger asChild\u003e\n        \u003cbutton data-testid=\"project-menu\"\u003e\n          \u003cMoreVertical class=\"h-4 w-4\" /\u003e\n        \u003c/button\u003e\n      \u003c/DropdownMenu.Trigger\u003e\n      \u003cDropdownMenu.Content\u003e\n        \u003cDropdownMenu.Item on:click={() =\u003e handleArchive(project)}\u003e\n          \u003cArchive class=\"h-4 w-4 mr-2\" /\u003e\n          Archive\n        \u003c/DropdownMenu.Item\u003e\n        \u003cDropdownMenu.Separator /\u003e\n        \u003cDropdownMenu.Item \n          class=\"text-destructive\"\n          on:click={() =\u003e handleDelete(project)}\n        \u003e\n          \u003cTrash class=\"h-4 w-4 mr-2\" /\u003e\n          Delete\n        \u003c/DropdownMenu.Item\u003e\n      \u003c/DropdownMenu.Content\u003e\n    \u003c/DropdownMenu.Root\u003e\n  \u003c/div\u003e\n{/each}\n\n\u003c!-- Confirmation Dialog --\u003e\n\u003cConfirmDialog\n  bind:open={showDeleteDialog}\n  title=\"Delete Project\"\n  description=\"This will permanently delete '{projectToDelete?.human_key}' and all its agents and messages. This action cannot be undone.\"\n  confirmLabel=\"Delete\"\n  variant=\"destructive\"\n  on:confirm={confirmDelete}\n/\u003e\n```\n\n**2. API Endpoints**\n```typescript\n// lib/api/client.ts\nexport async function deleteProject(slug: string): Promise\u003cvoid\u003e {\n  await request(`/projects/${slug}`, { method: 'DELETE' });\n}\n\nexport async function archiveProject(slug: string): Promise\u003cvoid\u003e {\n  await request(`/projects/${slug}/archive`, { method: 'POST' });\n}\n\nexport async function deleteAgent(projectSlug: string, agentName: string): Promise\u003cvoid\u003e {\n  await request(`/projects/${projectSlug}/agents/${agentName}`, { method: 'DELETE' });\n}\n```\n\n**3. ConfirmDialog Component**\n```svelte\n\u003c!-- components/ui/confirm-dialog.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import * as AlertDialog from '$lib/components/ui/alert-dialog';\n  import { Button } from '$lib/components/ui/button';\n  import { createEventDispatcher } from 'svelte';\n  \n  export let open = false;\n  export let title: string;\n  export let description: string;\n  export let confirmLabel = 'Confirm';\n  export let variant: 'default' | 'destructive' = 'default';\n  \n  const dispatch = createEventDispatcher();\n\u003c/script\u003e\n\n\u003cAlertDialog.Root bind:open\u003e\n  \u003cAlertDialog.Content data-testid=\"confirm-dialog\"\u003e\n    \u003cAlertDialog.Header\u003e\n      \u003cAlertDialog.Title\u003e{title}\u003c/AlertDialog.Title\u003e\n      \u003cAlertDialog.Description\u003e{description}\u003c/AlertDialog.Description\u003e\n    \u003c/AlertDialog.Header\u003e\n    \u003cAlertDialog.Footer\u003e\n      \u003cAlertDialog.Cancel\u003eCancel\u003c/AlertDialog.Cancel\u003e\n      \u003cAlertDialog.Action asChild\u003e\n        \u003cButton {variant} on:click={() =\u003e dispatch('confirm')}\u003e\n          {confirmLabel}\n        \u003c/Button\u003e\n      \u003c/AlertDialog.Action\u003e\n    \u003c/AlertDialog.Footer\u003e\n  \u003c/AlertDialog.Content\u003e\n\u003c/AlertDialog.Root\u003e\n```\n\n## Backend API Required\n```rust\n// DELETE /api/projects/{slug}\n// POST /api/projects/{slug}/archive\n// DELETE /api/projects/{slug}/agents/{name}\n```\n\n## Checklist\n- [ ] Write Playwright tests for delete flow\n- [ ] Write Playwright tests for archive flow\n- [ ] Create ConfirmDialog component\n- [ ] Add menu to project cards\n- [ ] Add menu to agent cards\n- [ ] Implement deleteProject API\n- [ ] Implement archiveProject API\n- [ ] Implement deleteAgent API\n- [ ] Add backend DELETE endpoints\n- [ ] Add success/error toasts\n- [ ] All tests pass\n\n## Files to Create\n- `web-ui/src/lib/components/ui/confirm-dialog.svelte`\n- `web-ui/tests/crud-operations.spec.ts`\n\n## Files to Modify\n- `web-ui/src/routes/projects/+page.svelte`\n- `web-ui/src/routes/projects/[slug]/+page.svelte`\n- `web-ui/src/lib/api/client.ts`\n- Backend: `lib-server/src/api.rs` (new endpoints)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-24T05:05:43.884346+05:30","updated_at":"2025-12-24T17:55:08.744101+05:30","closed_at":"2025-12-24T17:55:08.744101+05:30","close_reason":"Implemented delete functionality for projects and agents with cascade deletion, REST API endpoints (DELETE /api/projects/{slug} and DELETE /api/projects/{slug}/agents/{name}), integration tests, and web-ui API client functions. UI components (ConfirmDialog, dropdown menus) can be added in a follow-up task."}
{"id":"mcpmail-uesq","title":"[P2] Add request size limits to HTTP transport","description":"## Problem\nHTTP transport lacks request body size limits, allowing potential memory \nexhaustion via oversized requests.\n\n## Security Impact\n- NIST SC-5 (DoS Protection) - incomplete\n- Potential OOM from large request bodies\n- No defense against slow-loris style attacks\n\n## TDD Acceptance Criteria\n\n### RED Phase - Size Limit Tests\n```rust\n// lib-server/tests/request_size_tests.rs\n\n#[tokio::test]\nasync fn test_request_body_limit_enforced() {\n    let app = test_app().await;\n    \n    // Create 2MB body (above 1MB limit)\n    let large_body = \"x\".repeat(2 * 1024 * 1024);\n    \n    let resp = app.post(\"/api/message/send\")\n        .json(\u0026json!({\n            \"project_slug\": \"test\",\n            \"sender_name\": \"agent\",\n            \"to\": \"other\",\n            \"subject\": \"test\",\n            \"body_md\": large_body\n        }))\n        .send()\n        .await;\n    \n    assert_eq!(resp.status(), StatusCode::PAYLOAD_TOO_LARGE);\n}\n\n#[tokio::test]\nasync fn test_requests_under_limit_succeed() {\n    let app = test_app_with_data().await;\n    \n    // Create 500KB body (under 1MB limit)\n    let body = \"x\".repeat(500 * 1024);\n    \n    let resp = app.post(\"/api/message/send\")\n        .json(\u0026json!({\n            \"project_slug\": \"test\",\n            \"sender_name\": \"agent1\",\n            \"to\": \"agent2\",\n            \"subject\": \"test\",\n            \"body_md\": body\n        }))\n        .send()\n        .await;\n    \n    // Should succeed (assuming valid data)\n    assert!(resp.status().is_success() || resp.status() == StatusCode::BAD_REQUEST);\n}\n\n#[tokio::test]\nasync fn test_attachment_endpoint_has_higher_limit() {\n    let app = test_app().await;\n    \n    // 5MB attachment (under 10MB attachment limit)\n    let attachment_data = base64::encode(\u0026vec![0u8; 5 * 1024 * 1024]);\n    \n    let resp = app.post(\"/api/attachments/add\")\n        .json(\u0026json!({\n            \"message_id\": 1,\n            \"filename\": \"large.bin\",\n            \"content_base64\": attachment_data\n        }))\n        .send()\n        .await;\n    \n    // Should not fail due to size (may fail for other reasons)\n    assert_ne!(resp.status(), StatusCode::PAYLOAD_TOO_LARGE);\n}\n\n#[tokio::test]\nasync fn test_size_limit_configurable_via_env() {\n    std::env::set_var(\"MAX_REQUEST_SIZE_MB\", \"5\");\n    let app = test_app().await;\n    \n    // 3MB body should now succeed\n    let body = \"x\".repeat(3 * 1024 * 1024);\n    \n    let resp = app.post(\"/api/message/send\")\n        .json(\u0026json!({\n            \"project_slug\": \"test\",\n            \"sender_name\": \"agent\",\n            \"to\": \"other\",\n            \"subject\": \"test\",\n            \"body_md\": body\n        }))\n        .send()\n        .await;\n    \n    assert_ne!(resp.status(), StatusCode::PAYLOAD_TOO_LARGE);\n    std::env::remove_var(\"MAX_REQUEST_SIZE_MB\");\n}\n```\n\n### GREEN Phase - Implementation\n```rust\n// lib-server/src/middleware/body_limit.rs\n\nuse axum::{\n    body::Body,\n    extract::Request,\n    http::StatusCode,\n    middleware::Next,\n    response::{IntoResponse, Response},\n};\nuse tower_http::limit::RequestBodyLimitLayer;\n\n/// Request body size configuration\n#[derive(Clone)]\npub struct BodyLimitConfig {\n    /// Default limit for most endpoints (bytes)\n    pub default_limit: usize,\n    /// Higher limit for attachment endpoints (bytes)\n    pub attachment_limit: usize,\n}\n\nimpl Default for BodyLimitConfig {\n    fn default() -\u003e Self {\n        Self::from_env()\n    }\n}\n\nimpl BodyLimitConfig {\n    pub fn from_env() -\u003e Self {\n        let default_mb = std::env::var(\"MAX_REQUEST_SIZE_MB\")\n            .ok()\n            .and_then(|s| s.parse::\u003cusize\u003e().ok())\n            .unwrap_or(1); // 1MB default\n            \n        let attachment_mb = std::env::var(\"MAX_ATTACHMENT_SIZE_MB\")\n            .ok()\n            .and_then(|s| s.parse::\u003cusize\u003e().ok())\n            .unwrap_or(10); // 10MB for attachments\n        \n        Self {\n            default_limit: default_mb * 1024 * 1024,\n            attachment_limit: attachment_mb * 1024 * 1024,\n        }\n    }\n    \n    pub fn default_layer(\u0026self) -\u003e RequestBodyLimitLayer {\n        RequestBodyLimitLayer::new(self.default_limit)\n    }\n    \n    pub fn attachment_layer(\u0026self) -\u003e RequestBodyLimitLayer {\n        RequestBodyLimitLayer::new(self.attachment_limit)\n    }\n}\n```\n\n### REFACTOR Phase - Router Configuration\n```rust\n// lib-server/src/lib.rs\n\npub fn create_router(state: AppState) -\u003e Router {\n    let body_config = BodyLimitConfig::from_env();\n    \n    // Standard routes with default limit\n    let standard_routes = api::routes()\n        .layer(body_config.default_layer());\n    \n    // Attachment routes with higher limit\n    let attachment_routes = Router::new()\n        .route(\"/api/attachments/add\", post(tools::add_attachment))\n        .layer(body_config.attachment_layer());\n    \n    Router::new()\n        .merge(attachment_routes) // Higher limit routes first\n        .merge(standard_routes)   // Default limit for rest\n        .with_state(state)\n        .layer(middleware::from_fn_with_state(\n            rate_limit_config,\n            rate_limit_middleware,\n        ))\n}\n```\n\n## Configuration\n| Env Variable | Default | Description |\n|--------------|---------|-------------|\n| MAX_REQUEST_SIZE_MB | 1 | Default body limit in MB |\n| MAX_ATTACHMENT_SIZE_MB | 10 | Attachment body limit in MB |\n\n## Checklist\n- [ ] Write failing test for oversized request rejection\n- [ ] Write failing test for under-limit success\n- [ ] Write failing test for attachment higher limit\n- [ ] Write failing test for env configuration\n- [ ] Implement BodyLimitConfig\n- [ ] Add RequestBodyLimitLayer to standard routes\n- [ ] Add higher limit layer to attachment routes\n- [ ] Add tower-http dependency if not present\n- [ ] Document limits in API docs\n- [ ] All tests pass\n\n## Files to Create\n- `lib-server/src/middleware/body_limit.rs`\n- `lib-server/tests/request_size_tests.rs`\n\n## Files to Modify\n- `lib-server/src/lib.rs`\n- `lib-server/Cargo.toml` (tower-http features)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-24T04:58:32.846146+05:30","updated_at":"2025-12-24T04:58:32.846146+05:30"}
{"id":"mcpmail-uqpm","title":"[P1] Add structured error codes to McpError responses","description":"## Problem\nError responses lack structured codes for client parsing. Current pattern:\n```rust\nMcpError::internal_error(e.to_string(), None)\n```\n\nThis loses context and makes client-side error handling brittle.\n\n## Current State\n```json\n{\n  \"error\": {\n    \"code\": -32603,\n    \"message\": \"Failed to create agent: UNIQUE constraint failed\"\n  }\n}\n```\n\n## Target State\n```json\n{\n  \"error\": {\n    \"code\": -32603,\n    \"message\": \"Failed to create agent: UNIQUE constraint failed\",\n    \"data\": {\n      \"error_code\": \"AGENT_ALREADY_EXISTS\",\n      \"project_id\": 1,\n      \"agent_name\": \"claude_1\",\n      \"suggestion\": \"Use a different agent name or check existing agents with list_agents\"\n    }\n  }\n}\n```\n\n## TDD Acceptance Criteria\n\n### RED Phase - Error Code Tests\n```rust\n// lib-mcp/tests/error_code_tests.rs\n\n#[tokio::test]\nasync fn test_duplicate_agent_returns_error_code() {\n    let service = test_service().await;\n    \n    // First registration succeeds\n    service.register_agent(valid_params()).await.unwrap();\n    \n    // Second registration returns structured error\n    let err = service.register_agent(valid_params()).await.unwrap_err();\n    \n    let data = err.data.as_ref().expect(\"error should have data\");\n    assert_eq!(data.get(\"error_code\").unwrap(), \"AGENT_ALREADY_EXISTS\");\n    assert!(data.get(\"suggestion\").is_some());\n}\n\n#[tokio::test]\nasync fn test_not_found_includes_similar_suggestions() {\n    let service = test_service().await;\n    setup_agent(\u0026service, \"claude_assistant\").await;\n    \n    let err = service.whois(WhoisParams {\n        project_slug: \"test\".into(),\n        agent_name: \"claud_assistant\".into(), // Typo\n    }).await.unwrap_err();\n    \n    let data = err.data.as_ref().unwrap();\n    assert_eq!(data.get(\"error_code\").unwrap(), \"AGENT_NOT_FOUND\");\n    let similar: Vec\u003cString\u003e = serde_json::from_value(\n        data.get(\"similar\").unwrap().clone()\n    ).unwrap();\n    assert!(similar.contains(\u0026\"claude_assistant\".to_string()));\n}\n\n#[tokio::test]\nasync fn test_capability_denied_includes_capability_name() {\n    let service = test_service().await;\n    let agent = setup_agent_without_capabilities(\u0026service).await;\n    \n    let err = service.send_message(SendMessageParams {\n        sender_name: agent.name,\n        ..Default::default()\n    }).await.unwrap_err();\n    \n    let data = err.data.as_ref().unwrap();\n    assert_eq!(data.get(\"error_code\").unwrap(), \"CAPABILITY_DENIED\");\n    assert_eq!(data.get(\"capability\").unwrap(), \"send_message\");\n}\n```\n\n### GREEN Phase - Error Code Enum\n```rust\n// lib-mcp/src/tools/errors.rs\n\n#[derive(Debug, Clone, Serialize)]\n#[serde(rename_all = \"SCREAMING_SNAKE_CASE\")]\npub enum ErrorCode {\n    // Agent errors\n    AgentNotFound,\n    AgentAlreadyExists,\n    CapabilityDenied,\n    \n    // Project errors\n    ProjectNotFound,\n    ProjectAlreadyExists,\n    \n    // Message errors\n    MessageNotFound,\n    ThreadNotFound,\n    InvalidRecipient,\n    \n    // Reservation errors\n    ReservationConflict,\n    ReservationNotFound,\n    ReservationExpired,\n    \n    // Validation errors\n    InvalidInput,\n    InvalidAgentName,\n    InvalidProjectKey,\n    InvalidTtl,\n    \n    // Internal errors\n    DatabaseError,\n    InternalError,\n}\n\nimpl ErrorCode {\n    pub fn to_mcp_error(\u0026self, message: \u0026str, context: Option\u003cserde_json::Value\u003e) -\u003e McpError {\n        let mut data = context.unwrap_or_default();\n        data[\"error_code\"] = serde_json::to_value(self).unwrap();\n        \n        match self {\n            Self::AgentNotFound | Self::ProjectNotFound | Self::MessageNotFound =\u003e {\n                McpError::invalid_params(message.into(), Some(data))\n            }\n            Self::CapabilityDenied | Self::InvalidInput =\u003e {\n                McpError::invalid_params(message.into(), Some(data))\n            }\n            _ =\u003e McpError::internal_error(message.into(), Some(data))\n        }\n    }\n}\n```\n\n### REFACTOR Phase - Helper Macros\n```rust\n// lib-mcp/src/tools/helpers/errors.rs\n\nmacro_rules! mcp_err {\n    ($code:expr, $msg:expr) =\u003e {\n        $code.to_mcp_error($msg, None)\n    };\n    ($code:expr, $msg:expr, $ctx:expr) =\u003e {\n        $code.to_mcp_error($msg, Some(serde_json::json!($ctx)))\n    };\n}\n\n// Usage in tool:\nlet agent = AgentBmc::get_by_name(\u0026ctx, \u0026self.mm, project.id, \u0026name)\n    .await\n    .map_err(|_| mcp_err!(\n        ErrorCode::AgentNotFound,\n        \u0026format!(\"Agent '{}' not found\", name),\n        { \"project_id\": project.id, \"agent_name\": name }\n    ))?;\n```\n\n## Error Code Mapping\n| Scenario | Error Code | MCP Code |\n|----------|------------|----------|\n| Agent not found | AGENT_NOT_FOUND | -32602 |\n| Duplicate agent | AGENT_ALREADY_EXISTS | -32602 |\n| No capability | CAPABILITY_DENIED | -32602 |\n| Project not found | PROJECT_NOT_FOUND | -32602 |\n| Bad input format | INVALID_INPUT | -32602 |\n| Reservation conflict | RESERVATION_CONFLICT | -32602 |\n| Database failure | DATABASE_ERROR | -32603 |\n| Unknown error | INTERNAL_ERROR | -32603 |\n\n## Checklist\n- [ ] Write failing tests for 5 error code scenarios\n- [ ] Create ErrorCode enum with 15+ variants\n- [ ] Implement to_mcp_error() method\n- [ ] Create mcp_err! macro\n- [ ] Update register_agent with error codes\n- [ ] Update send_message with error codes\n- [ ] Update list_inbox with error codes\n- [ ] Update whois with error codes\n- [ ] Update reserve_file with error codes\n- [ ] Audit remaining tools for error context\n- [ ] Document error codes in API docs\n- [ ] All tests pass\n\n## Files to Create\n- `lib-mcp/src/tools/errors.rs`\n- `lib-mcp/tests/error_code_tests.rs`\n\n## Files to Modify\n- `lib-mcp/src/tools/mod.rs`\n- `lib-mcp/src/tools/helpers/mod.rs`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T04:56:31.393779+05:30","updated_at":"2025-12-24T17:22:11.88012+05:30","closed_at":"2025-12-24T17:22:11.88012+05:30","close_reason":"Implemented structured error codes: Created errors.rs with ErrorCode enum (15+ variants), mcp_err! macro, updated helpers.rs resolve_project/resolve_agent to use structured errors, wrote 8 integration tests, all tests pass","dependencies":[{"issue_id":"mcpmail-uqpm","depends_on_id":"mcpmail-m5me","type":"blocks","created_at":"2025-12-24T04:58:47.708276+05:30","created_by":"daemon"}]}
{"id":"mcpmail-v45o","title":"SVELTE-022b: AppSidebar Mobile-First","description":"Sheet mobile, collapsed tablet, expanded desktop. 44px touch, unread badge, swipe dismiss.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T16:57:00.363023+05:30","updated_at":"2025-12-23T18:47:21.862686+05:30","closed_at":"2025-12-23T18:47:21.862686+05:30","dependencies":[{"issue_id":"mcpmail-v45o","depends_on_id":"mcpmail-8dqi","type":"blocks","created_at":"2025-12-23T16:57:30.568745+05:30","created_by":"amrit"}]}
{"id":"mcpmail-voj3","title":"SVELTE-023: Dashboard Error States \u0026 Accessibility Fixes","description":"## Summary\nFix critical dashboard UI issues identified in design review (Grade: C+ 70/100).\n\n## Top 3 Priority Fixes\n\n### 1. Error Recovery (Nielsen Heuristic #9)\n- [ ] Add \"Retry\" button to error message box\n- [ ] Add \"Learn More\" link explaining how to start backend\n- [ ] Add dismissal capability (X button)\n- [ ] Show estimated status check or auto-retry timer\n\n### 2. Error Semantics \u0026 Accessibility\n- [ ] Add `role=\"alert\"` to error message container\n- [ ] Add `aria-live=\"polite\"` for dynamic error notifications\n- [ ] Add visible focus rings for keyboard navigation\n- [ ] Add text labels to sidebar icons (sr-only or visible)\n- [ ] Add \"(Offline)\" text next to red dot status indicator\n\n### 3. Spacing \u0026 Visual Hierarchy\n- [ ] Standardize all spacing to 8px grid (4, 8, 12, 16, 24, 32px)\n- [ ] Fix card grid alignment (equal gaps between cards)\n- [ ] Improve error message typography (bolder, larger)\n- [ ] Add proper heading hierarchy to Dashboard title\n\n## Acceptance Criteria\n- [ ] Error box has Retry button that triggers health check\n- [ ] Error box has dismiss X button\n- [ ] All interactive elements have visible focus rings\n- [ ] Lighthouse Accessibility score \u003e= 85\n- [ ] All spacing uses design tokens (--space-*)\n\n## Files to Modify\n- `src/routes/+page.svelte` (Dashboard)\n- `src/app.css` (spacing tokens if needed)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T20:40:53.630973+05:30","updated_at":"2025-12-23T20:51:07.539179+05:30","closed_at":"2025-12-23T20:51:07.539179+05:30"}
{"id":"mcpmail-vr27","title":"[P1] Split tools/mod.rs into domain-focused modules","description":"## Problem\n`lib-mcp/src/tools/mod.rs` is 3000+ lines - a monolithic file that violates \nsingle-responsibility principle and makes the codebase hard to navigate/test.\n\n## Current Structure\n```\ntools/\n  mod.rs (3000+ lines - ALL tool implementations)\n  params.rs (parameter types)\n  helpers.rs\n  observability.rs\n  ...\n```\n\n## Target Structure\n```\ntools/\n  mod.rs (~200 lines - routing, ServerHandler impl, re-exports)\n  params.rs (unchanged)\n  messaging.rs (~500 lines)\n  agents.rs (~400 lines)\n  reservations.rs (~400 lines)\n  projects.rs (~300 lines)\n  macros.rs (~400 lines)\n  products.rs (~300 lines)\n  helpers/\n    mod.rs\n    validation.rs\n```\n\n## TDD Acceptance Criteria\n\n### RED Phase - Compilation Tests\n```rust\n// lib-mcp/tests/module_structure_tests.rs\n#[test]\nfn test_messaging_module_exports_send_message() {\n    use lib_mcp::tools::messaging::send_message_impl;\n    // Should compile - proves module exists and exports correctly\n}\n\n#[test]\nfn test_agents_module_exports_register_agent() {\n    use lib_mcp::tools::agents::register_agent_impl;\n}\n\n#[test]\nfn test_reservations_module_exports_reserve_file() {\n    use lib_mcp::tools::reservations::reserve_file_impl;\n}\n\n// Tool count verification\n#[test]\nfn test_all_60_tools_accessible_from_mod() {\n    let schemas = lib_mcp::get_tool_schemas(true);\n    assert!(schemas.len() \u003e= 60, \"Expected 60+ tools, got {}\", schemas.len());\n}\n```\n\n### GREEN Phase - Module Extraction\n\n**Step 1: Create messaging.rs**\n```rust\n// tools/messaging.rs\nuse super::*;\nuse super::params::*;\n\npub async fn send_message_impl(\n    ctx: \u0026Ctx,\n    mm: \u0026Arc\u003cModelManager\u003e,\n    params: SendMessageParams,\n) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    // Move implementation from mod.rs\n}\n\npub async fn reply_message_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn list_inbox_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn list_outbox_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn get_message_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn search_messages_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn mark_message_read_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\npub async fn acknowledge_message_impl(...) -\u003e Result\u003cCallToolResult, McpError\u003e { ... }\n```\n\n**Step 2: Update mod.rs routing**\n```rust\n// tools/mod.rs\nmod messaging;\nmod agents;\nmod reservations;\nmod projects;\nmod macros;\nmod products;\n\n// Tool macros call into domain modules\n#[tool(description = \"Send a message from one agent to others.\")]\nasync fn send_message(\u0026self, params: Parameters\u003cSendMessageParams\u003e) -\u003e Result\u003cCallToolResult, McpError\u003e {\n    messaging::send_message_impl(\u0026self.ctx(), \u0026self.mm, params.inner).await\n}\n```\n\n### REFACTOR Phase - Common Patterns\n```rust\n// tools/helpers/common.rs\npub async fn resolve_project(\n    ctx: \u0026Ctx,\n    mm: \u0026Arc\u003cModelManager\u003e,\n    identifier: \u0026str,\n) -\u003e Result\u003cProject, McpError\u003e {\n    ProjectBmc::get_by_identifier(ctx, mm, identifier)\n        .await\n        .map_err(|e| McpError::invalid_params(format!(\"Project not found: {}\", e), None))\n}\n\npub async fn resolve_agent(\n    ctx: \u0026Ctx,\n    mm: \u0026Arc\u003cModelManager\u003e,\n    project_id: i64,\n    name: \u0026str,\n) -\u003e Result\u003cAgent, McpError\u003e {\n    AgentBmc::get_by_name(ctx, mm, project_id, name)\n        .await\n        .map_err(|e| McpError::invalid_params(format!(\"Agent not found: {}\", e), None))\n}\n```\n\n## Checklist\n- [ ] Write module existence tests (compilation tests)\n- [ ] Write tool count verification test\n- [ ] Create messaging.rs with 8 message-related tools\n- [ ] Create agents.rs with 6 agent-related tools\n- [ ] Create reservations.rs with 6 file reservation tools\n- [ ] Create projects.rs with 5 project tools\n- [ ] Create macros.rs with 8 macro/workflow tools\n- [ ] Create products.rs with 5 product tools\n- [ ] Update mod.rs to route to domain modules\n- [ ] Extract common helpers to helpers/common.rs\n- [ ] Verify all existing tests still pass\n- [ ] Run cargo clippy -D warnings\n- [ ] Verify mod.rs is under 500 lines\n\n## Files to Create\n- `lib-mcp/src/tools/messaging.rs`\n- `lib-mcp/src/tools/agents.rs`\n- `lib-mcp/src/tools/reservations.rs`\n- `lib-mcp/src/tools/projects.rs`\n- `lib-mcp/src/tools/macros.rs`\n- `lib-mcp/src/tools/products.rs`\n- `lib-mcp/src/tools/helpers/common.rs`\n\n## Files to Modify\n- `lib-mcp/src/tools/mod.rs` (reduce from 3000 to ~500 lines)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T04:56:30.957745+05:30","updated_at":"2025-12-24T08:52:55.712595+05:30","closed_at":"2025-12-24T08:52:55.712595+05:30","close_reason":"Refactored mod.rs from 3649 to 3165 lines by delegating tools to domain modules (export.rs, precommit.rs, products.rs). All tests pass."}
{"id":"mcpmail-woia","title":"[P3] Auto-generate tool schemas from #[tool] macro metadata","description":"## Problem\n`get_all_tool_schemas()` manually duplicates the metadata already declared in \n`#[tool]` macros and `JsonSchema` derives, creating maintenance burden and \npotential for drift.\n\n## Current State (Duplication)\n```rust\n// In mod.rs - manual schema definition\nToolSchema {\n    name: \"send_message\".into(),\n    description: \"Send a message from one agent to others.\".into(),\n    parameters: vec![\n        ParameterSchema { name: \"project_slug\".into(), ... },\n        // ... 8 more parameters\n    ],\n}\n\n// Also in mod.rs - tool macro\n#[tool(description = \"Send a message from one agent to others.\")]\nasync fn send_message(\u0026self, params: Parameters\u003cSendMessageParams\u003e) \n\n// Also in params.rs - JsonSchema\n#[derive(Debug, Deserialize, JsonSchema)]\npub struct SendMessageParams {\n    /// Project slug\n    pub project_slug: String,\n    // ...\n}\n```\n\n## Target State (Single Source of Truth)\n```rust\n// params.rs remains source of truth via JsonSchema\n#[derive(Debug, Deserialize, JsonSchema)]\npub struct SendMessageParams {\n    /// Project slug\n    pub project_slug: String,\n}\n\n// get_tool_schemas() generates from JsonSchema at runtime or build time\npub fn get_tool_schemas(worktrees_enabled: bool) -\u003e Vec\u003cToolSchema\u003e {\n    let mut schemas = vec![\n        schema_from_params::\u003cSendMessageParams\u003e(\"send_message\", \"Send a message...\"),\n        schema_from_params::\u003cListInboxParams\u003e(\"list_inbox\", \"Check inbox...\"),\n        // ...\n    ];\n    \n    if !worktrees_enabled {\n        schemas.retain(|s| !BUILD_SLOT_TOOLS.contains(\u0026s.name.as_str()));\n    }\n    schemas\n}\n```\n\n## TDD Acceptance Criteria\n\n### RED Phase - Schema Generation Tests\n```rust\n// lib-mcp/tests/schema_generation_tests.rs\n\n#[test]\nfn test_generated_schema_matches_manual_schema() {\n    let generated = schema_from_params::\u003cSendMessageParams\u003e(\n        \"send_message\",\n        \"Send a message from one agent to others.\"\n    );\n    \n    // Verify structure matches what we expect\n    assert_eq!(generated.name, \"send_message\");\n    assert!(generated.description.contains(\"Send a message\"));\n    \n    // All params present\n    let param_names: Vec\u003c\u0026str\u003e = generated.parameters.iter()\n        .map(|p| p.name.as_str())\n        .collect();\n    assert!(param_names.contains(\u0026\"project_slug\"));\n    assert!(param_names.contains(\u0026\"sender_name\"));\n    assert!(param_names.contains(\u0026\"to\"));\n    assert!(param_names.contains(\u0026\"subject\"));\n    assert!(param_names.contains(\u0026\"body_md\"));\n}\n\n#[test]\nfn test_required_fields_marked_correctly() {\n    let schema = schema_from_params::\u003cSendMessageParams\u003e(\n        \"send_message\",\n        \"test\"\n    );\n    \n    let project_slug = schema.parameters.iter()\n        .find(|p| p.name == \"project_slug\")\n        .unwrap();\n    assert!(project_slug.required, \"project_slug should be required\");\n    \n    let importance = schema.parameters.iter()\n        .find(|p| p.name == \"importance\")\n        .unwrap();\n    assert!(!importance.required, \"importance should be optional\");\n}\n\n#[test]\nfn test_descriptions_from_doc_comments() {\n    let schema = schema_from_params::\u003cRegisterAgentParams\u003e(\n        \"register_agent\",\n        \"test\"\n    );\n    \n    let project_slug = schema.parameters.iter()\n        .find(|p| p.name == \"project_slug\")\n        .unwrap();\n    assert!(project_slug.description.contains(\"Project slug\"));\n}\n\n#[test]\nfn test_all_tools_have_schemas() {\n    let router = AgentMailService::tool_router();\n    let tool_names: Vec\u003cString\u003e = router.list_all().iter()\n        .map(|t| t.name.clone())\n        .collect();\n    \n    let schemas = get_tool_schemas(true);\n    let schema_names: Vec\u003c\u0026str\u003e = schemas.iter()\n        .map(|s| s.name.as_str())\n        .collect();\n    \n    for tool in \u0026tool_names {\n        assert!(\n            schema_names.contains(\u0026tool.as_str()),\n            \"Tool '{}' missing schema\",\n            tool\n        );\n    }\n}\n```\n\n### GREEN Phase - Schema Generator\n```rust\n// lib-mcp/src/tools/schema.rs\n\nuse schemars::{JsonSchema, schema_for};\nuse serde_json::Value;\n\npub fn schema_from_params\u003cT: JsonSchema\u003e(\n    name: \u0026str,\n    description: \u0026str,\n) -\u003e ToolSchema {\n    let root_schema = schema_for!(T);\n    let schema = root_schema.schema;\n    \n    let properties = schema.object.as_ref()\n        .and_then(|o| o.properties.as_ref())\n        .cloned()\n        .unwrap_or_default();\n    \n    let required: Vec\u003cString\u003e = schema.object.as_ref()\n        .and_then(|o| o.required.as_ref())\n        .map(|r| r.iter().cloned().collect())\n        .unwrap_or_default();\n    \n    let parameters = properties.into_iter()\n        .map(|(param_name, param_schema)| {\n            let schema_obj = param_schema.into_object();\n            let param_type = extract_type(\u0026schema_obj);\n            let param_desc = schema_obj.metadata.as_ref()\n                .and_then(|m| m.description.clone())\n                .unwrap_or_default();\n            \n            ParameterSchema {\n                name: param_name.clone(),\n                param_type,\n                required: required.contains(\u0026param_name),\n                description: param_desc,\n            }\n        })\n        .collect();\n    \n    ToolSchema {\n        name: name.to_string(),\n        description: description.to_string(),\n        parameters,\n    }\n}\n\nfn extract_type(schema: \u0026schemars::schema::SchemaObject) -\u003e String {\n    if let Some(single) = \u0026schema.instance_type {\n        match single {\n            schemars::schema::SingleOrVec::Single(t) =\u003e format!(\"{:?}\", t).to_lowercase(),\n            schemars::schema::SingleOrVec::Vec(types) =\u003e {\n                types.iter()\n                    .map(|t| format!(\"{:?}\", t).to_lowercase())\n                    .collect::\u003cVec\u003c_\u003e\u003e()\n                    .join(\" | \")\n            }\n        }\n    } else {\n        \"any\".to_string()\n    }\n}\n```\n\n### REFACTOR Phase - Macro-based Registration\n```rust\n// lib-mcp/src/tools/mod.rs\n\n// Replace 1000+ lines of manual schemas with:\npub fn get_tool_schemas(worktrees_enabled: bool) -\u003e Vec\u003cToolSchema\u003e {\n    let schemas = vec![\n        // Messaging\n        schema_from_params::\u003cSendMessageParams\u003e(\"send_message\", \"Send a message from one agent to others.\"),\n        schema_from_params::\u003cReplyMessageParams\u003e(\"reply_message\", \"Reply to an existing message in a thread.\"),\n        schema_from_params::\u003cListInboxParams\u003e(\"check_inbox\", \"Check an agent's inbox for new messages.\"),\n        schema_from_params::\u003cListInboxParams\u003e(\"list_inbox\", \"Check an agent's inbox for new messages.\"),\n        \n        // Agents\n        schema_from_params::\u003cRegisterAgentParams\u003e(\"register_agent\", \"Register a new agent in a project.\"),\n        schema_from_params::\u003cWhoisParams\u003e(\"whois\", \"Get information about an agent.\"),\n        \n        // ... 50+ more tools\n    ];\n    \n    if !worktrees_enabled {\n        schemas.into_iter()\n            .filter(|s| !BUILD_SLOT_TOOLS.contains(\u0026s.name.as_str()))\n            .collect()\n    } else {\n        schemas\n    }\n}\n```\n\n## Benefits\n- Single source of truth (JsonSchema derives)\n- Doc comments become API documentation\n- Required/optional from Option\u003cT\u003e\n- Type information from schema\n- Reduces mod.rs by ~800 lines\n\n## Checklist\n- [ ] Write test for schema generation matches manual\n- [ ] Write test for required fields detection\n- [ ] Write test for doc comment extraction\n- [ ] Write test for all tools covered\n- [ ] Implement schema_from_params\u003cT\u003e()\n- [ ] Implement extract_type() helper\n- [ ] Replace manual schemas with generated ones\n- [ ] Remove ~800 lines of manual schema code\n- [ ] Verify all tests pass\n- [ ] Verify cargo doc still generates API docs\n\n## Files to Create\n- `lib-mcp/src/tools/schema.rs`\n- `lib-mcp/tests/schema_generation_tests.rs`\n\n## Files to Modify\n- `lib-mcp/src/tools/mod.rs` (remove manual schemas)\n- `lib-mcp/Cargo.toml` (schemars features if needed)\n\n## Dependencies\n- Depends on: mcpmail-vr27 (module split - easier to refactor after)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-24T04:58:35.317253+05:30","updated_at":"2025-12-24T04:58:35.317253+05:30","dependencies":[{"issue_id":"mcpmail-woia","depends_on_id":"mcpmail-vr27","type":"blocks","created_at":"2025-12-24T04:58:47.516823+05:30","created_by":"daemon"}]}
{"id":"mcpmail-xkde","title":"SVELTE-022d: MagicUI Components","description":"BlurFade, ShimmerButton, GridPattern, NumberTicker, StatusIndicator. Respect prefers-reduced-motion.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T16:57:05.274312+05:30","updated_at":"2025-12-24T03:21:05.32882+05:30","closed_at":"2025-12-24T03:21:05.32882+05:30","close_reason":"Added 3 new Magic UI components: ShimmerButton (animated border shimmer), NumberTicker (enhanced number animation with direction support), StatusIndicator (pulsing status dots). All respect prefers-reduced-motion. Build passes.","dependencies":[{"issue_id":"mcpmail-xkde","depends_on_id":"mcpmail-8dqi","type":"blocks","created_at":"2025-12-23T16:57:31.091625+05:30","created_by":"amrit"}]}
{"id":"mcpmail-xvnd","title":"SVELTE-022f: Inbox Mobile-First","description":"AnimatedList, Badge variants, Bottom Sheet/Dialog compose, ShimmerButton, 44px items.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T16:57:10.867365+05:30","updated_at":"2025-12-24T03:28:18.091775+05:30","closed_at":"2025-12-24T03:28:18.091775+05:30","close_reason":"Implemented mobile-first inbox with ShimmerButton, Badge, Sheet components, 44px touch targets, and staggered animations","dependencies":[{"issue_id":"mcpmail-xvnd","depends_on_id":"mcpmail-v45o","type":"blocks","created_at":"2025-12-23T16:57:31.562104+05:30","created_by":"amrit"},{"issue_id":"mcpmail-xvnd","depends_on_id":"mcpmail-xkde","type":"blocks","created_at":"2025-12-23T16:57:31.810249+05:30","created_by":"amrit"}]}
